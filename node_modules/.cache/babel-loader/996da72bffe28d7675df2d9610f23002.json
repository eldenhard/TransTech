{"ast":null,"code":"import { mapState } from 'vuex';\nimport api from \"@/api/wagonPark\";\nimport FilterWagon from '@/components/filter/FilterWagon.vue';\nexport default {\n  name: \"WagonTable\",\n  computed: { ...mapState({\n      user: state => state.auth.user,\n      uid: state => state.auth.uid\n    })\n  },\n  components: {\n    FilterWagon\n  },\n\n  data() {\n    return {\n      nextLink: null,\n      prevLink: null,\n      activeWagonId: null,\n      filters: null,\n      numberWagon: null,\n      amount: null,\n      // checked: [],\n      WagonModel: {\n        number: \"Номер вагона\",\n        is_problem: \"Проблемность\",\n        volume: \"Объем вагона\",\n        type: \"Тип вагона\"\n      },\n      WagonStateModel: {\n        number: \"Номер вагона\",\n        state: \"Состояние\",\n        state_value: \"Значение \\\"Состояние\\\"\",\n        state_value_digital: \"Значение \\\"Состояние\\\" числовое\",\n        updated_at: \"Дата изменения состояния\"\n      },\n      WagonPassportModel: {\n        next_planed_repair_date: \"Дата следующего планового ремонта\",\n        last_planed_repair_date: \"Дата последнего планового ремонта\",\n        capacity: \"Грузоподъемность\",\n        model: \"Модель вагона\",\n        days_before_date_plan_repair: \"Дней до следующего планового ремонта\",\n        next_plan_repair_kind: \"Вид следующего планового ремонта\",\n        build_date: \"Дата постройки\",\n        lifetime: \"Срок службы\",\n        document: \"Скан паспорта\",\n        wagon: \"Вагон\"\n      },\n      WagonBelongModel: {\n        hash_value: \"Значение\",\n        name: \"Принадлежность\",\n        owner: \"Собственник\",\n        in_company_control: \"В управлении\",\n        wagon_source_company: \"Источник поступления вагона, организация\",\n        event_name: \"Событие\",\n        agreement: \"Соглашение\",\n        created_at: \"Дата создания\",\n        description: \"Описание\",\n        wagon: \"Вагон\"\n      },\n      WagonRepairModel: {\n        nrp: \"НРП (вагон в нерабочем парке)\",\n        malfunction_current: \"Неисправность текущая\",\n        repair_type: \"Тип ремонта (для НРП)\",\n        nrp_date: \"Дата НРП (перевода в нерабочий парк)\",\n        REPAIR_TYPES: [(\"Текущий\", \"current\"), (\"Плановый\", \"plan\")],\n        repair_kind: \"Текущий/Плановый\",\n        next_planed_repair_date: \"Дата следующего запланированного ремонта\",\n        next_planed_repair_depot: \"Депо следующего запланированного ремонта\",\n        status: \"Статус ремонта\",\n        repair_station_downtime: \"Простой на станции рмонта (дни)\",\n        malfunction_code: \"Код неисправности (НРП)\",\n        malfunction_kind: \"Вид неисправности (НРП)\",\n        repair_compensation: \"Ремонт возмещается (текущий)\"\n      },\n      WagonRestRunModel: {\n        actual_run: \"Фактический пробег\",\n        rest_run: \"Остаточный пробег\",\n        run_limit: \"Лимит пробега\",\n        run_over_limit: \"Пробег свыше лимита\"\n      },\n      WagonModernisationModel: {\n        last_date: \"Дата последней модернизации\"\n      },\n      WagonRentModel: {\n        rent_doc: \"Договор аренды\",\n        rent_doc_counterparty: \"Контрагент по договору\",\n        acceptance_certificate_number: \"Номер акта приема-передачи\",\n        acceptance_certificate_date: \"Дата акта приема-передачи\",\n        rent_start_date: \"Дата аренды\",\n        wagon: \"Вагон\",\n        acceptance_station: \"Станция приема-передачи\"\n      },\n      WagonLeasingModel: {\n        leasing_doc: \"Договор лизинга\",\n        leasing_doc_lifetime: \"Срок действия договора лизинга\"\n      },\n      WagonInsuranceModel: {\n        insurance_doc: \"Договор страхования\",\n        insurance_doc_lifetime: \"Срок действия договора страхования\"\n      },\n      WagonEtranInfoModel: {\n        owner: \"Собственник (по данным ЭТРАН, ГВЦ)\",\n        tenant: \"Арендатор (по данным ЭТРАН, ГВЦ)\",\n        signing: \"Визирование\",\n        parking: \"Отстой\",\n        telegram_number: \"№ телеграммы\",\n        number_from_expeditor: \"№ от экспедитора\"\n      },\n      WagonsModel: [],\n      WagonStatesModel: [],\n      WagonsPassportModel: [],\n      WagonsBelongModel: [],\n      WagonsRepairModel: [],\n      WagonsRestRunModel: [],\n      WagonsModernisationModel: [],\n      WagonsRentModel: [],\n      WagonsLeasingModel: [],\n      WagonsInsuranceModel: [],\n      WagonsEtranInfoModel: []\n    };\n  },\n\n  methods: {\n    goToPage(link) {\n      let url = new URL(link);\n      let pageNumber = url.searchParams.get(\"page\");\n\n      if (pageNumber != null) {\n        this.filters.page = pageNumber;\n      } else {\n        delete this.filters.page;\n      }\n\n      this.Wagon();\n    },\n\n    getMoreData(wagonNumber) {\n      this.passport(wagonNumber);\n      this.belong(wagonNumber);\n    },\n\n    updateFilters(filters) {\n      this.filters = filters;\n    },\n\n    Wagon() {\n      document.getElementById(\"loading-page-lk\").style.display = \"block\";\n      api.getWagons(this.filters).then(response => {\n        this.WagonsModel = response.data.data;\n        this.nextLink = response.data.links.next;\n        this.prevLink = response.data.links.previous;\n        this.amount = response.data.total_objects;\n        document.getElementById(\"loading-page-lk\").style.display = \"none\";\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n\n    passport(wagonNumber = null) {\n      document.getElementById(\"loading-page-lk\").style.display = \"block\";\n      api.getPassport({\n        wagon: wagonNumber\n      }).then(response => {\n        this.WagonsPassportModel = response.data.data;\n        document.getElementById(\"loading-page-lk\").style.display = \"none\";\n      });\n    },\n\n    arenda() {\n      document.getElementById(\"loading-page-lk\").style.display = \"block\";\n      api.getArenda().then(response => {\n        this.WagonsBelongModel = response.data.data;\n        document.getElementById(\"loading-page-lk\").style.display = \"none\";\n      });\n    },\n\n    belong(wagonNumber = null) {\n      document.getElementById(\"loading-page-lk\").style.display = \"block\";\n      api.getBelong({\n        wagon: wagonNumber\n      }).then(response => {\n        this.WagonsBelongModel = response.data.data;\n        document.getElementById(\"loading-page-lk\").style.display = \"none\";\n      });\n    },\n\n    searchWagon() {\n      document.getElementById(\"loading-page-lk\").style.display = \"block\";\n      api.getCurrentWagon(this.numberWagon).then(response => {\n        this.WagonsModel = response.data.data;\n        this.amount = response.data.total_objects;\n        this.passport(this.numberWagon);\n        this.belong(this.numberWagon);\n        document.getElementById('pagination').style.display = 'hidden';\n        document.getElementById(\"loading-page-lk\").style.display = \"none\";\n        document.getElementById(\"searchWagonPlace\").value = '';\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n\n  }\n}; // belong(wagonNumber = null) {\n//             document.getElementById(\"loading-page-lk\").style.display = \"block\";\n//             api.getBelong({wagon: wagonNumber})\n//             const pretoken = JSON.parse(localStorage.getItem(\"vuex\"));\n//             const token = pretoken.auth.user.token;\n//             fetch(\"http://10.1.5.65/api/wagon-park/wagon-belong/\", {\n//                 headers: {\n//                     \"Authorization\": `Basic ${token}`\n//                 },\n//                 method: \"GET\"\n//             })\n//                 .then((response) => {\n//                     this.WagonsBelongModel = response.data.data.data;\n//                     document.getElementById(\"loading-page-lk\").style.display = \"none\";\n//                 if (response.ok) {\n//                     return response.json().then(r => {\n//                         this.WagonsBelongModel = r.data.data;\n//                         document.getElementById(\"loading-page-lk\").style.display = \"none\";\n//                         console.log(this.WagonsBelongModel);\n//                     });\n//                 }\n//                 else {\n//                     console.log(\"NOT OK\");\n//                 }\n//             });\n//         }","map":{"version":3,"mappings":"AA+YA;AAEA;AACA;AACA;EACAA,kBADA;EAEAC,YACA;MACAC,8BADA;MAEAC;IAFA;EADA,CAFA;EAQAC;IAAAC;EAAA,CARA;;EASAC;IACA;MACAC,cADA;MAEAC,cAFA;MAGAC,mBAHA;MAIAC,aAJA;MAKAC,iBALA;MAMAC,YANA;MAOA;MACAC;QACAC,sBADA;QAEAC,0BAFA;QAGAC,sBAHA;QAIAC;MAJA,CARA;MAcAC;QACAJ,sBADA;QAEAK,kBAFA;QAGAC,qCAHA;QAIAC,sDAJA;QAKAC;MALA,CAdA;MAqBAC;QACAC,4DADA;QAEAC,4DAFA;QAGAC,4BAHA;QAIAC,sBAJA;QAKAC,oEALA;QAMAC,yDANA;QAOAC,4BAPA;QAQAC,uBARA;QASAC,yBATA;QAUAC;MAVA,CArBA;MAiCAC;QACAC,sBADA;QAEAnC,sBAFA;QAGAoC,oBAHA;QAIAC,kCAJA;QAKAC,gEALA;QAMAC,qBANA;QAOAC,uBAPA;QAQAC,2BARA;QASAC,uBATA;QAUAT;MAVA,CAjCA;MA6CAU;QACAC,oCADA;QAEAC,4CAFA;QAGAC,oCAHA;QAIAC,gDAJA;QAKAC,gBACA,oBADA,IAEA,kBAFA,EALA;QASAC,+BATA;QAUAzB,mEAVA;QAWA0B,oEAXA;QAYAC,wBAZA;QAaAC,0DAbA;QAcAC,2CAdA;QAeAC,2CAfA;QAgBAC;MAhBA,CA7CA;MA+DAC;QACAC,gCADA;QAEAC,6BAFA;QAGAC,0BAHA;QAIAC;MAJA,CA/DA;MAqEAC;QACAC;MADA,CArEA;MAwEAC;QACAC,0BADA;QAEAC,+CAFA;QAGAC,2DAHA;QAIAC,wDAJA;QAKAC,8BALA;QAMAnC,cANA;QAOAoC;MAPA,CAxEA;MAiFAC;QACAC,8BADA;QAEAC;MAFA,CAjFA;MAqFAC;QACAC,oCADA;QAEAC;MAFA,CArFA;MAyFAC;QACAxC,2CADA;QAEAyC,0CAFA;QAGAC,sBAHA;QAIAC,iBAJA;QAKAC,+BALA;QAMAC;MANA,CAzFA;MAiGAC,eAjGA;MAkGAC,oBAlGA;MAmGAC,uBAnGA;MAoGAC,qBApGA;MAqGAC,qBArGA;MAsGAC,sBAtGA;MAuGAC,4BAvGA;MAwGAC,mBAxGA;MAyGAC,sBAzGA;MA0GAC,wBA1GA;MA2GAC;IA3GA;EA6GA,CAvHA;;EAwHAC;IACAC;MAEA;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;;MACA;IACA,CAXA;;IAYAC;MAEA;MACA;IACA,CAhBA;;IAiBAC;MACA;IACA,CAnBA;;IAqBAC;MACAjE;MACAkE,4BACAC,IADA,CACAC;QACA;QACA;QACA;QACA;QACApE;MACA,CAPA,EAOAqE,KAPA,CAOAC;QACAC;MACA,CATA;IAUA,CAjCA;;IAmCAC;MACAxE;MACAkE;QAAAjE;MAAA,GACAkE,IADA,CACAC;QACA;QACApE;MAEA,CALA;IAMA,CA3CA;;IA6CAyE;MACAzE;MACAkE,gBACAC,IADA,CACAC;QACA;QACApE;MAEA,CALA;IAMA,CArDA;;IAsDA0E;MACA1E;MACAkE;QAAAjE;MAAA,GACAkE,IADA,CACAC;QACA;QACApE;MAEA,CALA;IAMA,CA9DA;;IA+DA2E;MACA3E;MACAkE,sCAEAC,IAFA,CAEAC;QACA;QACA;QACA;QACA;QAEApE;QACAA;QACAA;MACA,CAXA,EAWAqE,KAXA,CAWAC;QACAC;MACA,CAbA;IAeA;;EAhFA;AAxHA,E,CA6MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","names":["name","computed","user","uid","components","FilterWagon","data","nextLink","prevLink","activeWagonId","filters","numberWagon","amount","WagonModel","number","is_problem","volume","type","WagonStateModel","state","state_value","state_value_digital","updated_at","WagonPassportModel","next_planed_repair_date","last_planed_repair_date","capacity","model","days_before_date_plan_repair","next_plan_repair_kind","build_date","lifetime","document","wagon","WagonBelongModel","hash_value","owner","in_company_control","wagon_source_company","event_name","agreement","created_at","description","WagonRepairModel","nrp","malfunction_current","repair_type","nrp_date","REPAIR_TYPES","repair_kind","next_planed_repair_depot","status","repair_station_downtime","malfunction_code","malfunction_kind","repair_compensation","WagonRestRunModel","actual_run","rest_run","run_limit","run_over_limit","WagonModernisationModel","last_date","WagonRentModel","rent_doc","rent_doc_counterparty","acceptance_certificate_number","acceptance_certificate_date","rent_start_date","acceptance_station","WagonLeasingModel","leasing_doc","leasing_doc_lifetime","WagonInsuranceModel","insurance_doc","insurance_doc_lifetime","WagonEtranInfoModel","tenant","signing","parking","telegram_number","number_from_expeditor","WagonsModel","WagonStatesModel","WagonsPassportModel","WagonsBelongModel","WagonsRepairModel","WagonsRestRunModel","WagonsModernisationModel","WagonsRentModel","WagonsLeasingModel","WagonsInsuranceModel","WagonsEtranInfoModel","methods","goToPage","getMoreData","updateFilters","Wagon","api","then","response","catch","err","console","passport","arenda","belong","searchWagon"],"sourceRoot":"src/components/Table","sources":["WagonTable.vue"],"sourcesContent":["<template>\r\n<div id=\"tableMain\">\r\n\r\n<FilterWagon @updateFilters=\"updateFilters\"></FilterWagon>\r\n\r\n<button class=\"button Accept\" style=\"width: 93%; height: 40px; position: relative; left: 50%; transform: translate(-50%,0);\" @click=\"Wagon()\">Запросить данные</button>\r\n\r\n\r\n\r\n   <br><br>\r\n   <br>\r\n\r\n\r\n   <div class=\"searchWagon\">\r\n    <input type=\"number\" v-model=\"numberWagon\" placeholder=\"введите номер вагона\" id=\"searchWagonPlace\" @keydown.enter=\"searchWagon()\" required>\r\n    <!-- <button @click=\"searchWagon()\" style=\"width: 20%; display: flex; align-items: center; justify-content: center;\">поиск</button> -->\r\n</div>\r\n\r\n<p class=\"amount\">всего: {{amount}}</p>\r\n<div class=\"table1\" style=\"display: flex;\" >\r\n<table style=\"margin-top: -0.1px;\">\r\n\r\n    <thead>\r\n    <tr>\r\n        <th><input type=\"number\" v-model=\"numberWagon\" placeholder=\"номер вагона\" id=\"searchWagonPlace\" @keydown.enter=\"searchWagon()\" required></th>\r\n        <!-- <th>{{WagonModel.number}}</th> -->\r\n        <th> {{WagonModel.is_problem}}</th>\r\n        <th>{{WagonModel.volume}}</th>\r\n        <th>{{WagonModel.type}}</th>\r\n        <th>Актуальность</th>\r\n    </tr>\r\n    </thead>\r\n    <tbody>\r\n    <!-- v-for=\"wagon in WagonsModel\" :key=\"wagon.id\" -->\r\n    <tr v-for=\"wagon in WagonsModel\" :key=\"wagon.id\" @click=\"getMoreData(wagon.number)\">\r\n        <td>{{wagon.number}}</td>\r\n        <td v-if=\"wagon.is_problem == false\">нет</td>\r\n        <td v-else>да</td>\r\n        <td>{{wagon.volume}}</td>\r\n        <td>{{wagon.wagon_type}}</td>\r\n        <td v-if=\"wagon.is_active == true\">☑️</td>\r\n        <td v-else>🚫</td>\r\n        \r\n    </tr>\r\n\r\n    </tbody>\r\n \r\n</table>\r\n\r\n\r\n\r\n\r\n\r\n<b-card no-body style=\"background: #ECECEC; border: none; text-decoration: none; width: 100%;\">\r\n    <b-tabs card  style=\"background: #ECECEC; font-size: 12px !important;\">\r\n      \r\n      <!--  v-if=\"WagonPassportModel.count > 0\" -->\r\n        <b-tab title=\"Паспорт\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonPassportModel.document}}</th>\r\n                            <th>{{WagonPassportModel.next_planed_repair_date}}</th>\r\n                            <th>{{WagonPassportModel.last_planed_repair_date}}</th>\r\n                            <th>{{WagonPassportModel.capacity}}</th>\r\n                            <th>{{WagonPassportModel.model}}</th>\r\n                            <th>{{WagonPassportModel.days_before_date_plan_repair}}</th>\r\n                            <th>{{WagonPassportModel.next_plan_repair_kind}}</th>\r\n                            <th>{{WagonPassportModel.build_date}}</th>\r\n                            <th>{{WagonPassportModel.lifetime}}</th>\r\n                            <th>{{WagonPassportModel.wagon}}</th>\r\n                          \r\n                            \r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagonpasport in WagonsPassportModel\" :key=\"wagonpasport.id\">\r\n                            <td><a target=\"_blank\" :href=\"wagonpasport.document\" v-if=\"wagonpasport.document\"><img src=\"@/assets/pdf.png\" alt=\"\" width=\"50px!important\"></a></td>\r\n                            <td>{{wagonpasport.next_planed_repair_date}}</td>\r\n                            <td>{{wagonpasport.last_planed_repair_date}}</td>\r\n                            <td>{{wagonpasport.capacity}}</td>\r\n                            <td>{{wagonpasport.model}}</td>\r\n                            <td>{{wagonpasport.days_before_date_plan_repair}}</td>\r\n                            <td>{{wagonpasport.next_plan_repair_kind}}</td>\r\n                            <td>{{wagonpasport.build_date}}</td>\r\n                            <td>{{wagonpasport.lifetime}}</td>\r\n                            <th style=\"font-weight: normal\">{{wagonpasport.wagon}}</th>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    \r\n                    <!-- <p v-else><br>Нет данных</p> -->\r\n                </div>\r\n            </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Принадлежность\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonBelongModel.name}}</th>\r\n                            <th>{{WagonBelongModel.owner}}</th>\r\n                            <th>{{WagonBelongModel.in_company_control}}</th>\r\n                            <th>{{WagonBelongModel.wagon_source_company}}</th>\r\n                            <th>{{WagonBelongModel.event_name}}</th>\r\n                            <th>{{WagonBelongModel.agreement}}</th>\r\n                            <th>{{WagonBelongModel.created_at}}</th>\r\n                            <th>{{WagonBelongModel.description}}</th>\r\n                            <th>{{WagonBelongModel.wagon}}</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagonbelong in WagonsBelongModel\" :key=\"wagonbelong.id\">\r\n                            <td>{{wagonbelong.name}}</td>\r\n                            <td>{{wagonbelong.owner}}</td>\r\n                            <td>{{wagonbelong.in_company_control}}</td>\r\n                            <td>{{wagonbelong.wagon_source_company}}</td>\r\n                            <td>{{wagonbelong.event_name}}</td>\r\n                            <td>{{wagonbelong.agreement}}</td>\r\n                            <td>{{wagonbelong.created_at}}</td>\r\n                            <td>{{wagonbelong.description}}</td>\r\n                            <td>{{wagonbelong.wagon}}</td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>  \r\n                </div>                                   \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Ремонт\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonModel.number}}</th>\r\n                            <th>{{WagonRepairModel.nrp}}</th>\r\n                            <th>{{WagonRepairModel.malfunction_current}}</th>\r\n                            <th>{{WagonRepairModel.repair_type}}</th>\r\n                            <th>{{WagonRepairModel.nrp_date}}</th>\r\n                            <th>{{WagonRepairModel.repair_kind}}</th>\r\n                            <th>{{WagonRepairModel.next_planed_repair_date}}</th>\r\n                            <th>{{WagonRepairModel.next_planed_repair_depot}}</th>\r\n                            <th>{{WagonRepairModel.status}}</th>\r\n                            <th>{{WagonRepairModel.repair_station_downtime}}</th>\r\n                            <th>{{WagonRepairModel.malfunction_code}}</th>\r\n                            <th>{{WagonRepairModel.malfunction_kind}}</th>\r\n                            <th>{{WagonRepairModel.repair_compensation}}</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr>\r\n                       \r\n\r\n                        </tr>\r\n                        </tbody>\r\n                </table> \r\n                </div>                                    \r\n            </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Остаточный пробег\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>{{WagonModel.number}}</th>\r\n                                <th>{{WagonRestRunModel.actual_run}}</th>\r\n                                <th>{{WagonRestRunModel.rest_run}}</th>\r\n                                <th>{{WagonRestRunModel.run_limit}}</th>\r\n                                <th>{{WagonRestRunModel.run_over_limit}}</th>\r\n\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr v-for=\"wagon in WagonsRestRunModel\" :key=\"wagon.id\">\r\n                                <td>{{wagon.number}}</td>\r\n                                <td>{{wagon.actual_run}}</td>\r\n                                <td>{{wagon.rest_run}}</td>\r\n                                <td>{{wagon.run_limit}}</td>\r\n                                <td>{{wagon.run_over_limit}}</td>\r\n\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>  \r\n                </div>                                   \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Модернизация\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonModel.number}}</th>\r\n                            <th>{{WagonModernisationModel.last_date}}</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagon in WagonsModernisationModel\" :key=\"wagon.id\">\r\n                            <td>{{wagon.number}}</td>\r\n                            <td>{{wagon.last_date}}</td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>                                   \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Аренда\" @click=\"arenda()\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonRentModel.rent_doc}}</th>\r\n                            <th>{{WagonRentModel.rent_doc_counterparty}}</th>\r\n                            <th>{{WagonRentModel.acceptance_certificate_number}}</th>\r\n                            <th>{{WagonRentModel.acceptance_certificate_date}}</th>\r\n                            <th>{{WagonRentModel.rent_start_date}}</th>\r\n                            <th>{{WagonRentModel.wagon}}</th>\r\n                            <th>{{WagonRentModel.acceptance_station}}</th>\r\n\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagonrent in WagonsRentModel\" :key=\"wagonrent.id\">\r\n                            <td>{{wagonrent.rent_doc}}</td>\r\n                            <td>{{wagonrent.rent_doc_counterparty}}</td>\r\n                            <td>{{wagonrent.acceptance_certificate_number}}</td>\r\n                            <td>{{wagonrent.acceptance_certificate_date}}</td>\r\n                            <td>{{wagonrent.rent_start_date}}</td>\r\n                            <td>{{wagonrent.wagon}}</td>\r\n                            <td>{{wagonrent.acceptance_station}}</td>\r\n\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>    \r\n                </div>                                 \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Лизинг\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonModel.number}}</th>\r\n                            <th>{{WagonLeasingModel.leasing_doc}}</th>\r\n                            <th>{{WagonLeasingModel.leasing_doc_lifetime}}</th>\r\n\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagon in WagonsLeasingModel\" :key=\"wagon.id\">\r\n                            <td>{{wagon.number}}</td>\r\n                            <td>{{wagon.leasing_doc}}</td>\r\n                            <td>{{wagon.leasing_doc_lifetime}}</td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>  \r\n                </div>                                   \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"Страхование\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                        <tr>\r\n                            <th>{{WagonModel.number}}</th>\r\n                            <th>{{WagonInsuranceModel.insurance_doc}}</th>\r\n                            <th>{{WagonInsuranceModel.insurance_doc_lifetime}}</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-for=\"wagon in WagonsInsuranceModel\" :key=\"wagon.id\">\r\n                            <td>{{wagon.number}}</td>\r\n                            <td>{{wagon.insurance_doc}}</td>\r\n                            <td>{{wagon.insurance_doc_lifetime}}</td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>  \r\n                </div>                                   \r\n                </b-card-text>\r\n        </b-tab>\r\n        <b-tab title=\"ЭТРАН\">\r\n            <b-card-text style=\"margin-top: -30px;\">\r\n                <div style=\"width:100%; overflow: auto;\">\r\n                <table>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>{{WagonModel.number}}</th>\r\n                                <th>{{WagonEtranInfoModel.owner}}</th>\r\n                                <th>{{WagonEtranInfoModel.tenant}}</th>\r\n                                <th>{{WagonEtranInfoModel.signing}}</th>\r\n                                <th>{{WagonEtranInfoModel.parking}}</th>\r\n                                <th>{{WagonEtranInfoModel.telegram_number}}</th>\r\n                                <th>{{WagonEtranInfoModel.number_from_expeditor}}</th>\r\n                                \r\n\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr v-for=\"wagon in WagonsEtranInfoModel\" :key=\"wagon.id\">\r\n                                <td>{{wagon.number}}</td>\r\n                                <td>{{wagon.owner}}</td>\r\n                                <td>{{wagon.tenant}}</td>\r\n                                <td>{{wagon.signing}}</td>\r\n                                <td>{{wagon.parking}}</td>\r\n                                <td>{{wagon.telegram_number}}</td>\r\n                                <td>{{wagon.number_from_expeditor}}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table> \r\n                </div>                                    \r\n                </b-card-text>\r\n        </b-tab>\r\n    </b-tabs>\r\n</b-card>\r\n    </div>\r\n\r\n\r\n\r\n<section id=\"loading-page-lk\" style=\"display:none\">\r\n\r\n<svg version=\"1.1\" id=\"L7\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\r\n  viewBox=\"0 0 100 100\" enable-background=\"new 0 0 100 100\" xml:space=\"preserve\">\r\n <path fill=\"#C04945\" d=\"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3\r\n  c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#ECECEC\" d=\"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7\r\n  c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"1s\" \r\n         from=\"0 50 50\"\r\n         to=\"-360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#3D70A8\" d=\"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5\r\n  L82,35.7z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n</svg>\r\n  \r\n \r\n</section>\r\n \r\n<div style=\"display: flex; position: relative; left: 50%; transform: translate(-50%,0); margin-top: 1%; height: 50px; width: 100%\" id=\"pagination\">\r\n<div class=\"row\" style=\"display: flex; position: relative; left: 10%; transform: translate(-10%,0);\">\r\n    <div class=\"col-md-6\"><button style=\"float: left\" class=\"button Cancel\" v-if=\"prevLink\" @click=\"goToPage(prevLink)\"> << </button>\r\n</div>\r\n    <div class=\"col-md-6\"><button style=\"float: right; margin-left: 20%;\" class=\"button Cancel\" v-if=\"nextLink\" @click=\"goToPage(nextLink)\"> >> </button>\r\n</div>\r\n\r\n</div>\r\n    </div>\r\n\r\n</div>\r\n</template>\r\n    \r\n<style>\r\n.amount {\r\n    color: grey;\r\n    margin-bottom: -0.1%;\r\n    padding-left: 1%;\r\n\r\n}\r\n.searchWagon {\r\n    display: flex;\r\n    width: 30%;\r\n    height: 30px;\r\n    margin-bottom: 10px;\r\n    margin-top: 1%;\r\n    margin-left: 1%;\r\n}\r\n</style>\r\n\r\n    \r\n<script>\r\nimport { mapState } from 'vuex'\r\n\r\nimport api from \"@/api/wagonPark\"\r\nimport FilterWagon from '@/components/filter/FilterWagon.vue'\r\nexport default{\r\n    name: \"WagonTable\",\r\n    computed: {\r\n        ...mapState({\r\n            user: state => state.auth.user,\r\n            uid: state => state.auth.uid\r\n        })\r\n    },\r\n    components: {FilterWagon},\r\n    data() {\r\n        return {\r\n            nextLink: null,\r\n            prevLink: null,\r\n            activeWagonId: null,\r\n            filters:null,\r\n            numberWagon: null,\r\n            amount: null,\r\n            // checked: [],\r\n            WagonModel: {\r\n                number: \"Номер вагона\",\r\n                is_problem: \"Проблемность\",\r\n                volume: \"Объем вагона\",\r\n                type: \"Тип вагона\"\r\n            },\r\n            WagonStateModel: {\r\n                number: \"Номер вагона\",\r\n                state: \"Состояние\",\r\n                state_value: \"Значение \\\"Состояние\\\"\",\r\n                state_value_digital: \"Значение \\\"Состояние\\\" числовое\",\r\n                updated_at: \"Дата изменения состояния\"\r\n            },\r\n            WagonPassportModel: {\r\n                next_planed_repair_date: \"Дата следующего планового ремонта\",\r\n                last_planed_repair_date: \"Дата последнего планового ремонта\",\r\n                capacity: \"Грузоподъемность\",\r\n                model: \"Модель вагона\",\r\n                days_before_date_plan_repair: \"Дней до следующего планового ремонта\",\r\n                next_plan_repair_kind: \"Вид следующего планового ремонта\",\r\n                build_date: \"Дата постройки\",\r\n                lifetime: \"Срок службы\",\r\n                document: \"Скан паспорта\",\r\n                wagon: \"Вагон\"\r\n            },\r\n            WagonBelongModel: {\r\n                hash_value: \"Значение\",\r\n                name: \"Принадлежность\",\r\n                owner: \"Собственник\",\r\n                in_company_control: \"В управлении\",\r\n                wagon_source_company: \"Источник поступления вагона, организация\",\r\n                event_name: \"Событие\",\r\n                agreement: \"Соглашение\",\r\n                created_at: \"Дата создания\",\r\n                description: \"Описание\",\r\n                wagon: \"Вагон\"\r\n            },\r\n            WagonRepairModel: {\r\n                nrp: \"НРП (вагон в нерабочем парке)\",\r\n                malfunction_current: \"Неисправность текущая\",\r\n                repair_type: \"Тип ремонта (для НРП)\",\r\n                nrp_date: \"Дата НРП (перевода в нерабочий парк)\",\r\n                REPAIR_TYPES: [\r\n                    (\"Текущий\", \"current\"),\r\n                    (\"Плановый\", \"plan\")\r\n                ],\r\n                repair_kind: \"Текущий/Плановый\",\r\n                next_planed_repair_date: \"Дата следующего запланированного ремонта\",\r\n                next_planed_repair_depot: \"Депо следующего запланированного ремонта\",\r\n                status: \"Статус ремонта\",\r\n                repair_station_downtime: \"Простой на станции рмонта (дни)\",\r\n                malfunction_code: \"Код неисправности (НРП)\",\r\n                malfunction_kind: \"Вид неисправности (НРП)\",\r\n                repair_compensation: \"Ремонт возмещается (текущий)\"\r\n            },\r\n            WagonRestRunModel: {\r\n                actual_run: \"Фактический пробег\",\r\n                rest_run: \"Остаточный пробег\",\r\n                run_limit: \"Лимит пробега\",\r\n                run_over_limit: \"Пробег свыше лимита\"\r\n            },\r\n            WagonModernisationModel: {\r\n                last_date: \"Дата последней модернизации\"\r\n            },\r\n            WagonRentModel: {\r\n                rent_doc: \"Договор аренды\",\r\n                rent_doc_counterparty: \"Контрагент по договору\",\r\n                acceptance_certificate_number: \"Номер акта приема-передачи\",\r\n                acceptance_certificate_date: \"Дата акта приема-передачи\",\r\n                rent_start_date: \"Дата аренды\",\r\n                wagon: \"Вагон\",\r\n                acceptance_station: \"Станция приема-передачи\"\r\n            },\r\n            WagonLeasingModel: {\r\n                leasing_doc: \"Договор лизинга\",\r\n                leasing_doc_lifetime: \"Срок действия договора лизинга\",\r\n            },\r\n            WagonInsuranceModel: {\r\n                insurance_doc: \"Договор страхования\",\r\n                insurance_doc_lifetime: \"Срок действия договора страхования\"\r\n            },\r\n            WagonEtranInfoModel: {\r\n                owner: \"Собственник (по данным ЭТРАН, ГВЦ)\",\r\n                tenant: \"Арендатор (по данным ЭТРАН, ГВЦ)\",\r\n                signing: \"Визирование\",\r\n                parking: \"Отстой\",\r\n                telegram_number: \"№ телеграммы\",\r\n                number_from_expeditor: \"№ от экспедитора\"\r\n            },\r\n            WagonsModel: [],\r\n            WagonStatesModel: [],\r\n            WagonsPassportModel: [],\r\n            WagonsBelongModel: [],\r\n            WagonsRepairModel: [],\r\n            WagonsRestRunModel: [],\r\n            WagonsModernisationModel: [],\r\n            WagonsRentModel: [],\r\n            WagonsLeasingModel: [],\r\n            WagonsInsuranceModel: [],\r\n            WagonsEtranInfoModel: [],\r\n        };\r\n    },\r\n    methods: {\r\n        goToPage(link){\r\n        \r\n            let url = new URL(link)\r\n            let pageNumber  = url.searchParams.get(\"page\")\r\n            if(pageNumber != null){\r\n                this.filters.page = pageNumber \r\n            }else{\r\n                delete(this.filters.page)\r\n            }\r\n            this.Wagon()\r\n        },\r\n        getMoreData(wagonNumber){\r\n    \r\n            this.passport(wagonNumber)\r\n            this.belong(wagonNumber)\r\n        },\r\n        updateFilters(filters){\r\n            this.filters = filters\r\n        },\r\n\r\n        Wagon() {\r\n            document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n                api.getWagons(this.filters)\r\n                .then((response) => {\r\n                    this.WagonsModel = response.data.data;\r\n                    this.nextLink = response.data.links.next\r\n                    this.prevLink = response.data.links.previous\r\n                    this.amount = response.data.total_objects\r\n                    document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n            }).catch(err => {\r\n                console.log(err)\r\n            });\r\n        },\r\n\r\n        passport(wagonNumber = null) {\r\n            document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n            api.getPassport({wagon: wagonNumber})\r\n                .then((response) => {\r\n                    this.WagonsPassportModel = response.data.data;\r\n                    document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n     \r\n            });\r\n        },\r\n\r\n        arenda() {\r\n            document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n            api.getArenda()\r\n            .then((response) => {\r\n                    this.WagonsBelongModel = response.data.data;\r\n                    document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n    \r\n            });\r\n        },\r\n        belong(wagonNumber = null) {\r\n            document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n            api.getBelong({wagon: wagonNumber})\r\n                .then((response) => {\r\n                    this.WagonsBelongModel = response.data.data;\r\n                    document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n    \r\n            });\r\n        },\r\n        searchWagon(){\r\n            document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n                api.getCurrentWagon(this.numberWagon)\r\n\r\n                .then((response) => {\r\n                    this.WagonsModel = response.data.data;\r\n                    this.amount = response.data.total_objects\r\n                    this.passport(this.numberWagon)\r\n                    this.belong(this.numberWagon)\r\n\r\n                    document.getElementById('pagination').style.display = 'hidden'\r\n                    document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n                    document.getElementById(\"searchWagonPlace\").value = '';\r\n            }).catch(err => {\r\n                console.log(err)\r\n            });\r\n\r\n        }\r\n    }\r\n}\r\n\r\n   \r\n// belong(wagonNumber = null) {\r\n//             document.getElementById(\"loading-page-lk\").style.display = \"block\";\r\n//             api.getBelong({wagon: wagonNumber})\r\n//             const pretoken = JSON.parse(localStorage.getItem(\"vuex\"));\r\n//             const token = pretoken.auth.user.token;\r\n//             fetch(\"http://10.1.5.65/api/wagon-park/wagon-belong/\", {\r\n//                 headers: {\r\n//                     \"Authorization\": `Basic ${token}`\r\n//                 },\r\n//                 method: \"GET\"\r\n//             })\r\n//                 .then((response) => {\r\n//                     this.WagonsBelongModel = response.data.data.data;\r\n//                     document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n//                 if (response.ok) {\r\n//                     return response.json().then(r => {\r\n//                         this.WagonsBelongModel = r.data.data;\r\n//                         document.getElementById(\"loading-page-lk\").style.display = \"none\";\r\n//                         console.log(this.WagonsBelongModel);\r\n//                     });\r\n//                 }\r\n//                 else {\r\n//                     console.log(\"NOT OK\");\r\n//                 }\r\n//             });\r\n//         }        \r\n\r\n</script>\r\n    \r\n"]},"metadata":{},"sourceType":"module"}