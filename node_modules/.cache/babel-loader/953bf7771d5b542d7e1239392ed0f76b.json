{"ast":null,"code":"import { mapState } from \"vuex\";\nimport api from \"@/api/report\";\nimport wagonModal from '@/components/modalReport/modal.vue';\nimport BDRreport from '@/views/BDRreport.vue';\nexport default {\n  name: 'report',\n  components: {\n    wagonModal,\n    BDRreport\n  },\n  title: 'Отчеты',\n  computed: { ...mapState({\n      user: state => state.auth.user,\n      uid: state => state.auth.uid\n    })\n  },\n\n  data() {\n    return {\n      'staff': [],\n      'answer1': [],\n      'answer2': [],\n      'answer3': [],\n      'answer4': [],\n      'answer5': [],\n      'answer6': [],\n      btnName: 'Создать отчет по KPI сотрудника',\n      downloadReport: 'Загрузить отчеты',\n      'admin': [],\n      'reports_creator': [],\n      'reports_employee': [],\n      showReportModal: false,\n      loaderReport: false,\n      OnceReport: null,\n      allReportHistory: false,\n      all_grades: '',\n      file_port: false\n    };\n  },\n\n  mounted() {\n    this.loaderReport = true; // api.getUsers()\n\n    const pretoken = JSON.parse(localStorage.getItem(\"vuex\"));\n    const token = pretoken.auth.user.token;\n    const preid = JSON.parse(localStorage.getItem('vuex'));\n    const id = preid.auth.uid;\n    fetch('http://10.1.5.65/api/reports/kpi?' + `creator=${id}`, {\n      // fetch('/api/reports/kpi?'+ `creator=${id}`, {\n      headers: {\n        'Authorization': `Basic ${token}`\n      },\n      method: 'GET'\n    }).then(response => {\n      if (response.ok) {\n        return response.json().then(r => {\n          this.reports_creator = r.data; // document.getElementById('loading-page-report').style.display = 'none'\n          // console.log(this.reports_creator)\n        });\n      } else {\n        console.log('NOT OK'); // document.getElementById('loading-page-report').style.display = 'none'\n      }\n    }), fetch('http://10.1.5.65/api/reports/kpi?' + `employee=${id}`, {\n      // fetch('/api/reports/kpi?'+ `employee=${id}`, {\n      headers: {\n        'Authorization': `Basic ${token}`\n      },\n      method: 'GET'\n    }).then(response => {\n      if (response.ok) {\n        return response.json().then(r => {\n          this.reports_employee = r.data; // document.getElementById('loading-page-report').style.display = 'none'\n          // console.log(this.reports_employee)\n        });\n      } else {\n        console.log('NOT OK'); // document.getElementById('loading-page-report').style.display = 'none'\n      }\n    }), fetch('http://10.1.5.65/api/personal/users/?page_size=200&manager=' + `${id}`, {\n      // fetch('/api/personal/users/?page_size=200&manager='+ `${id}`, {\n      headers: {\n        'Authorization': `Basic ${token}`\n      },\n      method: 'GET'\n    }).then(response => {\n      if (response.ok) {\n        return response.json().then(r => {\n          this.staff = r.data;\n          this.loaderReport = false; // document.getElementById('loading-page-lk').style.display = 'none'\n          // console.log(this.staff)\n        });\n      } else {\n        console.log('NOT OK');\n      }\n    }), fetch('http://10.1.5.65/api/personal/users/104', {\n      // fetch('/api/personal/users/104', {\n      headers: {\n        'Authorization': `Basic ${token}`\n      },\n      method: 'GET'\n    }).then(response => {\n      if (response.ok) {\n        return response.json().then(r => {\n          this.admin = r; // document.getElementById('loading-page-lk').style.display = 'none'\n          // console.log(this.admin)\n        });\n      } else {\n        console.log('NOT OK');\n      }\n    }), fetch('http://10.1.5.65/api/reports/kpi/', {\n      // fetch('/api/reports/kpi/', {\n      headers: {\n        'Authorization': `Basic ${token}`\n      },\n      method: 'GET'\n    }).then(response => {\n      if (response.ok) {\n        return response.json().then(r => {\n          this.all_reports = r.data; // document.getElementById('loading-page-report').style.display = 'none'\n          // console.log(this.all_reports)\n        });\n      } else {\n        console.log('NOT OK');\n        document.getElementById('loading-page-report').style.display = 'none';\n      }\n    });\n  },\n\n  methods: {\n    Not() {\n      document.getElementById('notifications').style.display = 'none';\n    },\n\n    Not2() {\n      document.getElementById('notifications-2').style.display = 'none';\n    },\n\n    OpenKPI() {\n      if (document.getElementById(\"Anketa\").style.display == 'block') {\n        document.getElementById(\"Anketa\").style.display = \"none\";\n        this.btnName = 'Создать отчет по KPI сотрудника';\n      } else {\n        document.getElementById(\"Anketa\").style.display = \"block\";\n        this.btnName = 'Скрыть отчет по KPI сотрудника';\n      }\n    },\n\n    allGrades() {\n      this.loaderReport = true;\n      api.getAllgrades().then(response => {\n        this.all_grades = response.data;\n        this.loaderReport = false;\n      });\n    },\n\n    OpenReport() {\n      const pretoken = JSON.parse(localStorage.getItem(\"vuex\"));\n      const token = pretoken.auth.user.token;\n      const preid = JSON.parse(localStorage.getItem('vuex'));\n      const id = preid.auth.uid;\n      this.loaderReport = true;\n      this.allReportHistory = true;\n      this.downloadReport = 'Загрузить отчеты';\n      fetch('http://10.1.5.65/api/reports/kpi?' + `creator=${id}`, {\n        // fetch('/api/reports/kpi?'+ `creator=${id}`, {\n        headers: {\n          'Authorization': `Basic ${token}`\n        },\n        method: 'GET'\n      }).then(response => {\n        if (response.ok) {\n          return response.json().then(r => {\n            this.reports_creator = r.data;\n          });\n        } else {\n          console.log('NOT OK');\n        }\n      }), fetch('http://10.1.5.65/api/reports/kpi?' + `employee=${id}`, {\n        // fetch('/api/reports/kpi?'+ `employee=${id}`, {\n        headers: {\n          'Authorization': `Basic ${token}`\n        },\n        method: 'GET'\n      }).then(response => {\n        if (response.ok) {\n          return response.json().then(r => {\n            this.reports_employee = r.data;\n            this.loaderReport = false;\n          });\n        } else {\n          console.log('NOT OK');\n        }\n      });\n    },\n\n    OpenChangeReport(id) {\n      this.loaderReport = true;\n      api.getReportById(id).then(response => {\n        this.showReportModal = true;\n        this.loaderReport = false;\n        this.OnceReport = response.data;\n      });\n    },\n\n    closeChangeReport() {\n      this.showReportModal = false;\n    },\n\n    Send() {\n      event.preventDefault();\n      const pretoken = JSON.parse(localStorage.getItem(\"vuex\"));\n      const token = pretoken.auth.user.token;\n      this.loaderReport = true; // document.getElementById('loading-page-lk').style.display = 'block'\n\n      let admin = document.getElementById('admin').value.split(' ')[0];\n      let staff = document.getElementById('staff').value.split(' ')[0];\n      fetch('http://10.1.5.65/api/reports/kpi/create/', {\n        // fetch('/api/reports/kpi/create/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n          'Authorization': `Basic ${token}`\n        },\n        body: JSON.stringify({\n          \"employee\": staff,\n          \"manager\": admin,\n          \"a1\": this.answer1,\n          \"a2\": this.answer2,\n          \"a3\": this.answer3,\n          \"a4\": this.answer4,\n          \"a5\": this.answer5,\n          \"a6\": this.answer6\n        })\n      }).then(response => {\n        if (response.ok) {\n          return response.json().then(data => {\n            this.loaderReport = false;\n            document.getElementById('notifications').style.display = 'block';\n            setTimeout(this.Not, 1500);\n            document.getElementById(\"Anketa\").reset();\n          });\n        } else {\n          document.getElementById('loading-page-lk').style.display = 'none';\n          document.getElementById('notifications-2').style.display = 'block';\n          setInterval(this.Not2, 1500);\n          console.log(response);\n        }\n      });\n    },\n\n    DeleteReport(id) {\n      this.loaderReport = true;\n      api.deleteReport(id).then(response => {\n        window.location.reload();\n        this.loaderReport = false;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAuRA;AACA;AACA;AACA;AAEA;EACAA,cADA;EAEAC;IAAAC;IAAAC;EAAA,CAFA;EAGAC,eAHA;EAIAC,YACA;MACAC,8BADA;MAEAC;IAFA;EADA,CAJA;;EAUAC;IACA;MACA,WADA;MAEA,aAFA;MAGA,aAHA;MAIA,aAJA;MAKA,aALA;MAMA,aANA;MAOA,aAPA;MAQAC,0CARA;MASAC,kCATA;MAUA,WAVA;MAWA,qBAXA;MAYA,sBAZA;MAaAC,sBAbA;MAcAC,mBAdA;MAeAC,gBAfA;MAgBAC,uBAhBA;MAiBAC,cAjBA;MAkBAC;IAlBA;EAqBA,CAhCA;;EAiCAC;IACA,yBADA,CAEA;;IACA;IACA;IACA;IACA;IACAC;MACA;MAEAC;QACA;MADA,CAHA;MAMAC;IANA,GAQAC,IARA,CAQAC;MACA;QACA;UACA,8BADA,CAEA;UACA;QACA,CAJA;MAKA,CANA,MAOA;QACAC,sBADA,CAEA;MAEA;IACA,CArBA,GAsBAL;MACA;MAEAC;QACA;MADA,CAHA;MAMAC;IANA,GAQAC,IARA,CAQAC;MACA;QACA;UACA,+BADA,CAEA;UACA;QACA,CAJA;MAKA,CANA,MAOA;QACAC,sBADA,CAEA;MAEA;IACA,CArBA,CAtBA,EA4CAL;MACA;MAEAC;QACA;MADA,CAHA;MAMAC;IANA,GAQAC,IARA,CAQAC;MACA;QACA;UACA;UACA,0BAFA,CAGA;UACA;QACA,CALA;MAMA,CAPA,MAQA;QACAC;MACA;IACA,CApBA,CA5CA,EAiEAL;MACA;MAEAC;QACA;MADA,CAHA;MAMAC;IANA,GAQAC,IARA,CAQAC;MACA;QACA;UACA,eADA,CAEA;UACA;QACA,CAJA;MAKA,CANA,MAOA;QACAC;MACA;IACA,CAnBA,CAjEA,EAqFAL;MACA;MACAC;QACA;MADA,CAFA;MAKAC;IALA,GAOAC,IAPA,CAOAC;MACA;QACA;UACA,0BADA,CAEA;UACA;QACA,CAJA;MAKA,CANA,MAOA;QACAC;QACAC;MAEA;IACA,CApBA,CArFA;EA2GA,CAnJA;;EAoJAC;IACAC;MACAF;IACA,CAHA;;IAIAG;MACAH;IACA,CANA;;IAQAI;MACA;QACAJ;QACA;MACA,CAHA,MAIA;QACAA;QACA;MACA;IACA,CAjBA;;IAkBAK;MACA;MACAC,mBACAT,IADA,CACAC;QACA;QACA;MAGA,CANA;IAOA,CA3BA;;IA4BAS;MACA;MACA;MACA;MAEA;MACA;MACA;MACA;MACAb;QACA;QAEAC;UACA;QADA,CAHA;QAMAC;MANA,GAQAC,IARA,CAQAC;QACA;UACA;YACA;UAEA,CAHA;QAIA,CALA,MAMA;UACAC;QAEA;MACA,CAnBA,GAoBAL;QACA;QAEAC;UACA;QADA,CAHA;QAMAC;MANA,GAQAC,IARA,CAQAC;QACA;UACA;YACA;YACA;UACA,CAHA;QAIA,CALA,MAMA;UACAC;QACA;MACA,CAlBA,CApBA;IAuCA,CA5EA;;IA6EAS;MACA;MACAF,sBACAT,IADA,CACAC;QACA;QACA;QACA;MACA,CALA;IAOA,CAtFA;;IAwFAW;MACA;IACA,CA1FA;;IA4FAC;MACAC;MACA;MACA;MACA,yBAJA,CAKA;;MACA;MACA;MACAjB;QACA;QAEAE,cAHA;QAIAD;UACA,gDADA;UAEA;QAFA,CAJA;QAQAiB;UACA,iBADA;UAEA,gBAFA;UAGA,kBAHA;UAIA,kBAJA;UAKA,kBALA;UAMA,kBANA;UAOA,kBAPA;UAQA;QARA;MARA,GAmBAf,IAnBA,CAmBAC;QACA;UACA;YACA;YAEAE;YACAa;YACAb;UACA,CANA;QAOA,CARA,MASA;UACAA;UACAA;UACAc;UACAf;QAEA;MACA,CApCA;IAqCA,CAzIA;;IA0IAgB;MACA;MACAT,qBACAT,IADA,CACAC;QACAkB;QACA;MACA,CAJA;IAKA;;EAjJA;AApJA","names":["name","components","wagonModal","BDRreport","title","computed","user","uid","data","btnName","downloadReport","showReportModal","loaderReport","OnceReport","allReportHistory","all_grades","file_port","mounted","fetch","headers","method","then","response","console","document","methods","Not","Not2","OpenKPI","allGrades","api","OpenReport","OpenChangeReport","closeChangeReport","Send","event","body","setTimeout","setInterval","DeleteReport","window"],"sourceRoot":"src/views","sources":["report.vue"],"sourcesContent":["<template>\r\n    <div class=\"lk\">\r\n<wagonModal v-if=\"showReportModal\" :OnceReport=\"OnceReport\" @close=\"closeChangeReport\"></wagonModal>\r\n        <h2>Отчеты</h2>\r\n   \r\n        <button class=\"button Action\" @click=\"OpenKPI()\" style=\"width: 52%; position: relative; left: 50%; transform: translate(-50%,0); font-size: 17px; margin-top: 3%\">{{ btnName }}</button>\r\n        <br><br>\r\n    <form id=\"Anketa\" method=\"post\" style=\"display: none\">\r\n        <br>\r\n    <label  for=\"admin\" style=\" position: relative; left: 50%; transform: translate(-50%, 0); width: 100% !important;\">\r\n\r\n    <p style=\"text-align:center;\">Копия письма: кадровая служба (обязательное поле)</p>    \r\n    <select id=\"admin\" required style=\"width: 50% !important;\" >\r\n        <option selected=\"selected\">{{admin.id}} {{admin.first_name}} {{admin.last_name}}</option>\r\n    </select>\r\n    </label>\r\n\r\n<br>\r\n<br>\r\n\r\n    <label  for=\"staff\" style=\" position: relative; left: 50%; transform: translate(-50%, 0); width: 100% !important;\">\r\n        \r\n        <select id=\"staff\" required style=\"width: 50% !important;\">\r\n            <option value=\"\" disabled=\"disabled\" selected=\"selected\">Сотрудник</option>\r\n            <option  v-for=\"staf in staff\" :key=\"staf.id\">{{staf.id}} {{staf.first_name}} {{staf.last_name}}</option>\r\n        </select>\r\n    </label>\r\n\r\n\r\n\r\n\r\n        <div id=\"block-answer\">\r\n            <h2>Анкета сотрудника</h2>\r\n      <p class=\"answer\" name=\"a1\">1. Готовность неукоснительно выполнять все производственные задания, порученные руководителем.</p>\r\n\r\n     \r\n        <input type=\"radio\" name=\"first-question\" id=\"first-question-1\"  value=\"c1\" v-model=\"answer1\">\r\n        <label for=\"first-question-1\">&nbsp;Неисполнителен, склонен под любыми предлогами избегать получения новых заданий. Были случаи прямого отказа от выполнения заданий.</label><br>\r\n\r\n        <input type=\"radio\" name=\"first-question\" id=\"first-question-2\" value=\"c2\"  v-model=\"answer1\">\r\n        <label  for=\"first-question-2\">&nbsp;Низкий уровень исполнительности. Иногда пытается избежать получения новых заданий, умело находя предлоги</label><br>\r\n\r\n        <input type=\"radio\" name=\"first-question\" id=\"first-question-3\"  value=\"c3\"  v-model=\"answer1\">\r\n        <label for=\"first-question-3\" >&nbsp;Хороший уровень исполнительности, но нельзя сказать, что каждый день без исключений. Берется за выполнение любых производственных заданий, но не всегда охотно.</label><br>\r\n\r\n        <input type=\"radio\" name=\"first-question\" id=\"first-question-4\"  value=\"c4\"  v-model=\"answer1\">\r\n        <label for=\"first-question-4\" >&nbsp;Безукоризненный уровень исполнительности. Всегда охотно берется за выполнение всех производственных заданий, порученных руководителем.</label><br>\r\n<hr>\r\n       <p class=\"answer\"  name=\"a2\">2. Способность справляться со своими обязанностями и поручениями. Умение выявлять и решать возникающие в работе проблемы</p>\r\n     \r\n        <input type=\"radio\" name=\"second-question\" id=\"second-question-1\"  value=\"c1\"  v-model=\"answer2\">\r\n        <label for=\"second-question-1\" >&nbsp;Часто не справляется со своими обязанностями и поручениями или заданиями. Не умеет выявлять проблемы и с трудом решает их</label><br>\r\n\r\n        <input type=\"radio\" name=\"second-question\" id=\"second-question-2\"  value=\"c2\"  v-model=\"answer2\">\r\n        <label for=\"second-question-2\">&nbsp;Как правило справляется со своими обязанностями, но порой не выполняет их так как надо или с трудом решает возникающие проблемы</label><br>\r\n\r\n        <input type=\"radio\" name=\"second-question\" id=\"second-question-3\"  value=\"c3\"  v-model=\"answer2\">\r\n        <label for=\"second-question-3\" > &nbsp;Практически всегда хорошо справляется со всеми обязанностями, умело решает проблемы, но нельзя сказать, что каждый день без исключений</label><br>\r\n\r\n        <input type=\"radio\" name=\"second-question\" id=\"second-question-4\"  value=\"c4\"  v-model=\"answer2\">\r\n        <label for=\"second-question-4\" > &nbsp;Проявляет отличную способность справляться со всеми обязанностями и производственными заданиями. Всегда умело выявляет и быстро решает возникающие проблемы</label><br>\r\n     \r\n        <hr>\r\n\r\n    <p class=\"answer\"  name=\"a3\">3. Компетентность. Знание используемых приемов и методов работы и умение в точности им следовать, наличие необходимых навыков</p>\r\n\r\n     \r\n        <input type=\"radio\" name=\"third-question\" id=\"third-question-1\"   value=\"c1\"  v-model=\"answer3\">\r\n        <label for=\"third-question-1\">&nbsp;Некомпетентен. Не знает используемые приемы и методы работы и не стремится быстро освоить их</label><br>\r\n\r\n        <input type=\"radio\" name=\"third-question\" id=\"third-question-2\"  value=\"c2\" v-model=\"answer3\">\r\n        <label for=\"third-question-2\">&nbsp;Недостаточно хорошо знает нужные приемы работы, пока имеет слабые навыки и медленно их развивает</label><br>\r\n\r\n        <input type=\"radio\" name=\"third-question\" id=\"third-question-3\"   value=\"c3\" v-model=\"answer3\">\r\n        <label for=\"third-question-3\" >&nbsp;Хорошо знает используемые методы работы, но нельзя сказать, что всегда в точности следует им</label><br>\r\n\r\n        <input type=\"radio\" name=\"third-question\" id=\"third-question-4\"  value=\"c4\" v-model=\"answer3\">\r\n        <label for=\"third-question-4\" >&nbsp;Компетентен. Отлично знает все методы работы и неукоснительно следует им каждый рабочий день</label><br>\r\n        <hr>\r\n\r\n\r\n      <p class=\"answer\" name=\"a4\">4. Заинтересованность и активность в вопросах повышения качества, производительности труда и освоения эффективных методов работы</p>\r\n\r\n     \r\n        <input type=\"radio\" name=\"fourth-question\" id=\"fourth-question-1\"  value=\"c1\" v-model=\"answer4\">\r\n        <label for=\"fourth-question-1\">&nbsp;Часто сопротивляется внедрению новых технологий, методов работы, направленных на повышение качества и производительности труда</label><br>\r\n\r\n        <input type=\"radio\" name=\"fourth-question\" id=\"fourth-question-2\"  value=\"c2\" v-model=\"answer4\">\r\n        <label  for=\"fourth-question-2\">&nbsp;Не сопротивляется, но и не проявляет интереса к вопросам повышения качества и производительности труда</label><br>\r\n\r\n        <input type=\"radio\" name=\"fourth-question\" id=\"fourth-question-3\"  value=\"c3\" v-model=\"answer4\">\r\n        <label for=\"fourth-question-3\" >&nbsp;Всегда поддерживает все нововведения, помогает осваивать новые методы работы, но не в достаточной степени активно</label><br>\r\n\r\n        <input type=\"radio\" name=\"fourth-question\" id=\"fourth-question-4\"  value=\"c4\" v-model=\"answer4\">\r\n        <label for=\"fourth-question-4\" > &nbsp;Не только активно помогает осваивать новые методы работы, но и сам часто выдвигает различные рационализаторские предложения</label><br>\r\n        <hr>\r\n\r\n      <p class=\"answer\"  name=\"a5\">5. Выполнение планового объема работ по выданным производственным заданиям.</p>\r\n\r\n     \r\n        <input type=\"radio\" name=\"fifth-question\" id=\"fifth-question-1\"  value=\"c1\" v-model=\"answer5\">\r\n        <label for=\"fifth-question-1\" >&nbsp;Не выполнялись запланированные работы по заданиям в срок</label><br>\r\n\r\n        <input type=\"radio\" name=\"fifth-question\" id=\"fifth-question-2\"  value=\"c2\" v-model=\"answer5\">\r\n        <label for=\"fifth-question-2\">&nbsp;Имели место случаи недовы-полнения в полном объеме запланированных работ по заданиям</label><br>\r\n\r\n        <input type=\"radio\" name=\"fifth-question\" id=\"fifth-question-3\"  value=\"c3\" v-model=\"answer5\">\r\n        <label for=\"fifth-question-3\" >&nbsp;Выполнялся весь объем запланированных работ, но были случаи нарушения сроков</label><br>\r\n\r\n        <input type=\"radio\" name=\"fifth-question\" id=\"fifth-question-4\"  value=\"c4\" v-model=\"answer5\">\r\n        <label for=\"fifth-question-4\" >&nbsp;Все запланированные работы по заданиям выполнялись в полном объеме и в установленные сроки </label><br>\r\n        <hr>\r\n\r\n      <p class=\"answer\" name=\"a6\">6. Качество выполненных работ, поручений.</p>\r\n\r\n        <input type=\"radio\" name=\"sixth-question\" id=\"sixth-question-1\"  value=\"c1\" v-model=\"answer6\">\r\n        <label for=\"sixth-question-1\">&nbsp;Работы выполнялись некачественно. Имелись случаи брака и возврата заданий на доработку</label><br>\r\n\r\n        <input type=\"radio\" name=\"sixth-question\" id=\"sixth-question-2\" value=\"c2\"  v-model=\"answer6\">\r\n        <label for=\"sixth-question-2\">&nbsp;Хотя и очень редки случаи брака в работе, но были погрешности и недоработки</label><br>\r\n\r\n        <input type=\"radio\" name=\"sixth-question\" id=\"sixth-question-3\"  value=\"c3\"  v-model=\"answer6\">\r\n        <label for=\"sixth-question-3\">&nbsp;Работы выполнялись достаточно качественно, но имели место небольшие погрешности.</label><br>\r\n\r\n        <input type=\"radio\" name=\"sixth-question\" id=\"sixth-question-4\"  value=\"c4\"  v-model=\"answer6\">\r\n        <label for=\"sixth-question-4\">&nbsp;Работы выполнялись безукоризненно, аккуратно, четко, без брака, всегда в строгом соответствии со стандартами</label><br>\r\n<hr> \r\n\r\n      <br>\r\n        <button style=\"position: relative; left: 50%; width: 90%; transform: translate(-50%,0);  margin-bottom: 2%;margin-top: 3%;height: 80px;font-size: 22px;\"\r\n         type=\"submit\" @click=\"Send()\">Отправить\r\n        </button>\r\n    </div>\r\n    <br><br><br>\r\n\r\n    </form>\r\n    \r\n\r\n    <section id=\"loading-page-lk\" style=\"display:block\" v-if=\"loaderReport\">\r\n\r\n<svg version=\"1.1\" id=\"L7\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\r\n  viewBox=\"0 0 100 100\" enable-background=\"new 0 0 100 100\" xml:space=\"preserve\">\r\n <path fill=\"#C04945\" d=\"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3\r\n  c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#ECECEC\" d=\"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7\r\n  c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"1s\" \r\n         from=\"0 50 50\"\r\n         to=\"-360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#3D70A8\" d=\"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5\r\n  L82,35.7z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n</svg>\r\n  \r\n  </section>\r\n\r\n<div class=\"wrapper-success\" id=\"notifications\" style=\"display:none\">\r\n    <div class=\"card\">\r\n        <div class=\"subject\">\r\n        <h5>Успешно</h5>\r\n        <p>Ваша анкета отправлена</p>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"wrapper-alert\" id=\"notifications-2\" style=\"display: none;\">\r\n<div class=\"card\">\r\n    <div class=\"subject\">\r\n    <h5>Ошибка</h5>\r\n    <p>У вас нет прав доступа на предоставление </p>\r\n    </div>\r\n</div>\r\n</div>\r\n\r\n\r\n\r\n<b-container class=\"bv-example-row\">\r\n     <b-row>\r\n    <b-col>\r\n        <button class=\"button Action\" @click=\"OpenReport()\" style=\"width: 60%; position: relative; left: 50%; transform: translate(-50%,0); font-size: 17px; margin-top: 3%\">{{downloadReport}}</button>\r\n    </b-col>\r\n\r\n    <b-col>\r\n        <a  @click=allGrades()  style=\"width: 60%; position: relative; left: 50%; transform: translate(-50%,0); font-size: 17px; margin-top: 2%\">Все оценки</a>\r\n        <a target=\"_blank\" :href=\"this.all_grades\">скачать</a>\r\n    </b-col>\r\n  </b-row>\r\n\r\n</b-container>\r\n<br><br>\r\n\r\n\r\n<div class=\"row container-fluid\" v-if=\"allReportHistory\">\r\n    <div class=\"col-md-6 w-90\" style=\"overflow-x: auto\">\r\n        <h5 align=\"center\">Созданные Вами отчеты</h5>\r\n        <table class=\"table\" border=\"1\">\r\n                <tr>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Кто создал</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">На кого создано</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Дата создания</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Дата последнего изменения</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Доплата</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Файл</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Действие</td>\r\n                    <td style=\"text-align:center; font-size: 12px;\">Удалить</td>\r\n                </tr>\r\n\r\n                <tr v-for=\"reports in reports_creator\" :key=\"reports.id\" >\r\n                    <td>{{reports.creator.first_name}} {{reports.creator.last_name}} <br></td>\r\n                    <td>{{reports.employee.first_name}}  {{reports.employee.last_name}}  <br></td> \r\n                    <td>{{new Date(reports.created_at).toLocaleString()}}<br> </td> \r\n                    <td>{{new Date(reports.updated_at).toLocaleString()}}<br> </td> \r\n                    <td>{{reports.rate}} %<br></td> \r\n                    <td><a download target=\"_blank\" :href=\"reports.file\" v-if=\"reports.file\"><img src=\"../assets/excel.png\" alt=\"\" width=\"50px!important\"></a> </td> \r\n                    <td><button class=\"button Request\" style=\"height: 30px; width: 100%; font-size:12px; position: relative; left: 50%; transform: translate(-50%,0); display: block; background: #2196F3 !important;   display: flex; align-items: center;\r\njustify-content: center;\" @click=\"OpenChangeReport(reports.id)\">Подробнее</button> </td> \r\n                    <td><button class=\"button Delete\" style=\"height: 30px; width: 100%; font-size:12px; position: relative; left: 50%; transform: translate(-50%,0); display: block; background: #ED5E68 !important;   display: flex;\r\n  align-items: center;\r\n  justify-content: center;\" @click=\"DeleteReport(reports.id)\">Удалить</button> </td> \r\n                </tr>\r\n            </table>  \r\n    </div>\r\n\r\n    <div class=\"col-md-6 w-90\" style=\"overflow-x: auto\">\r\n            <h5 align=\"center\">Созданные на Вас отчеты</h5>\r\n            <table class=\"table\">\r\n            <tr>\r\n                <td style=\"text-align:center; font-size: 12px;\">Кто создал</td>\r\n                <td style=\"text-align:center; font-size: 12px;\">На кого создано</td>\r\n                <td style=\"text-align:center; font-size: 12px;\">Дата создания</td>\r\n                <td style=\"text-align:center; font-size: 12px;\">Дата последнего изменения</td>\r\n                <td style=\"text-align:center; font-size: 12px;\">Доплата</td>\r\n                <td style=\"text-align:center; font-size: 12px;\">Файл</td>\r\n            </tr>\r\n\r\n            <tr v-for=\"reporte in reports_employee\" :key=\"reporte.id\" >\r\n                <td>{{reporte.creator.first_name}} {{reporte.creator.last_name}}<br></td>\r\n                <td>{{reporte.employee.first_name}} {{reporte.employee.last_name}} <br></td>\r\n                <td>{{new Date(reporte.created_at).toLocaleString()}}<br></td>\r\n                <td>{{new Date(reporte.updated_at).toLocaleString()}}<br></td>\r\n                <td>{{reporte.rate}} %   <br></td>\r\n                <td><a download target=\"_blank\" :href=\"reporte.file\" v-if=\"reporte.file\"><img src=\"../assets/excel.png\" alt=\"\" width=\"50px !important\"></a></td>\r\n            </tr> \r\n            </table>\r\n    </div>\r\n</div>\r\n\r\n\r\n<hr>\r\n\r\n<BDRreport></BDRreport>\r\n</div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport {mapState} from \"vuex\";\r\nimport api from \"@/api/report\"\r\nimport wagonModal from '@/components/modalReport/modal.vue'\r\nimport BDRreport from '@/views/BDRreport.vue'\r\n\r\nexport default{\r\nname: 'report',\r\ncomponents: {wagonModal, BDRreport},\r\ntitle: 'Отчеты',\r\ncomputed: {\r\n    ...mapState({\r\n        user: state => state.auth.user,\r\n        uid: state => state.auth.uid\r\n    })\r\n    },\r\ndata(){\r\n    return{\r\n        'staff': [],\r\n        'answer1': [],\r\n        'answer2': [],\r\n        'answer3': [],\r\n        'answer4': [],\r\n        'answer5': [],\r\n        'answer6': [],\r\n        btnName : 'Создать отчет по KPI сотрудника',\r\n        downloadReport: 'Загрузить отчеты',\r\n        'admin': [],\r\n        'reports_creator': [],\r\n        'reports_employee': [],\r\n        showReportModal: false,\r\n        loaderReport: false,\r\n        OnceReport: null,\r\n        allReportHistory: false,\r\n        all_grades: '',\r\n        file_port: false,\r\n\r\n    }\r\n},\r\nmounted(){\r\nthis.loaderReport = true\r\n// api.getUsers()\r\nconst pretoken = JSON.parse(localStorage.getItem(\"vuex\"))\r\nconst token = pretoken.auth.user.token\r\nconst preid = JSON.parse(localStorage.getItem('vuex'))\r\nconst id = preid.auth.uid\r\nfetch('http://10.1.5.65/api/reports/kpi?'+ `creator=${id}`, {\r\n    // fetch('/api/reports/kpi?'+ `creator=${id}`, {\r\n\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n    })\r\n    .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then(r=>{\r\n            this.reports_creator = r.data;\r\n            // document.getElementById('loading-page-report').style.display = 'none'\r\n            // console.log(this.reports_creator)\r\n    })\r\n}\r\n    else{\r\n        console.log('NOT OK')\r\n        // document.getElementById('loading-page-report').style.display = 'none'\r\n\r\n    }\r\n}),\r\nfetch('http://10.1.5.65/api/reports/kpi?'+ `employee=${id}`, {\r\n    // fetch('/api/reports/kpi?'+ `employee=${id}`, {\r\n\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n    })\r\n    .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then(r=>{\r\n            this.reports_employee = r.data;\r\n            // document.getElementById('loading-page-report').style.display = 'none'\r\n            // console.log(this.reports_employee)\r\n    })\r\n}\r\n    else{\r\n        console.log('NOT OK')\r\n        // document.getElementById('loading-page-report').style.display = 'none'\r\n\r\n    }\r\n}),     \r\nfetch('http://10.1.5.65/api/personal/users/?page_size=200&manager='+ `${id}`, {\r\n    // fetch('/api/personal/users/?page_size=200&manager='+ `${id}`, {\r\n\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n})\r\n.then((response) => {\r\n            if (response.ok){\r\n                return response.json().then(r=>{\r\n                    this.staff = r.data;\r\n                    this.loaderReport = false\r\n                    // document.getElementById('loading-page-lk').style.display = 'none'\r\n                    // console.log(this.staff)\r\n            })\r\n        }\r\n        else{\r\n            console.log('NOT OK')\r\n        }\r\n    }),\r\nfetch('http://10.1.5.65/api/personal/users/104', {\r\n    // fetch('/api/personal/users/104', {\r\n\r\nheaders: {\r\n    'Authorization': `Basic ${token}` \r\n},\r\nmethod: 'GET'\r\n})\r\n.then((response) => {\r\n            if (response.ok){\r\n                return response.json().then(r=>{\r\n                    this.admin = r;\r\n                    // document.getElementById('loading-page-lk').style.display = 'none'\r\n                    // console.log(this.admin)\r\n            })\r\n        }\r\n        else{\r\n            console.log('NOT OK')\r\n        }\r\n    }),\r\n    fetch('http://10.1.5.65/api/reports/kpi/', {\r\n        // fetch('/api/reports/kpi/', {\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n    })\r\n    .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then(r=>{\r\n            this.all_reports = r.data;\r\n            // document.getElementById('loading-page-report').style.display = 'none'\r\n            // console.log(this.all_reports)\r\n    })\r\n}\r\n    else{\r\n        console.log('NOT OK')\r\n        document.getElementById('loading-page-report').style.display = 'none'\r\n\r\n    }\r\n})\r\n\r\n},\r\nmethods: { \r\n Not(){\r\n    document.getElementById('notifications').style.display = 'none'\r\n },\r\n Not2(){\r\n    document.getElementById('notifications-2').style.display = 'none'\r\n }, \r\n\r\nOpenKPI(){\r\nif (document.getElementById(\"Anketa\").style.display == 'block') { \r\n    document.getElementById(\"Anketa\").style.display = \"none\";\r\n    this.btnName = 'Создать отчет по KPI сотрудника'\r\n}\r\nelse {\r\n    document.getElementById(\"Anketa\").style.display = \"block\";\r\n    this.btnName = 'Скрыть отчет по KPI сотрудника'\r\n    }\r\n },\r\n allGrades(){\r\n    this.loaderReport = true\r\n    api.getAllgrades()\r\n    .then(response => {\r\n        this.all_grades = response.data\r\n            this.loaderReport = false\r\n\r\n\r\n    })\r\n },\r\nOpenReport(){\r\nconst pretoken = JSON.parse(localStorage.getItem(\"vuex\"))\r\nconst token = pretoken.auth.user.token\r\nconst preid = JSON.parse(localStorage.getItem('vuex'))\r\n\r\nconst id = preid.auth.uid\r\nthis.loaderReport = true\r\nthis.allReportHistory = true\r\nthis.downloadReport = 'Загрузить отчеты'\r\nfetch('http://10.1.5.65/api/reports/kpi?'+ `creator=${id}`, {\r\n    // fetch('/api/reports/kpi?'+ `creator=${id}`, {\r\n\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n    })\r\n    .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then(r=>{\r\n            this.reports_creator = r.data;\r\n            \r\n    })\r\n}\r\n    else{\r\n        console.log('NOT OK')\r\n\r\n    }\r\n}),\r\nfetch('http://10.1.5.65/api/reports/kpi?'+ `employee=${id}`, {\r\n    // fetch('/api/reports/kpi?'+ `employee=${id}`, {\r\n\r\n    headers: {\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    method: 'GET'\r\n    })\r\n    .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then(r=>{\r\n            this.reports_employee = r.data;\r\n            this.loaderReport = false\r\n    })\r\n}\r\n    else{\r\n        console.log('NOT OK')\r\n    }\r\n})    \r\n },\r\nOpenChangeReport(id) {\r\n    this.loaderReport = true\r\n    api.getReportById(id)\r\n    .then(response => {\r\n        this.showReportModal = true\r\n        this.loaderReport = false\r\n        this.OnceReport = response.data\r\n    })\r\n    \r\n},\r\n \r\ncloseChangeReport(){\r\n    this.showReportModal = false\r\n},\r\n\r\n Send(){\r\n    event.preventDefault()\r\n    const pretoken = JSON.parse(localStorage.getItem(\"vuex\"))\r\n    const token = pretoken.auth.user.token\r\n    this.loaderReport = true\r\n    // document.getElementById('loading-page-lk').style.display = 'block'\r\n   let admin = document.getElementById('admin').value.split(' ')[0] \r\n   let staff = document.getElementById('staff').value.split(' ')[0] \r\n   fetch('http://10.1.5.65/api/reports/kpi/create/', {\r\n    // fetch('/api/reports/kpi/create/', {\r\n\r\n    method: 'POST',\r\n    headers: {\r\n        'Content-Type': 'application/json;charset=utf-8',\r\n        'Authorization': `Basic ${token}` \r\n    },\r\n    body: JSON.stringify({\r\n    \"employee\": staff,\r\n    \"manager\": admin,\r\n    \"a1\": this.answer1,\r\n    \"a2\": this.answer2,\r\n    \"a3\": this.answer3,\r\n    \"a4\": this.answer4,\r\n    \"a5\": this.answer5,\r\n    \"a6\": this.answer6\r\n })\r\n})\r\n  .then((response) => {\r\n    if (response.ok){\r\n        return response.json().then((data)=>{\r\n            this.loaderReport = false\r\n\r\n            document.getElementById('notifications').style.display = 'block';\r\n            setTimeout(this.Not, 1500);\r\n            document.getElementById(\"Anketa\").reset();\r\n        })\r\n    }\r\n    else{\r\n        document.getElementById('loading-page-lk').style.display = 'none';\r\n        document.getElementById('notifications-2').style.display = 'block';\r\n        setInterval(this.Not2, 1500)\r\n        console.log(response)\r\n\r\n    }\r\n})\r\n },\r\nDeleteReport(id){\r\n    this.loaderReport = true\r\n    api.deleteReport(id)\r\n    .then((response) => {\r\n        window.location.reload()\r\n        this.loaderReport = false\r\n    });\r\n }\r\n}\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n\r\n#loading-page-lk {\r\n  width: 100vw;\r\n  height: 100vh;\r\n  background: rgb(17, 17, 17, 0.1);\r\n  display: flex;\r\n  position: fixed;\r\n  top: 0;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  z-index: 9999999999999;\r\n}\r\n#loading-page-lk svg {\r\n  width: 100px;\r\n  height: 100px;\r\n  margin: 20px;\r\n  display: inline-block;\r\n  position: relative;\r\n  left: 50%;\r\n  transform: translate(-50%,0);\r\n  margin-top: 15%;\r\n\r\n}\r\n\r\n.form-btn{\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%,0);\r\n    margin-bottom: 2%;\r\n    margin-top: 3%;\r\n    height: 80px;\r\n    font-size: 22px;\r\n}\r\n#block-answer{\r\n    border-radius: 2px;\r\nbackground: #ffffff;\r\nbox-shadow:  10px 10px 30px #d0d0d0,\r\n             -10px -10px 30px #ffffff;\r\n             width: 90%;\r\n             position: relative;\r\n             left: 50%;\r\n             transform: translate(-50%,0);\r\n             margin-top: 2%;\r\n             padding: 3% 2%;\r\n         \r\n}\r\n.staffs {\r\n    margin-left: 25%;\r\n}\r\n.borough {\r\n    font-size: 17px;\r\n}\r\n.form-btn {\r\n    width: 90%;\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%,0);\r\n    margin-bottom: 2%;\r\n    margin-top: 3%;\r\n    height: 80px;\r\n    font-size: 22px;\r\n}\r\n#admin, #staff {\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%, 0);\r\n}\r\n.answer {\r\n    text-align: left;\r\n    padding-top: 5%;\r\n    font-size: 18px;\r\n    font-weight: 600;\r\n}\r\n .lk h2{\r\n    text-align: center;\r\n    padding-top: 2%;\r\n}\r\n.form {\r\n    width: 70%;\r\n    border: 1px solid black;\r\n}\r\n.select-form {\r\n    width: 50%;\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%,0);\r\n    margin-top: 2%;\r\n}\r\n.description-form {\r\n    text-align: center;\r\n}\r\n.block-answer h2{\r\n    text-align: center;\r\n}\r\n.tablesRep {\r\n    width: 100%;\r\n}\r\n.tablesRep2{\r\n    width: 100%;\r\n}\r\n.tableRep {\r\n    position: relative;\r\n     left: 50%;\r\n      transform: translate(-50%,0);\r\n       font-size: 17px;\r\n        width: 100%; \r\n}\r\n.phone {\r\n    display: none;\r\n}\r\n@media screen and (max-width: 550px){\r\n    .table {\r\n        width: 90% !important;\r\n        overflow-x: auto;\r\n    }\r\n .Action{\r\n        width: 90% !important;\r\n    }\r\n\r\n}\r\n</style>\r\n\r\n    "]},"metadata":{},"sourceType":"module"}