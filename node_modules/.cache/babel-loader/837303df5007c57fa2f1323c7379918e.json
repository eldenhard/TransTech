{"ast":null,"code":"import { mapState } from 'vuex';\nimport api from '@/api/staff';\nimport FilterStaff from '@/components/filter/FilterStaff.vue';\nimport Notifications from '@/components/notifications/Notifications.vue';\nimport { getGroupName } from '@/helpers/getGroupName';\nexport default {\n  name: 'StaffTable',\n  components: {\n    FilterStaff,\n    Notifications\n  },\n  computed: { ...mapState({\n      user: state => state.auth.user,\n      uid: state => state.auth.uid,\n      allGroups: state => state.auth.groups\n    })\n  },\n\n  data() {\n    return {\n      all_staff: '',\n      loaderStaff: false,\n      current_user_staff: '',\n      wrapper_staff: false,\n      staff_change: false,\n      add_staff: false,\n      photo: '',\n      first_name: '',\n      second_name: '',\n      last_name: '',\n      middle_name: '',\n      post: '',\n      email: '',\n      groups: '',\n      phone_corp: '',\n      phone_personal: '',\n      inner_number: '',\n      schedule: '',\n      manager: '',\n      filter_staff: null,\n      addUserGroups: '',\n      allManagerStaff: '',\n      // Уведомления\n      showNotify: false,\n      notifyHead: '',\n      notifyMessage: '',\n      notifyClass: ''\n    };\n  },\n\n  mounted() {\n    this.loaderStaff = true;\n    api.getAllManager().then(response => {\n      this.loaderStaff = false;\n      this.allManagerStaff = response.data.data;\n    }).catch(err => {\n      this.loaderStaff = false;\n      console.log(err);\n    }); // api.staffGlobal()\n    // .then((response) => {\n    //     this.staffGlobal = response.data\n    // })\n  },\n\n  methods: {\n    getGroupName(id) {\n      const group = getGroupName(this.allGroups, id);\n      return group[0]?.name;\n    },\n\n    updateFiltersStaff(filter_staff) {\n      this.filter_staff = filter_staff;\n    },\n\n    allStaff() {\n      this.loaderStaff = true;\n      api.getAllStaff(this.filter_staff).then(response => {\n        this.all_staff = response.data.data;\n        this.loaderStaff = false;\n        this.filter_staff.groups = Array[0];\n        this.filter_staff.search = \"\";\n      }).catch(err => {\n        console.log(err);\n        this.loaderStaff = false;\n      });\n    },\n\n    closeStaffModalDelete() {\n      this.wrapper_staff = false;\n    },\n\n    closeStaffModalChange() {\n      this.staff_change = false;\n    },\n\n    closeAddUser() {\n      this.add_staff = false;\n    },\n\n    // получение пользователя подлежащего удалению\n    getCurrentUser(id) {\n      this.loaderStaff = true;\n      this.wrapper_staff = true;\n      api.currentUser(id).then(response => {\n        this.loaderStaff = false;\n        this.current_user_staff = response.data;\n      });\n    },\n\n    // Удаление текущего пользователя\n    deleteCurrentUser(id) {\n      this.loaderStaff = true;\n      api.deleteUser(id).then(response => {\n        this.wrapper_staff = false;\n        this.showNotify = true;\n        this.notifyHead = 'Успешно';\n        this.notifyMessage = 'Пользователь удален';\n        this.notifyClass = 'wrapper-success';\n        this.loaderStaff = false;\n        setTimeout(this.closeNotification, 1500);\n        this.allStaff();\n      });\n    },\n\n    // Открыть страницу редактирования\n    openChangePage(id) {\n      this.loaderStaff = true;\n      this.staff_change = true;\n      api.currentUser(id).then(response => {\n        this.loaderStaff = false;\n        this.current_user_staff = response.data;\n\n        if (this.current_user_staff.groups[0]) {\n          this.current_user_staff.groups[0] + '';\n        }\n      });\n    },\n\n    // Подтвердить редактирование\n    changeStaff(id) {\n      this.loaderStaff = true;\n      this.staff_change = true;\n      let formData = new FormData();\n      formData.append('photo', this.photo);\n      formData.append(\"last_name\", this.current_user_staff.last_name);\n      formData.append(\"first_name\", this.current_user_staff.first_name_change);\n      formData.append(\"middle_name\", this.current_user_staff.middle_name_change);\n      formData.append(\"post\", this.current_user_staff.post_change);\n      formData.append(\"email\", this.email_change);\n      formData.append(\"groups\", this.current_user_staff.groups_change);\n      formData.append(\"phone_corp\", this.current_user_staff.phone_corp_change);\n      formData.append(\"phone_personal\", this.current_user_staff.phone_personal_change);\n      formData.append(\"inner_number\", this.current_user_staff.inner_number_change);\n      formData.append(\"schedule\", this.current_user_staff.schedule_change);\n      formData.append(\"manager\", this.current_user_staff.manager_change);\n      api.changeUserData(id, formData).then(response => {\n        this.notifyHead = 'Успешно';\n        this.notifyMessage = 'Пользователь изменен';\n        this.notifyClass = 'wrapper-success';\n        this.showNotify = true;\n        setTimeout(this.closeNotification, 1500);\n        this.allStaff();\n        this.loaderStaff = false;\n        this.staff_change = false;\n      });\n    },\n\n    closeNotification() {\n      this.showNotify = false;\n    },\n\n    onFileSelected(event) {\n      this.photo = this.$refs.photo.files[0];\n      console.log(event);\n    },\n\n    // ОТКРЫТЬ ОКНО ДОБАВЛЕНИЯ ПОЛЬЗОВАТЕЛЯ\n    addStaff() {\n      this.add_staff = true;\n    },\n\n    // ДОБАВЛЕНИЕ ПОЛЬЗОВАТЕЛЯ\n    addUser() {\n      event.preventDefault();\n      this.loaderStaff = true;\n      let formData = new FormData();\n      formData.append('photo', this.photo);\n      formData.append(\"email\", this.email);\n      formData.append(\"groups\", [this.groups]);\n      formData.append(\"manager\", this.manager);\n      formData.append(\"first_name\", this.first_name);\n      formData.append(\"last_name\", this.last_name);\n      formData.append(\"middle_name\", this.middle_name);\n      formData.append(\"post\", this.post);\n      formData.append(\"phone_corp\", this.phone_corp);\n      formData.append(\"phone_personal\", this.phone_personal);\n      formData.append(\"inner_number\", this.inner_number);\n      formData.append(\"schedule\", this.schedule);\n      api.createStuff(formData).then(response => {\n        this.notifyHead = 'Успешно';\n        this.notifyMessage = 'Пользователь добавлен';\n        this.notifyClass = 'wrapper-success';\n        this.showNotify = true;\n        setTimeout(this.closeNotification, 1500);\n        this.allStaff();\n        this.loaderStaff = false;\n        this.add_staff = false;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAsRA;AACA;AACA;AACA;AACA;AACA;EACAA,kBADA;EAEAC;IAAAC;IAAAC;EAAA,CAFA;EAGAC,YACA;MACAC,8BADA;MAEAC,4BAFA;MAGAC;IAHA;EADA,CAHA;;EAUAC;IACA;MACAC,aADA;MAEAC,kBAFA;MAGAC,sBAHA;MAIAC,oBAJA;MAMAC,mBANA;MAOAC,gBAPA;MASAC,SATA;MAUAC,cAVA;MAWAC,eAXA;MAYAC,aAZA;MAaAC,eAbA;MAcAC,QAdA;MAeAC,SAfA;MAgBAC,UAhBA;MAiBAC,cAjBA;MAkBAC,kBAlBA;MAmBAC,gBAnBA;MAoBAC,YApBA;MAqBAC,WArBA;MAuBAC,kBAvBA;MAyBAC,iBAzBA;MA2BAC,mBA3BA;MA6BA;MACAC,iBA9BA;MA+BAC,cA/BA;MAgCAC,iBAhCA;MAiCAC;IAjCA;EAsCA,CAjDA;;EAkDAC;IACA;IAEAC,oBACAC,IADA,CACAC;MACA;MACA;IACA,CAJA,EAIAC,KAJA,CAIAC;MACA;MACAC;IACA,CAPA,EAHA,CAWA;IACA;IACA;IACA;EAGA,CAnEA;;EAoEAC;IACAC;MACA;MACA;IACA,CAJA;;IAKAC;MACA;IACA,CAPA;;IAQAC;MACA;MACAT,mCACAC,IADA,CACAC;QACA;QACA;QACA;QACA;MAEA,CAPA,EAOAC,KAPA,CAOAC;QACAC;QACA;MACA,CAVA;IAWA,CArBA;;IAsBAK;MACA;IACA,CAxBA;;IAyBAC;MACA;IACA,CA3BA;;IA4BAC;MACA;IACA,CA9BA;;IA+BA;IACAC;MACA;MACA;MACAb,oBACAC,IADA,CACAC;QACA;QACA;MAEA,CALA;IAMA,CAzCA;;IA0CA;IACAY;MACA;MACAd,mBACAC,IADA,CACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACAa;QACA;MACA,CAVA;IAWA,CAxDA;;IAyDA;IACAC;MACA;MACA;MACAhB,oBACAC,IADA,CACAC;QACA;QACA;;QACA;UACA;QACA;MAEA,CARA;IASA,CAtEA;;IAuEA;IACAe;MACA;MACA;MAEA;MACAC;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MAEAlB,iCACAC,IADA,CACAC;QACA;QACA;QACA;QACA;QACAa;QACA;QACA;QACA;MACA,CAVA;IAWA,CArGA;;IAsGAI;MACA;IACA,CAxGA;;IA4GAC;MACA;MACAf;IACA,CA/GA;;IAgHA;IACAgB;MACA;IACA,CAnHA;;IAoHA;IACAC;MACAC;MACA;MAEA;MACAL;MACAA;MACAA;MACAA;MAEAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MAGAlB,0BACAC,IADA,CACAC;QACA;QACA;QACA;QACA;QACAa;QACA;QACA;QACA;MACA,CAVA;IAaA;;EAtJA;AApEA","names":["name","components","FilterStaff","Notifications","computed","user","uid","allGroups","data","all_staff","loaderStaff","current_user_staff","wrapper_staff","staff_change","add_staff","photo","first_name","second_name","last_name","middle_name","post","email","groups","phone_corp","phone_personal","inner_number","schedule","manager","filter_staff","addUserGroups","allManagerStaff","showNotify","notifyHead","notifyMessage","notifyClass","mounted","api","then","response","catch","err","console","methods","getGroupName","updateFiltersStaff","allStaff","closeStaffModalDelete","closeStaffModalChange","closeAddUser","getCurrentUser","deleteCurrentUser","setTimeout","openChangePage","changeStaff","formData","closeNotification","onFileSelected","addStaff","addUser","event"],"sourceRoot":"src/components/Table","sources":["StaffTable.vue"],"sourcesContent":["<template>\r\n    <div>\r\n<FilterStaff  @updateFiltersStaff=\"updateFiltersStaff\"></FilterStaff>\r\n\r\n<button class=\"Accept staffButton\" @click=\"allStaff()\">Запросить всех сотрудников</button>\r\n    <br><br>\r\n    <br><br>\r\n<button class=\"Cancel staffButton\" style=\"width: 50%; border-top-left-radius: 10px; border-top-right-radius: 10px;\" @click=\"addStaff() \">Добавить сотрудника</button>\r\n\r\n<div style=\" width: 95% !important; overflow: auto; position: relative; left: 50%; transform: translate(-50%,0);\">\r\n    <table class=\"staff_table table\">\r\n        <thead class=\"head-staff\"> \r\n        <th>Фото</th>\r\n        <th>Фамилия</th>\r\n        <th>Имя</th>\r\n        <th>Отчество</th>\r\n        <th>Должность</th>\r\n        <th>Почта</th>\r\n        <th>Отдел</th>\r\n        <th>Телефон корпоративный</th>\r\n        <th>Телефон личный</th>\r\n        <th>Внутренний номер</th>\r\n        <th>Время работы</th>\r\n        <th>Начальник</th>\r\n        <th>Редактировать</th>\r\n        <th>Удалить</th>\r\n        </thead>\r\n\r\n        <tbody style=\"max-width: 90% !important;\">\r\n            <tr v-for=\"staff in all_staff\" :key=\"staff.id\">\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\">\r\n                    <a download target=\"_blank\" :href=\"staff.photo\" v-if=\"staff.photo\">\r\n                        <img src=\"@/assets/user.png\" alt=\"\" width=\"35px !important\">\r\n                    </a>\r\n                </td>\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\">{{staff.last_name}}</td>\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\">{{staff.first_name}}</td>\r\n                <td style=\"padding: 0 !important;vertical-align: middle; align-items: center; justify-content: center; \">{{staff.middle_name}}</td>\r\n                <td style=\"padding: 0 !important;vertical-align: middle; align-items: center; justify-content: center; \">{{staff.post}}</td>\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\">{{staff.email}}</td>\r\n                <td style=\"padding: 0 !important;vertical-align: middle; align-items: center; justify-content: center; \">\r\n                    {{getGroupName(staff.groups[0])}}\r\n            <!-- <span v-if=\"staff.groups[0] ==  40\">Отдел кадров</span> -->\r\n                    </td>\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-if=\"staff.manager != null\">{{staff.phone_corp}}</td>\r\n                    <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-else>—</td>\r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-if=\"staff.manager != null\">{{staff.phone_personal}}</td>\r\n                    <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-else>—</td>\r\n                <td style=\"padding: 0 !important;vertical-align: middle; align-items: center; justify-content: center; \" v-if=\"staff.manager != null\">{{staff.inner_number}}</td>\r\n                    <td v-else>—</td>\r\n                <td style=\"padding: 0 !important;vertical-align: middle; align-items: center; justify-content: center; \" v-if=\"staff.manager != null\">{{staff.schedule}}</td>\r\n                    <td v-else>—</td>  \r\n                <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-if=\"staff.manager != null\">{{staff.manager}}</td>\r\n                    <td style=\"padding: 0 !important; vertical-align: middle; align-items: center; justify-content: center;\" v-else>—</td>  \r\n                <td><button class=\"Request\" @click=\"openChangePage(staff.id)\">Редактировать</button></td>\r\n                <td><button class=\"Delete\" @click=\"getCurrentUser(staff.id)\">Удалить</button></td>\r\n            </tr>\r\n        </tbody>\r\n\r\n    </table>\r\n</div>\r\n\r\n<section  style=\"display:block\" id=\"loaderStaff\" v-if=\"loaderStaff\">\r\n\r\n<svg version=\"1.1\" id=\"L7\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\r\n  viewBox=\"0 0 100 100\" enable-background=\"new 0 0 100 100\" xml:space=\"preserve\">\r\n <path fill=\"#C04945\" d=\"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3\r\n  c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#ECECEC\" d=\"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7\r\n  c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"1s\" \r\n         from=\"0 50 50\"\r\n         to=\"-360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n <path fill=\"#3D70A8\" d=\"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5\r\n  L82,35.7z\">\r\n      <animateTransform \r\n         attributeName=\"transform\" \r\n         attributeType=\"XML\" \r\n         type=\"rotate\"\r\n         dur=\"2s\" \r\n         from=\"0 50 50\"\r\n         to=\"360 50 50\" \r\n         repeatCount=\"indefinite\" />\r\n  </path>\r\n</svg>\r\n  \r\n \r\n</section> \r\n\r\n<div class=\"wrapper_staff\" style=\"display: block\" v-if=\"wrapper_staff\">\r\n    <div class=\"modal_staff\">\r\n        <h2>Удаление сотрудника</h2>\r\n        <p>Вы уверены, что хотите <span style=\"color: #C04945; font-weight: bold\">удалить</span></p>\r\n            <div style=\" width: 98% !important; overflow: auto; position: relative; left: 50%; transform: translate(-50%,0);\">\r\n                <table class=\"staff_table table\">\r\n                    <tr>\r\n                        <th>Фамилия</th>\r\n                        <th>Имя</th>\r\n                        <th>Отчество</th>\r\n                        <th>Должность</th>\r\n                        <!-- <th>Отдел</th> -->\r\n                    </tr>\r\n                    <tr>\r\n                        <td>{{current_user_staff.last_name}}</td>\r\n                        <td>{{current_user_staff.first_name}}</td>\r\n                        <td>{{current_user_staff.middle_name}}</td>\r\n                        <td>{{current_user_staff.post}}</td>\r\n                        <!-- <td>{{current_user_staff.groups[0]}}</td> -->\r\n                    </tr>\r\n                </table>   \r\n            </div>  \r\n            <div class=\"btn-staff-group container\">\r\n                <button class=\"Cancel\" style=\"width: 30%\" @click=\"closeStaffModalDelete()\">Отмена</button>\r\n                <button class=\"Accept\" style=\"width: 30%\" @click=\"deleteCurrentUser(current_user_staff.id)\">Подтвердить</button>\r\n            </div>  \r\n    </div>\r\n</div>\r\n\r\n<div class=\"wrapper_staff\" style=\"display: block\" v-if=\"staff_change\">\r\n    <div class=\"modal_staff\" style=\"width: 90%\">\r\n        <h2>Редактирование</h2>\r\n        <p>Кликните на поле которое необходимо редактировать</p>\r\n\r\n             <div style=\" width: 98% !important; overflow: auto; position: relative; left: 50%; transform: translate(-50%,0);\">\r\n                <table class=\"staff_table table\">\r\n                    <tr>\r\n                        <th>Фото</th>\r\n                        <th>Фамилия</th>\r\n                        <th>Имя</th>\r\n                        <th>Отчество</th>\r\n                        <th>Должность</th>\r\n                        <th>Почта</th>\r\n                     \r\n            \r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\" width: 5% !important;\">\r\n                            <input type=\"file\" @change=\"onFileSelected\" name=\"photo\"  ref=\"photo\">\r\n                        </td>\r\n                        <td><input type=\"text\" v-model=\"current_user_staff.last_name\"></td>\r\n                        <td><input type=\"text\" v-model=\"current_user_staff.first_name\"></td>\r\n                        <td><input type=\"text\" v-model=\"current_user_staff.middle_name\"></td>\r\n                        <td><input type=\"text\" v-model=\"current_user_staff.post\"></td>\r\n                        <td><input type=\"text\" v-model=\"current_user_staff.email\"></td>\r\n                \r\n                    </tr>\r\n                </table>   \r\n\r\n                <table  class=\"staff_table table\">\r\n                    <tr>   \r\n                        <th>Отдел</th>\r\n                        <th>Телефон корпоративный</th>\r\n                        <th>Телефон личный</th>\r\n                        <th>Внутренний номер</th>\r\n                        <th>Время работы</th>\r\n                        <th>Начальник</th>\r\n                    </tr>\r\n\r\n                    <tr>\r\n                        <td>\r\n                            <select v-model=\"current_user_staff.groups[0]\" style=\"height:40px; margin-top: 10px; cursor: pointer;\">\r\n                                <option \r\n                                v-for=\"userGroup in allGroups\"\r\n                                :key=\"userGroup.id\"\r\n                                :value=\"userGroup.id\">{{userGroup.name}}</option>\r\n                            </select>\r\n                        </td>\r\n                        <td><input type=\"text\"  v-model=\"current_user_staff.phone_corp\"></td>\r\n                        <td><input type=\"text\"  v-model=\"current_user_staff.phone_personal\"></td>\r\n                        <td><input type=\"text\"  v-model=\"current_user_staff.inner_number\"></td>\r\n                        <td><input type=\"text\"  v-model=\"current_user_staff.schedule\"></td>\r\n                        <td><input type=\"text\"  v-model=\"current_user_staff.manager\"></td>\r\n                    </tr>\r\n                </table>\r\n            </div>  \r\n            <div class=\"btn-staff-group container\">\r\n                <button class=\"Cancel\" style=\"width: 30%\" @click=\"closeStaffModalChange()\">Отмена</button>\r\n                <button class=\"Accept\" style=\"width: 30%\" @click=\"changeStaff(current_user_staff.id)\">Подтвердить</button>\r\n            </div>  \r\n    </div>\r\n</div>\r\n\r\n<div class=\"wrapper_staff\" style=\"display: block;\" v-if=\"add_staff\">\r\n    <div class=\"modal_staff\" style=\"width: 95%;\">\r\n        <h2>Добавление сотрудника</h2>\r\n            <div style=\" width: 98% !important; overflow: auto; position: relative; left: 50%; transform: translate(-50%,0);\">\r\n\r\n            <!-- <form enctype=\"multipart/form-data\"> -->\r\n                <table class=\"staff_table table\">\r\n                    <tr>\r\n                        <th  style=\"background: #EBEBEB; width: 5% !important;\">Фото</th>\r\n                        <th  style=\"background: #EBEBEB; width: 10% !important;\">Фамилия</th>\r\n                        <th  style=\"background: #EBEBEB; width: 10% !important;\">Имя</th>\r\n                        <th  style=\"background: #EBEBEB; width: 10% !important;\">Отчество</th>\r\n                        <th  style=\"background: #EBEBEB; width: 10% !important;\">Должность</th>\r\n                        <th  style=\"background: #EBEBEB; width: 10% !important;\">Почта</th>\r\n                       \r\n                    </tr>\r\n                    <tr>\r\n                        <td style=\" width: 5% !important;\">\r\n                            \r\n                            <input type=\"file\" @change=\"onFileSelected\" name=\"photo\"  ref=\"photo\">\r\n                        \r\n                        </td>\r\n\r\n                        <td style=\" width: 10% !important;\"><input type=\"text\" v-model=\"last_name\" placeholder=\"Иванов\"></td>\r\n                        <td style=\" width: 10% !important;\"><input type=\"text\" v-model=\"first_name\" placeholder=\"Иван\"></td>\r\n                        <td style=\" width: 10% !important;\"><input type=\"text\" v-model=\"middle_name\" placeholder=\"Иванович\"></td>\r\n                        <td style=\" width: 10% !important;\"><input type=\"text\" v-model=\"post\" placeholder=\"Логист\"></td>\r\n                        <td style=\" width: 10% !important;\"><input type=\"text\" v-model=\"email\" placeholder=\"i.ivanov@tehtrans.com\"></td>\r\n                    </tr>\r\n          \r\n                </table>   \r\n                <br><br>\r\n                <table  class=\"staff_table table\"> \r\n                    <tr>\r\n                        <th  style=\"background: #EBEBEB\">Отдел</th>\r\n                        <th  style=\"background: #EBEBEB\">Телефон корпоративный</th>\r\n                        <th  style=\"background: #EBEBEB\">Телефон личный</th>\r\n                        <th  style=\"background: #EBEBEB\">Внутренний номер</th>\r\n                        <th  style=\"background: #EBEBEB\">Время работы</th>\r\n                        <th  style=\"background: #EBEBEB\" >Начальник</th>\r\n                    </tr>\r\n                    <tr>\r\n                        <td><select v-model=\"groups\" style=\"margin-top: 5%; height: 45px; cursor: pointer\">\r\n                            <option value=\"\">Выберите отдел</option>\r\n                            <option \r\n                                v-for=\"userGroup in allGroups\"\r\n                                :key=\"userGroup.id\"\r\n                                :value=\"userGroup.id\">{{userGroup.name}}</option>\r\n                        </select></td>\r\n                        <td><input type=\"text\" v-model=\"phone_corp\"  placeholder=\"89999999999\"></td>\r\n                        <td><input type=\"text\" v-model=\"phone_personal\"  placeholder=\"89999999999\"></td>\r\n                        <td><input type=\"text\" v-model=\"inner_number\"  placeholder=\"007\"></td>\r\n                        <td><input type=\"text\" v-model=\"schedule\"  placeholder=\"9:00 - 18:00\"></td>\r\n                        <td>\r\n                            <select type=\"text\" v-model=\"manager\"  style=\"margin-top: 5%; height: 45px; cursor: pointer\">\r\n                            <option value=\"\">Выберите начальника</option>\r\n                            <option\r\n                                v-for=\"manager in allManagerStaff\"\r\n                                :key=\"manager.id\"\r\n                                :value=\"manager.id\">{{manager.first_name}} {{manager.middle_name}} {{manager.last_name}}</option>\r\n                            </select>\r\n                        </td>\r\n\r\n                    </tr>\r\n                </table>\r\n                <div class=\"btn-staff-group container\">\r\n                <button class=\"Cancel\" style=\"width: 30%\" @click=\"closeAddUser()\">Отмена</button>\r\n                <button  class=\"Accept\" style=\"width: 30%\" @click=\"addUser()\">Добавить</button>\r\n            </div>  \r\n        <!-- </form> -->\r\n    </div>  \r\n\r\n    </div>\r\n</div>\r\n\r\n<Notifications :show=\"showNotify\" :header=\"notifyHead\" :message=\"notifyMessage\" :block-class=\"notifyClass\" id=\"notif\"/>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport api from '@/api/staff'\r\nimport FilterStaff from '@/components/filter/FilterStaff.vue'\r\nimport Notifications from '@/components/notifications/Notifications.vue'\r\nimport {getGroupName} from '@/helpers/getGroupName'\r\nexport default {\r\n    name: 'StaffTable',\r\n    components: {FilterStaff, Notifications},\r\n    computed: {\r\n        ...mapState({\r\n            user: state => state.auth.user,\r\n            uid: state => state.auth.uid,\r\n            allGroups: state => state.auth.groups\r\n        })\r\n    },\r\n    data(){\r\n        return {\r\n            all_staff: '',\r\n            loaderStaff: false,\r\n            current_user_staff: '',\r\n            wrapper_staff: false,\r\n           \r\n            staff_change: false,\r\n            add_staff: false,\r\n\r\n            photo: '',\r\n            first_name: '',\r\n            second_name: '',\r\n            last_name: '',\r\n            middle_name: '',\r\n            post: '',\r\n            email: '',\r\n            groups: '',\r\n            phone_corp: '',\r\n            phone_personal: '',\r\n            inner_number: '',\r\n            schedule: '',\r\n            manager: '',\r\n\r\n            filter_staff: null,\r\n\r\n            addUserGroups: '',\r\n\r\n            allManagerStaff: '',\r\n\r\n            // Уведомления\r\n            showNotify: false,\r\n            notifyHead: '',\r\n            notifyMessage: '',\r\n            notifyClass: '',\r\n\r\n           \r\n\r\n        }\r\n    },\r\n    mounted() {\r\n        this.loaderStaff = true\r\n      \r\n        api.getAllManager()\r\n        .then((response) => {\r\n            this.loaderStaff = false\r\n            this.allManagerStaff = response.data.data\r\n        }).catch(err => {\r\n            this.loaderStaff = false\r\n            console.log(err)\r\n        })\r\n        // api.staffGlobal()\r\n        // .then((response) => {\r\n        //     this.staffGlobal = response.data\r\n        // })\r\n        \r\n\r\n    },\r\n    methods: {\r\n        getGroupName(id){\r\n            const group =  getGroupName(this.allGroups, id)\r\n            return group[0]?.name\r\n        },\r\n        updateFiltersStaff(filter_staff){\r\n            this.filter_staff = filter_staff\r\n        },\r\n        allStaff(){\r\n            this.loaderStaff = true\r\n            api.getAllStaff(this.filter_staff)\r\n            .then((response) => {\r\n                this.all_staff = response.data.data\r\n                this.loaderStaff = false\r\n                this.filter_staff.groups = Array[0]\r\n                this.filter_staff.search = \"\"\r\n\r\n            }).catch(err => {\r\n                console.log(err)\r\n                this.loaderStaff = false\r\n            })\r\n        },\r\n        closeStaffModalDelete() {\r\n            this.wrapper_staff = false\r\n        },\r\n        closeStaffModalChange(){\r\n            this.staff_change = false\r\n        },\r\n        closeAddUser(){\r\n            this.add_staff = false\r\n        },\r\n        // получение пользователя подлежащего удалению\r\n        getCurrentUser(id){\r\n          this.loaderStaff = true\r\n          this.wrapper_staff = true\r\n          api.currentUser(id)\r\n          .then((response) => {\r\n             this.loaderStaff = false\r\n             this.current_user_staff = response.data\r\n            \r\n          })\r\n        },\r\n        // Удаление текущего пользователя\r\n        deleteCurrentUser(id){\r\n            this.loaderStaff = true\r\n            api.deleteUser(id)\r\n            .then((response) => {\r\n                this.wrapper_staff = false\r\n                this.showNotify = true\r\n                this.notifyHead = 'Успешно'\r\n                this.notifyMessage = 'Пользователь удален'\r\n                this.notifyClass = 'wrapper-success'\r\n                this.loaderStaff = false\r\n                setTimeout(this.closeNotification, 1500)\r\n                this.allStaff()\r\n            })\r\n        },\r\n        // Открыть страницу редактирования\r\n        openChangePage(id){\r\n           this.loaderStaff = true\r\n           this.staff_change = true\r\n            api.currentUser(id)\r\n                .then((response) => {\r\n                this.loaderStaff = false\r\n                this.current_user_staff = response.data\r\n                if(this.current_user_staff.groups[0]){\r\n                    this.current_user_staff.groups[0] + ''\r\n                }\r\n\r\n                })\r\n        },\r\n        // Подтвердить редактирование\r\n        changeStaff(id){\r\n            this.loaderStaff = true\r\n            this.staff_change = true\r\n\r\n            let formData = new FormData();\r\n            formData.append('photo', this.photo)\r\n            formData.append(\"last_name\",this.current_user_staff.last_name)\r\n            formData.append(\"first_name\", this.current_user_staff.first_name_change)\r\n            formData.append(\"middle_name\", this.current_user_staff.middle_name_change)\r\n             formData.append(\"post\", this.current_user_staff.post_change)\r\n             formData.append(\"email\", this.email_change)\r\n             formData.append(\"groups\", this.current_user_staff.groups_change)\r\n             formData.append(\"phone_corp\", this.current_user_staff.phone_corp_change)\r\n             formData.append(\"phone_personal\", this.current_user_staff.phone_personal_change)\r\n             formData.append(\"inner_number\", this.current_user_staff.inner_number_change)\r\n             formData.append(\"schedule\", this.current_user_staff.schedule_change)\r\n             formData.append(\"manager\", this.current_user_staff.manager_change)\r\n\r\n            api.changeUserData(id, formData)\r\n                .then((response) => {\r\n                    this.notifyHead = 'Успешно'\r\n                    this.notifyMessage = 'Пользователь изменен'\r\n                    this.notifyClass = 'wrapper-success'\r\n                    this.showNotify = true\r\n                    setTimeout(this.closeNotification, 1500)\r\n                    this.allStaff()\r\n                    this.loaderStaff = false\r\n                    this.staff_change = false\r\n                })\r\n        },\r\n        closeNotification(){\r\n            this.showNotify = false\r\n        },\r\n\r\n\r\n\r\n        onFileSelected(event){\r\n            this.photo = this.$refs.photo.files[0];\r\n            console.log(event)\r\n        },\r\n        // ОТКРЫТЬ ОКНО ДОБАВЛЕНИЯ ПОЛЬЗОВАТЕЛЯ\r\n        addStaff(){\r\n            this.add_staff = true\r\n        },\r\n        // ДОБАВЛЕНИЕ ПОЛЬЗОВАТЕЛЯ\r\n        addUser(){\r\n            event.preventDefault()\r\n            this.loaderStaff = true\r\n            \r\n            let formData = new FormData();\r\n            formData.append('photo', this.photo)\r\n            formData.append(\"email\", this.email)\r\n            formData.append(\"groups\", [this.groups])\r\n            formData.append(\"manager\", this.manager)\r\n\r\n            formData.append(\"first_name\", this.first_name)\r\n            formData.append(\"last_name\", this.last_name)\r\n            formData.append(\"middle_name\", this.middle_name)\r\n            formData.append(\"post\", this.post)\r\n            formData.append(\"phone_corp\", this.phone_corp)\r\n            formData.append(\"phone_personal\", this.phone_personal)\r\n            formData.append(\"inner_number\", this.inner_number)\r\n            formData.append(\"schedule\", this.schedule)\r\n\r\n        \r\n        api.createStuff(formData)\r\n        .then((response) => {\r\n            this.notifyHead = 'Успешно'\r\n            this.notifyMessage = 'Пользователь добавлен'\r\n            this.notifyClass = 'wrapper-success'\r\n            this.showNotify = true\r\n            setTimeout(this.closeNotification, 1500)\r\n            this.allStaff()\r\n            this.loaderStaff = false\r\n            this.add_staff = false\r\n        })\r\n            \r\n    \r\n                }\r\n     \r\n    }\r\n}\r\n</script>\r\n\r\n\r\n<style>\r\nth {\r\n    background: #EBEBEB !important;\r\n}\r\n.staff_table {\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%,0);\r\n\r\n    text-align: center !important;\r\n    border-bottom: solid 3px #c04945 !important;\r\n    /* padding: 8px !important; */\r\n    /* font-size: small; */\r\n    background-color: #eee !important;\r\n    color: #000000 !important;\r\n    overflow-x: auto;\r\n    padding: 0 !important;\r\n}\r\n\r\n.staffButton {\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%, 0);\r\n    width: 95% !important;\r\n}\r\n.staff_table>td{\r\n    display: flex;\r\n    align-items: center;\r\n  justify-content: center;\r\n}\r\ntr:hover {\r\n  background-color: #eee !important;\r\n  outline: solid 1px #c04945  !important;\r\n  cursor: pointer;\r\n}\r\n.head-staff>th {\r\n    background: #ebebeb;\r\n    border: 1px solid grey;\r\n    align-items: center;\r\n  justify-content: center;\r\n  border-bottom: solid 3px #c04945 !important;\r\n}\r\n.wrapper_staff {\r\n    position: fixed;\r\n    top:0;\r\n    left: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    height: 100vh;\r\n    width: 100vw;\r\n    background: rgb(105, 105, 105, 0.7);\r\n    z-index: 1;\r\n}\r\n.modal_staff {\r\n    background: rgb(255, 255, 255);\r\n    position: fixed;\r\n    top: 10%;\r\n    position: relative;\r\n    left: 50%;\r\n    transform: translate(-50%,0);\r\n    width: 50%;\r\n    z-index: 2;\r\n    height: 80%;\r\n}\r\n.modal_staff>p {\r\n   text-align: center;\r\n}\r\n\r\n#loaderStaff{\r\n    width: 100vw;\r\n    height: 100vh;\r\n    background: rgb(17, 17, 17, 0.1);\r\n    display: flex;\r\n    position: fixed !important;\r\n    top: 0 !important;\r\n    bottom: 0 !important;\r\n    left: 0 !important;\r\n    right: 0 !important;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    z-index: 9999999999999;\r\n\r\n}\r\n#loaderStaff svg{\r\n    width: 120px;\r\n    height: 120px;\r\n    display: inline-block;\r\n    position: relative !important;\r\n    left: 50% !important;\r\n    transform: translate(-50%,0) !important;\r\n    margin-top: 15%;\r\n}\r\n.btn-staff-group {\r\n    display: flex;\r\n    justify-content: space-between;\r\n}\r\n/* td,th {\r\n    padding: 0 !important;\r\n    margin: 0 !important;\r\n} */\r\n</style>"]},"metadata":{},"sourceType":"module"}