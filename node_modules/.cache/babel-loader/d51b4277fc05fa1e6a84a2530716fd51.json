{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { Container } from \"./render/Container\";\nimport { Text } from \"./render/Text\";\nimport { HorizontalLayout } from \"./render/HorizontalLayout\";\nimport { VerticalLayout } from \"./render/VerticalLayout\";\nimport { GridLayout } from \"./render/GridLayout\";\nimport { Disposer } from \"./util/Disposer\";\nimport { ResizeSensor } from \"./util/ResizeSensor\";\nimport { InterfaceColors } from \"./util/InterfaceColors\";\nimport { Graphics } from \"./render/Graphics\";\nimport { Rectangle } from \"./render/Rectangle\";\nimport { Tooltip } from \"./render/Tooltip\";\nimport { NumberFormatter } from \"./util/NumberFormatter\";\nimport { DateFormatter } from \"./util/DateFormatter\";\nimport { DurationFormatter } from \"./util/DurationFormatter\";\nimport { Language } from \"./util/Language\";\nimport { EventDispatcher } from \"./util/EventDispatcher\";\nimport { DefaultTheme } from \"../themes/DefaultTheme\";\nimport { CanvasRenderer } from \"./render/backend/CanvasRenderer\";\nimport { p100, percent } from \"./util/Percent\";\nimport { color } from \"./util/Color\";\nimport { populateString } from \"./util/PopulateString\";\nimport { registry } from \"./Registry\";\nimport * as $order from \"./util/Order\";\nimport * as $array from \"./util/Array\";\nimport * as $object from \"./util/Object\";\nimport * as $utils from \"./util/Utils\";\nimport * as $type from \"./util/Type\";\nimport en from \"../../locales/en\";\n\nfunction rAF(fps, callback) {\n  if (fps == null) {\n    requestAnimationFrame(callback);\n  } else {\n    setTimeout(function () {\n      requestAnimationFrame(callback);\n    }, 1000 / fps);\n  }\n} // TODO implement Disposer\n\n/**\r\n * Root element of the chart.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/getting-started/#Root_element} for more info\r\n */\n\n\nvar Root =\n/** @class */\nfunction () {\n  function Root(id, settings, isReal) {\n    if (settings === void 0) {\n      settings = {};\n    }\n    /**\r\n     * A reference to original chart container (div element).\r\n     */\n\n\n    Object.defineProperty(this, \"dom\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_inner\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_isDirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_isDirtyParents\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_dirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_dirtyParents\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_dirtyBounds\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_dirtyPositions\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_ticker\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, \"_tickers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    /**\r\n     * Root's event dispatcher.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\r\n     */\n\n    Object.defineProperty(this, \"events\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new EventDispatcher()\n    });\n    /**\r\n     * @ignore\r\n     * @todo needs description\r\n     */\n\n    Object.defineProperty(this, \"animationTime\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, \"_animations\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"_renderer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_rootContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * Main content container.\r\n     */\n\n    Object.defineProperty(this, \"container\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * A [[Container]] used to display tooltips in.\r\n     */\n\n    Object.defineProperty(this, \"tooltipContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltip\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    }); // Locale-related\n\n    /**\r\n     * @ignore\r\n     */\n\n    Object.defineProperty(this, \"language\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: Language.new(this, {})\n    });\n    /**\r\n     * Locale used by the chart.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/}\r\n     */\n\n    Object.defineProperty(this, \"locale\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: en\n    }); // Date-time related\n\n    /**\r\n     * Use UTC when formatting date/time.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#UTC_and_time_zones} for more info\r\n     */\n\n    Object.defineProperty(this, \"utc\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    /**\r\n     * If set, will format date/time in specific time zone.\r\n     *\r\n     * The value should be named time zone, e.g.:\r\n     * `\"America/Vancouver\"`, `\"Australia/Sydney\"`, `\"UTC\"`.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Time_zone} for more info\r\n     * @since 5.1.0\r\n     */\n\n    Object.defineProperty(this, \"timezone\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * The maximum FPS that the Root will run at.\r\n     *\r\n     * If `undefined` it will run at the highest FPS.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Performance} for more info\r\n     */\n\n    Object.defineProperty(this, \"fps\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * Number formatter.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\r\n     */\n\n    Object.defineProperty(this, \"numberFormatter\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: NumberFormatter.new(this, {})\n    });\n    /**\r\n     * Date/time formatter.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\r\n     */\n\n    Object.defineProperty(this, \"dateFormatter\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: DateFormatter.new(this, {})\n    });\n    /**\r\n     * Duration formatter.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\r\n     */\n\n    Object.defineProperty(this, \"durationFormatter\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: DurationFormatter.new(this, {})\n    }); // Accessibility\n\n    /**\r\n     * Global tab index for using for the whole chart\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\r\n     */\n\n    Object.defineProperty(this, \"tabindex\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    }); //@todo maybe make this better\n\n    Object.defineProperty(this, \"_tabindexes\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"_focusElementDirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_focusElementContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_focusedSprite\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_isShift\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_keyboardDragPoint\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltipElementContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_readerAlertElement\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_logo\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltipDiv\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * Used for dynamically-created CSS and JavaScript with strict source policies.\r\n     */\n\n    Object.defineProperty(this, \"nonce\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * Special color set to be used for various controls.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/#Interface_colors} for more info\r\n     */\n\n    Object.defineProperty(this, \"interfaceColors\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * An instance of vertical layout object that can be used to set `layout` setting\r\n     * of a [[Container]].\r\n     *\r\n     * @default VerticalLayout.new()\r\n     */\n\n    Object.defineProperty(this, \"verticalLayout\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: VerticalLayout.new(this, {})\n    });\n    /**\r\n     * An instance of horizontal layout object that can be used to set `layout` setting\r\n     * of a [[Container]].\r\n     *\r\n     * @default HorizontalLayout.new()\r\n     */\n\n    Object.defineProperty(this, \"horizontalLayout\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: HorizontalLayout.new(this, {})\n    });\n    /**\r\n     * An instance of grid layout object that can be used to set `layout` setting\r\n     * of a [[Container]].\r\n     *\r\n     * @default VerticalLayout.new()\r\n     */\n\n    Object.defineProperty(this, \"gridLayout\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: GridLayout.new(this, {})\n    });\n    /**\r\n     * Indicates whether chart should resized automatically when parent container\r\n     * width and/or height changes.\r\n     *\r\n     * If disabled (`autoResize = false`) you can make the chart resize manually\r\n     * by calling root element's `resize()` method.\r\n     */\n\n    Object.defineProperty(this, \"autoResize\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: true\n    });\n    Object.defineProperty(this, \"_fontHash\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"\"\n    });\n    Object.defineProperty(this, \"_isDisposed\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_disposers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"_resizeSensorDisposer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltips\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"_htmlElementContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_htmlEnabledContainers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(this, \"tooltipRoot\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n\n    if (!isReal) {\n      throw new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n    }\n\n    if (settings.useSafeResolution == null) {\n      settings.useSafeResolution = true;\n    }\n\n    var resolution;\n\n    if (settings.useSafeResolution) {\n      resolution = $utils.getSafeResolution();\n    }\n\n    this._renderer = new CanvasRenderer(resolution);\n    var dom;\n\n    if (id instanceof HTMLElement) {\n      dom = id;\n    } else {\n      dom = document.getElementById(id);\n    }\n\n    $array.each(registry.rootElements, function (root) {\n      if (root.dom === dom) {\n        throw new Error(\"You cannot have multiple Roots on the same DOM node\");\n      }\n    });\n    this.interfaceColors = InterfaceColors.new(this, {});\n\n    if (dom === null) {\n      throw new Error(\"Could not find HTML element with id `\" + id + \"`\");\n    }\n\n    this.dom = dom;\n    var inner = document.createElement(\"div\");\n    inner.style.position = \"relative\";\n    inner.style.height = \"100%\";\n    dom.appendChild(inner);\n    var tooltipContainerBounds = settings.tooltipContainerBounds;\n\n    if (tooltipContainerBounds) {\n      var tooltipDiv = document.createElement(\"div\");\n      $utils.setInteractive(tooltipDiv, false);\n      var tooltipDivStyle = tooltipDiv.style;\n      tooltipDivStyle.position = \"absolute\";\n      tooltipDivStyle.top = -tooltipContainerBounds.top + \"px\";\n      tooltipDivStyle.left = -tooltipContainerBounds.left + \"px\";\n      tooltipDivStyle.width = \"calc(100% + \" + (tooltipContainerBounds.left + tooltipContainerBounds.right) + \"px)\";\n      tooltipDivStyle.height = \"calc(100% + \" + (tooltipContainerBounds.top + tooltipContainerBounds.bottom) + \"px)\";\n      tooltipDivStyle.zIndex = \"1\";\n      inner.appendChild(tooltipDiv);\n      this.tooltipRoot = new Root(tooltipDiv, {}, true);\n\n      this.tooltipRoot._init();\n\n      this.tooltipRoot.tooltipContainer.setAll({\n        x: tooltipContainerBounds.left,\n        y: tooltipContainerBounds.top\n      });\n    }\n\n    this._inner = inner;\n\n    this._updateComputedStyles();\n\n    registry.rootElements.push(this);\n  }\n\n  Object.defineProperty(Root, \"new\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (id, settings) {\n      var root = new Root(id, settings, true);\n\n      root._init();\n\n      return root;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"moveDOM\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (id) {\n      var dom;\n\n      if (id instanceof HTMLElement) {\n        dom = id;\n      } else {\n        dom = document.getElementById(id);\n      }\n\n      if (dom) {\n        while (this.dom.childNodes.length > 0) {\n          dom.appendChild(this.dom.childNodes[0]);\n        }\n\n        this.dom = dom;\n\n        this._initResizeSensor();\n\n        this.resize();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_handleLogo\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this._logo) {\n        var w = this.dom.offsetWidth;\n        var h = this.dom.offsetHeight;\n\n        if (w <= 150 || h <= 60) {\n          this._logo.hide();\n        } else {\n          this._logo.show();\n        }\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_showBranding\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (!this._logo) {\n        var logo = this.tooltipContainer.children.push(Container.new(this, {\n          interactive: true,\n          interactiveChildren: false,\n          position: \"absolute\",\n          setStateOnChildren: true,\n          paddingTop: 9,\n          paddingRight: 9,\n          paddingBottom: 9,\n          paddingLeft: 9,\n          scale: .6,\n          y: percent(100),\n          centerY: p100,\n          tooltipText: \"Created using amCharts 5\",\n          tooltipX: p100,\n          cursorOverStyle: \"pointer\",\n          background: Rectangle.new(this, {\n            fill: color(0x474758),\n            fillOpacity: 0,\n            tooltipY: 5\n          })\n        }));\n        var tooltipRoot = this.tooltipRoot;\n\n        if (!tooltipRoot) {\n          tooltipRoot = this;\n        }\n\n        var tooltip = Tooltip.new(tooltipRoot, {\n          pointerOrientation: \"horizontal\",\n          paddingTop: 4,\n          paddingRight: 7,\n          paddingBottom: 4,\n          paddingLeft: 7\n        });\n        tooltip.label.setAll({\n          fontSize: 12\n        });\n        tooltip.get(\"background\").setAll({\n          fill: this.interfaceColors.get(\"background\"),\n          stroke: this.interfaceColors.get(\"grid\"),\n          strokeOpacity: 0.3\n        });\n        logo.set(\"tooltip\", tooltip);\n        logo.events.on(\"click\", function () {\n          window.open(\"https://www.amcharts.com/\", \"_blank\");\n        });\n        logo.states.create(\"hover\", {});\n        var m = logo.children.push(Graphics.new(this, {\n          stroke: color(0xcccccc),\n          strokeWidth: 3,\n          svgPath: \"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6\"\n        }));\n        m.states.create(\"hover\", {\n          stroke: color(0x3CABFF)\n        });\n        var a = logo.children.push(Graphics.new(this, {\n          stroke: color(0x888888),\n          strokeWidth: 3,\n          svgPath: \"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0\"\n        }));\n        a.states.create(\"hover\", {\n          stroke: color(0x474758)\n        }); //logo.set(\"tooltip\", this._tooltip);\n        //logo.setPrivate(\"tooltipTarget\", logo.get(\"background\"));\n\n        this._logo = logo;\n\n        this._handleLogo();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_init\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      var renderer = this._renderer;\n      var rect = this.dom.getBoundingClientRect();\n      var width = Math.floor(rect.width);\n      var height = Math.floor(rect.height);\n      var rootContainer = Container.new(this, {\n        visible: true,\n        width: width,\n        height: height\n      });\n      this._rootContainer = rootContainer;\n\n      this._rootContainer._defaultThemes.push(DefaultTheme.new(this));\n\n      var container = rootContainer.children.push(Container.new(this, {\n        visible: true,\n        width: p100,\n        height: p100\n      }));\n      this.container = container;\n      renderer.resize(width, height); //@todo: better appendChild - refer\n\n      this._inner.appendChild(renderer.view); // TODO: TMP TMP TMP for testing only, remove\n      //document.body.appendChild((<any>renderer)._ghostView);\n\n\n      this._initResizeSensor(); // HTML content holder\n\n\n      this._htmlElementContainer = document.createElement(\"div\");\n      this._htmlElementContainer.style.position = \"absolute\";\n      this._htmlElementContainer.style.pointerEvents = \"none\";\n      this._htmlElementContainer.style.overflow = \"hidden\";\n\n      this._inner.appendChild(this._htmlElementContainer); // Create element which is used to make announcements to screen reader\n\n\n      var readerAlertElement = document.createElement(\"div\");\n      readerAlertElement.setAttribute(\"role\", \"alert\");\n      readerAlertElement.style.zIndex = \"-100000\";\n      readerAlertElement.style.opacity = \"0\";\n      readerAlertElement.style.position = \"absolute\";\n      readerAlertElement.style.top = \"0\";\n      this._readerAlertElement = readerAlertElement;\n\n      this._inner.appendChild(this._readerAlertElement);\n\n      var focusElementContainer = document.createElement(\"div\");\n      focusElementContainer.style.position = \"absolute\";\n      focusElementContainer.style.pointerEvents = \"none\";\n      focusElementContainer.style.top = \"0px\";\n      focusElementContainer.style.left = \"0px\";\n      focusElementContainer.style.overflow = \"hidden\";\n      focusElementContainer.style.width = width + \"px\";\n      focusElementContainer.style.height = height + \"px\";\n      focusElementContainer.setAttribute(\"role\", \"application\");\n      $utils.setInteractive(focusElementContainer, false);\n      this._focusElementContainer = focusElementContainer;\n\n      this._inner.appendChild(this._focusElementContainer);\n\n      this._tooltipElementContainer = document.createElement(\"div\");\n\n      this._inner.appendChild(this._tooltipElementContainer); // Add keyboard events for accessibility, e.g. simulating drag with arrow\n      // keys and click with ENTER\n\n\n      if ($utils.supports(\"keyboardevents\")) {\n        this._disposers.push($utils.addEventListener(window, \"keydown\", function (ev) {\n          if (ev.keyCode == 16) {\n            _this._isShift = true;\n          }\n        }));\n\n        this._disposers.push($utils.addEventListener(window, \"keyup\", function (ev) {\n          if (ev.keyCode == 16) {\n            _this._isShift = false;\n          }\n        }));\n\n        this._disposers.push($utils.addEventListener(focusElementContainer, \"keydown\", function (ev) {\n          var focusedSprite = _this._focusedSprite;\n\n          if (focusedSprite) {\n            if (ev.keyCode == 27) {\n              // ESC pressed - lose current focus\n              $utils.blur();\n              _this._focusedSprite = undefined;\n            }\n\n            var dragOffsetX = 0;\n            var dragOffsetY = 0; // TODO: figure out if using bogus MouseEvent is fine, or it will\n            // fail on some platforms\n\n            switch (ev.keyCode) {\n              case 13:\n                ev.preventDefault();\n                var downEvent = renderer.getEvent(new MouseEvent(\"click\"));\n                focusedSprite.events.dispatch(\"click\", {\n                  type: \"click\",\n                  originalEvent: downEvent.event,\n                  point: downEvent.point,\n                  simulated: true,\n                  target: focusedSprite\n                });\n                return;\n\n              case 37:\n                dragOffsetX = -6;\n                break;\n\n              case 39:\n                dragOffsetX = 6;\n                break;\n\n              case 38:\n                dragOffsetY = -6;\n                break;\n\n              case 40:\n                dragOffsetY = 6;\n                break;\n\n              default:\n                return;\n            }\n\n            if (dragOffsetX != 0 || dragOffsetY != 0) {\n              ev.preventDefault();\n\n              if (!focusedSprite.isDragging()) {\n                // Start dragging\n                _this._keyboardDragPoint = {\n                  x: 0,\n                  y: 0\n                };\n                var downEvent = renderer.getEvent(new MouseEvent(\"mousedown\", {\n                  clientX: 0,\n                  clientY: 0\n                }));\n\n                if (focusedSprite.events.isEnabled(\"pointerdown\")) {\n                  focusedSprite.events.dispatch(\"pointerdown\", {\n                    type: \"pointerdown\",\n                    originalEvent: downEvent.event,\n                    point: downEvent.point,\n                    simulated: true,\n                    target: focusedSprite\n                  });\n                }\n              } else {// Move focus marker\n                //this._positionFocusElement(focusedSprite);\n              } // Move incrementally\n\n\n              var dragPoint = _this._keyboardDragPoint;\n              dragPoint.x += dragOffsetX;\n              dragPoint.y += dragOffsetY;\n              var moveEvent = renderer.getEvent(new MouseEvent(\"mousemove\", {\n                clientX: dragPoint.x,\n                clientY: dragPoint.y\n              }), false);\n\n              if (focusedSprite.events.isEnabled(\"globalpointermove\")) {\n                focusedSprite.events.dispatch(\"globalpointermove\", {\n                  type: \"globalpointermove\",\n                  originalEvent: moveEvent.event,\n                  point: moveEvent.point,\n                  simulated: true,\n                  target: focusedSprite\n                });\n              }\n            }\n          }\n        }));\n\n        this._disposers.push($utils.addEventListener(focusElementContainer, \"keyup\", function (ev) {\n          if (_this._focusedSprite) {\n            var focusedSprite = _this._focusedSprite;\n            var keyCode = ev.keyCode;\n\n            switch (keyCode) {\n              case 37:\n              case 39:\n              case 38:\n              case 40:\n                if (focusedSprite.isDragging()) {\n                  // Simulate drag stop\n                  var dragPoint = _this._keyboardDragPoint;\n                  var upEvent = renderer.getEvent(new MouseEvent(\"mouseup\", {\n                    clientX: dragPoint.x,\n                    clientY: dragPoint.y\n                  }));\n\n                  if (focusedSprite.events.isEnabled(\"globalpointerup\")) {\n                    focusedSprite.events.dispatch(\"globalpointerup\", {\n                      type: \"globalpointerup\",\n                      originalEvent: upEvent.event,\n                      point: upEvent.point,\n                      simulated: true,\n                      target: focusedSprite\n                    });\n                  } //this._positionFocusElement(focusedSprite);\n\n\n                  _this._keyboardDragPoint = undefined; // @todo dispatch mouseup event instead of calling dragStop?\n                  // this._dispatchEvent(\"globalpointerup\", target, upEvent);\n\n                  return;\n                } else if (focusedSprite.get(\"focusableGroup\")) {\n                  // Find next item in focusable group\n                  var group_1 = focusedSprite.get(\"focusableGroup\");\n\n                  var items = _this._tabindexes.filter(function (item) {\n                    return item.get(\"focusableGroup\") == group_1;\n                  });\n\n                  var index = items.indexOf(focusedSprite);\n                  var lastIndex = items.length - 1;\n                  index += keyCode == 39 || keyCode == 40 ? 1 : -1;\n\n                  if (index < 0) {\n                    index = lastIndex;\n                  } else if (index > lastIndex) {\n                    index = 0;\n                  }\n\n                  $utils.focus(items[index].getPrivate(\"focusElement\").dom);\n                }\n\n                break;\n            }\n          }\n        }));\n      }\n\n      this._startTicker();\n\n      this.setThemes([]);\n\n      this._addTooltip();\n\n      if (!this._hasLicense()) {\n        this._showBranding();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_initResizeSensor\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      if (this._resizeSensorDisposer) {\n        this._resizeSensorDisposer.dispose();\n      }\n\n      this._resizeSensorDisposer = new ResizeSensor(this.dom, function () {\n        if (_this.autoResize) {\n          _this.resize();\n        }\n      });\n\n      this._disposers.push(this._resizeSensorDisposer);\n    }\n  });\n  /**\r\n   * If automatic resizing of char is disabled (`root.autoResize = false`), it\r\n   * can be resized manually by calling this method.\r\n   */\n\n  Object.defineProperty(Root.prototype, \"resize\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var dom = this.dom;\n      var rect = dom.getBoundingClientRect();\n      var w = Math.floor(rect.width);\n      var h = Math.floor(rect.height);\n\n      if (w > 0 && h > 0) {\n        var htmlElementContainer = this._htmlElementContainer;\n        htmlElementContainer.style.width = w + \"px\";\n        htmlElementContainer.style.height = h + \"px\";\n        var focusElementContainer = this._focusElementContainer;\n        focusElementContainer.style.width = w + \"px\";\n        focusElementContainer.style.height = h + \"px\";\n\n        this._renderer.resize(w, h);\n\n        var rootContainer = this._rootContainer;\n        rootContainer.setPrivate(\"width\", w);\n        rootContainer.setPrivate(\"height\", h);\n\n        this._render();\n\n        this._handleLogo();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_render\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this._renderer.render(this._rootContainer._display);\n\n      if (this._focusElementDirty) {\n        this._updateCurrentFocus();\n\n        this._focusElementDirty = false;\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_runTickers\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (currentTime) {\n      $array.each(this._tickers, function (f) {\n        f(currentTime);\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_runAnimations\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (currentTime) {\n      $array.keepIf(this._animations, function (animation) {\n        return animation._runAnimation(currentTime);\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_runDirties\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this; //console.log(\"tick **************************************************************\");\n\n\n      var allParents = {};\n\n      while (this._isDirtyParents) {\n        // This must be before calling _prepareChildren\n        this._isDirtyParents = false;\n        $object.keys(this._dirtyParents).forEach(function (key) {\n          var parent = _this._dirtyParents[key];\n          delete _this._dirtyParents[key];\n\n          if (!parent.isDisposed()) {\n            allParents[parent.uid] = parent;\n\n            parent._prepareChildren();\n          }\n        });\n      }\n\n      $object.keys(allParents).forEach(function (key) {\n        allParents[key]._updateChildren();\n      });\n      var objects = []; //\t\tconsole.log(\"_beforeChanged\")\n\n      $object.keys(this._dirty).forEach(function (key) {\n        var entity = _this._dirty[key];\n\n        if (entity.isDisposed()) {\n          delete _this._dirty[entity.uid];\n        } else {\n          objects.push(entity);\n\n          entity._beforeChanged();\n        }\n      }); //\t\tconsole.log(\"_changed\")\n\n      objects.forEach(function (entity) {\n        entity._changed();\n\n        delete _this._dirty[entity.uid];\n\n        entity._clearDirty();\n      });\n      this._isDirty = false;\n      var depths = {};\n      var bounds = [];\n      $object.keys(this._dirtyBounds).forEach(function (key) {\n        var entity = _this._dirtyBounds[key];\n        delete _this._dirtyBounds[key];\n\n        if (!entity.isDisposed()) {\n          depths[entity.uid] = entity.depth();\n          bounds.push(entity);\n        }\n      }); // High depth -> low depth\n\n      bounds.sort(function (x, y) {\n        return $order.compare(depths[y.uid], depths[x.uid]);\n      }); //\t\tconsole.log(\"_updateBounds\")\n\n      bounds.forEach(function (entity) {\n        entity._updateBounds();\n      }); //\t\tconsole.log(\"_updatePosition\")\n\n      var dirtyPositions = this._dirtyPositions;\n      $object.keys(dirtyPositions).forEach(function (key) {\n        var sprite = dirtyPositions[key];\n        delete dirtyPositions[key];\n\n        if (!sprite.isDisposed()) {\n          sprite._updatePosition();\n        }\n      }); //\t\tconsole.log(\"_afterChanged\")\n\n      objects.forEach(function (entity) {\n        entity._afterChanged();\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_renderFrame\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (currentTime) {\n      if (this.events.isEnabled(\"framestarted\")) {\n        this.events.dispatch(\"framestarted\", {\n          type: \"framestarted\",\n          target: this,\n          timestamp: currentTime\n        });\n      }\n\n      this._checkComputedStyles();\n\n      this._runTickers(currentTime);\n\n      this._runAnimations(currentTime);\n\n      this._runDirties();\n\n      this._render();\n\n      this._positionHTMLElements();\n\n      if (this.events.isEnabled(\"frameended\")) {\n        this.events.dispatch(\"frameended\", {\n          type: \"frameended\",\n          target: this,\n          timestamp: currentTime\n        });\n      }\n\n      return this._tickers.length === 0 && this._animations.length === 0 && !this._isDirty;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_runTicker\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (currentTime) {\n      if (!this.isDisposed()) {\n        this.animationTime = currentTime;\n\n        var done = this._renderFrame(currentTime); // No more work to do\n\n\n        if (done) {\n          this._ticker = null;\n          this.animationTime = null;\n        } else {\n          rAF(this.fps, this._ticker);\n        }\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_runTickerNow\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (!this.isDisposed()) {\n        for (;;) {\n          var currentTime = performance.now();\n          this.animationTime = currentTime;\n\n          var done = this._renderFrame(currentTime);\n\n          if (done) {\n            this.animationTime = null;\n            break;\n          }\n        }\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_startTicker\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      if (this._ticker === null) {\n        this.animationTime = null;\n\n        this._ticker = function (currentTime) {\n          _this._runTicker(currentTime);\n        };\n\n        rAF(this.fps, this._ticker);\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addDirtyEntity\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (entity) {\n      if (this._dirty[entity.uid] === undefined) {\n        this._isDirty = true;\n        this._dirty[entity.uid] = entity;\n\n        this._startTicker();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addDirtyParent\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (parent) {\n      if (this._dirtyParents[parent.uid] === undefined) {\n        this._isDirty = true;\n        this._isDirtyParents = true;\n        this._dirtyParents[parent.uid] = parent;\n\n        this._startTicker();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addDirtyBounds\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (entity) {\n      if (this._dirtyBounds[entity.uid] === undefined) {\n        this._isDirty = true;\n        this._dirtyBounds[entity.uid] = entity;\n\n        this._startTicker();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addDirtyPosition\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (sprite) {\n      if (this._dirtyPositions[sprite.uid] === undefined) {\n        this._isDirty = true;\n        this._dirtyPositions[sprite.uid] = sprite;\n\n        this._startTicker();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addAnimation\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (animation) {\n      // TODO use numeric id instead\n      if (this._animations.indexOf(animation) === -1) {\n        this._animations.push(animation);\n\n        this._startTicker();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_markDirty\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this._isDirty = true;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_markDirtyRedraw\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      this.events.once(\"frameended\", function () {\n        _this._isDirty = true;\n\n        _this._startTicker();\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"eachFrame\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (f) {\n      var _this = this;\n\n      this._tickers.push(f);\n\n      this._startTicker();\n\n      return new Disposer(function () {\n        $array.removeFirst(_this._tickers, f);\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"markDirtyGlobal\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (container) {\n      var _this = this;\n\n      if (!container) {\n        container = this.container;\n      }\n\n      console.log(this.width());\n      container.walkChildren(function (child) {\n        if (child instanceof Container) {\n          _this.markDirtyGlobal(child);\n        }\n\n        child.markDirty();\n        child.markDirtyBounds();\n      });\n    }\n  });\n  /**\r\n   * Returns width of the target container, in pixels.\r\n   *\r\n   * @return Width\r\n   */\n\n  Object.defineProperty(Root.prototype, \"width\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      // TODO make this more efficient, maybe just return the renderer's width ?\n      return Math.floor(this.dom.getBoundingClientRect().width);\n    }\n  });\n  /**\r\n   * Returns height of the target container, in pixels.\r\n   *\r\n   * @return Height\r\n   */\n\n  Object.defineProperty(Root.prototype, \"height\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      // TODO make this more efficient, maybe just return the renderer's height ?\n      return Math.floor(this.dom.getBoundingClientRect().height);\n    }\n  });\n  /**\r\n   * Disposes root and all the content in it.\r\n   */\n\n  Object.defineProperty(Root.prototype, \"dispose\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (!this._isDisposed) {\n        this._isDisposed = true;\n\n        this._rootContainer.dispose();\n\n        this._renderer.dispose();\n\n        this.horizontalLayout.dispose();\n        this.verticalLayout.dispose();\n        this.interfaceColors.dispose();\n        $array.each(this._disposers, function (x) {\n          x.dispose();\n        });\n\n        if (this._inner) {\n          $utils.removeElement(this._inner);\n        }\n\n        var tooltipRoot = this.tooltipRoot;\n\n        if (tooltipRoot) {\n          tooltipRoot.dispose();\n        }\n\n        $array.remove(registry.rootElements, this);\n      }\n    }\n  });\n  /**\r\n   * Returns `true` if root element is disposed.\r\n   *\r\n   * @return Disposed?\r\n   */\n\n  Object.defineProperty(Root.prototype, \"isDisposed\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      return this._isDisposed;\n    }\n  });\n  /**\r\n   * Triggers screen reader read out a message.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\r\n   * @param  text  Alert text\r\n   */\n\n  Object.defineProperty(Root.prototype, \"readerAlert\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (text) {\n      this._readerAlertElement.innerHTML = $utils.stripTags(text);\n    }\n  });\n  /**\r\n   * Sets themes to be used for the chart.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/concepts/themes/} for more info\r\n   * @param  themes  A list of themes\r\n   */\n\n  Object.defineProperty(Root.prototype, \"setThemes\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (themes) {\n      this._rootContainer.set(\"themes\", themes);\n\n      var tooltipRoot = this.tooltipRoot;\n\n      if (tooltipRoot) {\n        tooltipRoot._rootContainer.set(\"themes\", themes);\n\n        tooltipRoot.tooltipContainer._applyThemes();\n      } // otherwise new themes are not applied\n\n\n      var tooltipContainer = this.tooltipContainer;\n\n      if (tooltipContainer) {\n        tooltipContainer._applyThemes();\n      } // @todo review this\n\n\n      var interfaceColors = this.interfaceColors;\n\n      if (interfaceColors) {\n        interfaceColors._applyThemes();\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_addTooltip\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (!this.tooltipContainer) {\n        var tooltipContainer = this._rootContainer.children.push(Container.new(this, {\n          position: \"absolute\",\n          isMeasured: false,\n          width: p100,\n          height: p100,\n          layer: 30\n        }));\n\n        this.tooltipContainer = tooltipContainer;\n        var tooltipRoot = this.tooltipRoot;\n\n        if (!tooltipRoot) {\n          tooltipRoot = this;\n        }\n\n        var tooltip = Tooltip.new(tooltipRoot, {});\n        this.container.set(\"tooltip\", tooltip);\n        tooltip.hide(0);\n        this._tooltip = tooltip;\n      }\n    }\n  });\n  /**\r\n   * Accesibility\r\n   */\n\n  Object.defineProperty(Root.prototype, \"_registerTabindexOrder\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      if (target.get(\"focusable\")) {\n        $array.pushOne(this._tabindexes, target);\n      } else {\n        $array.remove(this._tabindexes, target);\n      }\n\n      this._invalidateTabindexes();\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_unregisterTabindexOrder\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      $array.remove(this._tabindexes, target);\n\n      this._invalidateTabindexes();\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_invalidateTabindexes\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      this._tabindexes.sort(function (a, b) {\n        var aindex = a.get(\"tabindexOrder\", 0);\n        var bindex = b.get(\"tabindexOrder\", 0);\n\n        if (aindex == bindex) {\n          return 0;\n        } else if (aindex > bindex) {\n          return 1;\n        } else {\n          return -1;\n        }\n      });\n\n      var groups = [];\n      $array.each(this._tabindexes, function (item, index) {\n        if (!item.getPrivate(\"focusElement\")) {\n          _this._makeFocusElement(index, item);\n        } else {\n          _this._moveFocusElement(index, item);\n        }\n\n        var group = item.get(\"focusableGroup\");\n\n        if (group) {\n          if (groups.indexOf(group) !== -1) {\n            // Non-first element in the group, make it not directly focusable\n            item.getPrivate(\"focusElement\").dom.setAttribute(\"tabindex\", \"-1\");\n          } else {\n            groups.push(group);\n          }\n        }\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_updateCurrentFocus\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this._focusedSprite) {\n        this._decorateFocusElement(this._focusedSprite);\n\n        this._positionFocusElement(this._focusedSprite);\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_decorateFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target, focusElement) {\n      // Decorate with proper accessibility attributes\n      if (!focusElement) {\n        focusElement = target.getPrivate(\"focusElement\").dom;\n      }\n\n      if (!focusElement) {\n        return;\n      }\n\n      if (target.get(\"visible\") && target.get(\"role\") != \"tooltip\" && !target.isHidden()) {\n        if (focusElement.getAttribute(\"tabindex\") != \"-1\") {\n          focusElement.setAttribute(\"tabindex\", \"\" + this.tabindex);\n        }\n      } else {\n        focusElement.removeAttribute(\"tabindex\");\n      }\n\n      var role = target.get(\"role\");\n\n      if (role) {\n        focusElement.setAttribute(\"role\", role);\n      } else {\n        focusElement.removeAttribute(\"role\");\n      }\n\n      var ariaLabel = target.get(\"ariaLabel\");\n\n      if (ariaLabel) {\n        var label = populateString(target, ariaLabel);\n        focusElement.setAttribute(\"aria-label\", label);\n      } else {\n        focusElement.removeAttribute(\"aria-label\");\n      }\n\n      var ariaLive = target.get(\"ariaLive\");\n\n      if (ariaLive) {\n        focusElement.setAttribute(\"aria-live\", ariaLive);\n      } else {\n        focusElement.removeAttribute(\"aria-live\");\n      }\n\n      var ariaChecked = target.get(\"ariaChecked\");\n\n      if (ariaChecked != null) {\n        focusElement.setAttribute(\"aria-checked\", ariaChecked ? \"true\" : \"false\");\n      } else {\n        focusElement.removeAttribute(\"aria-checked\");\n      }\n\n      if (target.get(\"ariaHidden\")) {\n        focusElement.setAttribute(\"aria-hidden\", \"hidden\");\n      } else {\n        focusElement.removeAttribute(\"aria-hidden\");\n      }\n\n      var ariaOrientation = target.get(\"ariaOrientation\");\n\n      if (ariaOrientation) {\n        focusElement.setAttribute(\"aria-orientation\", ariaOrientation);\n      } else {\n        focusElement.removeAttribute(\"aria-orientation\");\n      }\n\n      var ariaValueNow = target.get(\"ariaValueNow\");\n\n      if (ariaValueNow) {\n        focusElement.setAttribute(\"aria-valuenow\", ariaValueNow);\n      } else {\n        focusElement.removeAttribute(\"aria-valuenow\");\n      }\n\n      var ariaValueMin = target.get(\"ariaValueMin\");\n\n      if (ariaValueMin) {\n        focusElement.setAttribute(\"aria-valuemin\", ariaValueMin);\n      } else {\n        focusElement.removeAttribute(\"aria-valuemin\");\n      }\n\n      var ariaValueMax = target.get(\"ariaValueMax\");\n\n      if (ariaValueMax) {\n        focusElement.setAttribute(\"aria-valuemax\", ariaValueMax);\n      } else {\n        focusElement.removeAttribute(\"aria-valuemax\");\n      }\n\n      var ariaValueText = target.get(\"ariaValueText\");\n\n      if (ariaValueText) {\n        focusElement.setAttribute(\"aria-valuetext\", ariaValueText);\n      } else {\n        focusElement.removeAttribute(\"aria-valuetext\");\n      }\n\n      var ariaControls = target.get(\"ariaControls\");\n\n      if (ariaControls) {\n        focusElement.setAttribute(\"aria-controls\", ariaControls);\n      } else {\n        focusElement.removeAttribute(\"aria-controls\");\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_makeFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (index, target) {\n      var _this = this;\n\n      if (target.getPrivate(\"focusElement\")) {\n        return;\n      } // Init\n\n\n      var focusElement = document.createElement(\"div\");\n\n      if (target.get(\"role\") != \"tooltip\") {\n        focusElement.tabIndex = this.tabindex;\n      }\n\n      focusElement.style.position = \"absolute\";\n      $utils.setInteractive(focusElement, false);\n      var disposers = [];\n      target.setPrivate(\"focusElement\", {\n        dom: focusElement,\n        disposers: disposers\n      });\n\n      this._decorateFocusElement(target);\n\n      disposers.push($utils.addEventListener(focusElement, \"focus\", function (ev) {\n        _this._handleFocus(ev, index);\n      }));\n      disposers.push($utils.addEventListener(focusElement, \"blur\", function (ev) {\n        _this._handleBlur(ev, index);\n      }));\n\n      this._moveFocusElement(index, target);\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_removeFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      $array.remove(this._tabindexes, target);\n      var focusElement = target.getPrivate(\"focusElement\");\n\n      if (focusElement) {\n        var container = this._focusElementContainer;\n        container.removeChild(focusElement.dom);\n        $array.each(focusElement.disposers, function (x) {\n          x.dispose();\n        });\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_hideFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var focusElement = target.getPrivate(\"focusElement\");\n      focusElement.dom.style.display = \"none\";\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_moveFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (index, target) {\n      // Get container\n      var container = this._focusElementContainer;\n      var focusElement = target.getPrivate(\"focusElement\").dom;\n\n      if (focusElement === this._focusElementContainer.children[index]) {\n        // Nothing to do\n        return;\n      }\n\n      var next = this._focusElementContainer.children[index + 1];\n\n      if (next) {\n        container.insertBefore(focusElement, next);\n      } else {\n        container.append(focusElement);\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_positionFocusElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var bounds = target.globalBounds();\n      var width = bounds.right == bounds.left ? target.width() : bounds.right - bounds.left;\n      var height = bounds.top == bounds.bottom ? target.height() : bounds.bottom - bounds.top;\n      var focusElement = target.getPrivate(\"focusElement\").dom;\n      focusElement.style.top = bounds.top - 2 + \"px\";\n      focusElement.style.left = bounds.left - 2 + \"px\";\n      focusElement.style.width = width + 4 + \"px\";\n      focusElement.style.height = height + 4 + \"px\";\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_handleFocus\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (ev, index) {\n      // Get element\n      var focused = this._tabindexes[index]; // Jump over hidden elements\n\n      if (!focused.isVisibleDeep()) {\n        this._focusNext(ev.target, this._isShift ? -1 : 1);\n\n        return;\n      } // Size and position\n\n\n      this._positionFocusElement(focused); //this._decorateFocusElement(focused);\n\n\n      this._focusedSprite = focused;\n\n      if (focused.events.isEnabled(\"focus\")) {\n        focused.events.dispatch(\"focus\", {\n          type: \"focus\",\n          originalEvent: ev,\n          target: focused\n        });\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_focusNext\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (el, direction) {\n      var focusableElements = Array.from(document.querySelectorAll(['a[href]', 'area[href]', 'button:not([disabled])', 'details', 'input:not([disabled])', 'iframe:not([disabled])', 'select:not([disabled])', 'textarea:not([disabled])', '[contentEditable=\"\"]', '[contentEditable=\"true\"]', '[contentEditable=\"TRUE\"]', '[tabindex]:not([tabindex^=\"-\"])' //':not([disabled])'\n      ].join(',')));\n      var index = focusableElements.indexOf(el) + direction;\n\n      if (index < 0) {\n        index = focusableElements.length - 1;\n      } else if (index >= focusableElements.length) {\n        index = 0;\n      }\n\n      focusableElements[index].focus();\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_handleBlur\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (ev, _index) {\n      var focused = this._focusedSprite;\n\n      if (focused && focused.events.isEnabled(\"blur\")) {\n        focused.events.dispatch(\"blur\", {\n          type: \"blur\",\n          originalEvent: ev,\n          target: focused\n        });\n      }\n\n      this._focusedSprite = undefined;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(Root.prototype, \"updateTooltip\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var text = $utils.stripTags(target._getText());\n      var tooltipElement = target.getPrivate(\"tooltipElement\");\n\n      if (target.get(\"role\") == \"tooltip\" && text != \"\") {\n        if (!tooltipElement) {\n          tooltipElement = this._makeTooltipElement(target);\n        }\n\n        if (tooltipElement.innerHTML != text) {\n          tooltipElement.innerHTML = text;\n        }\n      } else if (tooltipElement) {\n        tooltipElement.remove();\n        target.removePrivate(\"tooltipElement\");\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_makeTooltipElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var container = this._tooltipElementContainer;\n      var tooltipElement = document.createElement(\"div\");\n      tooltipElement.style.position = \"absolute\";\n      tooltipElement.style.top = \"-1000000px\";\n      tooltipElement.style.opacity = \"0.0000001\";\n      $utils.setInteractive(tooltipElement, false);\n\n      this._decorateFocusElement(target, tooltipElement);\n\n      container.append(tooltipElement);\n      target.setPrivate(\"tooltipElement\", tooltipElement);\n      return tooltipElement;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_invalidateAccessibility\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      this._focusElementDirty = true;\n      var focusElement = target.getPrivate(\"focusElement\");\n\n      if (target.get(\"focusable\")) {\n        if (focusElement) {\n          this._decorateFocusElement(target);\n\n          this._positionFocusElement(target);\n        } // else {\n        // \tthis._renderer._makeFocusElement(0, this);\n        // }\n\n      } else if (focusElement) {\n        this._removeFocusElement(target);\n      } //this.updateCurrentFocus();\n\n    }\n  });\n  /**\r\n   * Returns `true` if `target` is currently focused.\r\n   *\r\n   * @param   target  Target\r\n   * @return          Focused?\r\n   */\n\n  Object.defineProperty(Root.prototype, \"focused\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      return this._focusedSprite === target;\n    }\n  });\n  /**\r\n   * Converts document coordinates to coordinates withing root element.\r\n   *\r\n   * @param   point  Document point\r\n   * @return         Root point\r\n   */\n\n  Object.defineProperty(Root.prototype, \"documentPointToRoot\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (point) {\n      var bbox = this.dom.getBoundingClientRect();\n      return {\n        x: point.x - bbox.left,\n        y: point.y - bbox.top\n      };\n    }\n  });\n  /**\r\n   * Converts root coordinates to document\r\n   *\r\n   * @param   point  Document point\r\n   * @return         Root point\r\n   */\n\n  Object.defineProperty(Root.prototype, \"rootPointToDocument\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (point) {\n      var bbox = this.dom.getBoundingClientRect();\n      return {\n        x: point.x + bbox.left,\n        y: point.y + bbox.top\n      };\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(Root.prototype, \"addDisposer\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (disposer) {\n      this._disposers.push(disposer);\n\n      return disposer;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_updateComputedStyles\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var styles = window.getComputedStyle(this.dom);\n      var fontHash = \"\";\n      $object.each(styles, function (key, val) {\n        if ($type.isString(key) && key.match(/^font/)) {\n          fontHash += val;\n        }\n      });\n      var changed = fontHash != this._fontHash;\n\n      if (changed) {\n        this._fontHash = fontHash;\n      }\n\n      return changed;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_checkComputedStyles\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this._updateComputedStyles()) {\n        this._invalidateLabelBounds(this.container);\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_invalidateLabelBounds\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var _this = this;\n\n      if (target instanceof Container) {\n        target.children.each(function (child) {\n          _this._invalidateLabelBounds(child);\n        });\n      } else if (target instanceof Text) {\n        target.markDirtyBounds();\n      }\n    }\n  });\n  /**\r\n   * To all the clever heads out there. Yes, we did not make any attempts to\r\n   * scramble this.\r\n   *\r\n   * This is a part of a tool meant for our users to manage their commercial\r\n   * licenses for removal of amCharts branding from charts.\r\n   *\r\n   * The only legit way to do so is to purchase a commercial license for amCharts:\r\n   * https://www.amcharts.com/online-store/\r\n   *\r\n   * Removing or altering this code, or disabling amCharts branding in any other\r\n   * way is against the license and thus illegal.\r\n   */\n\n  Object.defineProperty(Root.prototype, \"_hasLicense\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      for (var i = 0; i < registry.licenses.length; i++) {\n        if (registry.licenses[i].match(/^AM5C.{5,}/i)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_licenseApplied\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this._logo) {\n        this._logo.set(\"forceHidden\", true);\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"debugGhostView\", {\n    /**\r\n     * @ignore\r\n     */\n    get: function () {\n      return this._renderer.debugGhostView;\n    },\n\n    /**\r\n     * @ignore\r\n     */\n    set: function (value) {\n      this._renderer.debugGhostView = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Root.prototype, \"tapToActivate\", {\n    /**\r\n     * @return Needs a tap to activate touch functions\r\n     */\n    get: function () {\n      return this._renderer.tapToActivate;\n    },\n\n    /**\r\n     * Set this to `true` if you need chart to require first a tap onto it before\r\n     * touch gesture related functionality like zoom/pan is turned on.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\r\n     * @default false\r\n     * @since 5.2.9\r\n     * @param  value  Needs a tap to activate touch functions\r\n     */\n    set: function (value) {\n      this._renderer.tapToActivate = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Root.prototype, \"tapToActivateTimeout\", {\n    /**\r\n     * @return Timeout\r\n     */\n    get: function () {\n      return this._renderer.tapToActivateTimeout;\n    },\n\n    /**\r\n     * If `tapToActivate` is set to `true`, this setting will determine number\r\n     * of milliseconds the chart will stay \"active\", before releasing the\r\n     * controls back to the page.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\r\n     * @default 3000\r\n     * @since 5.2.9\r\n     * @param  value  Timeout\r\n     */\n    set: function (value) {\n      this._renderer.tapToActivateTimeout = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Root.prototype, \"_makeHTMLElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var _this = this; // Get container\n\n\n      var container = this._htmlElementContainer; // Init\n\n      var htmlElement = document.createElement(\"div\");\n      target.setPrivate(\"htmlElement\", htmlElement); //htmlElement.tabIndex = this.tabindex;\n\n      htmlElement.style.position = \"absolute\";\n      htmlElement.style.overflow = \"auto\";\n      htmlElement.style.boxSizing = \"border-box\";\n      $utils.setInteractive(htmlElement, true); // Translate events\n\n      if (target.events.isEnabled(\"click\")) {\n        this._disposers.push($utils.addEventListener(htmlElement, \"click\", function (ev) {\n          var downEvent = _this._renderer.getEvent(ev);\n\n          target.events.dispatch(\"click\", {\n            type: \"click\",\n            originalEvent: downEvent.event,\n            point: downEvent.point,\n            simulated: false,\n            target: target\n          });\n        }));\n      }\n\n      this._positionHTMLElement(target);\n\n      container.append(htmlElement);\n      $array.pushOne(this._htmlEnabledContainers, target);\n      return htmlElement;\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_positionHTMLElements\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      $array.each(this._htmlEnabledContainers, function (target) {\n        _this._positionHTMLElement(target);\n      });\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_positionHTMLElement\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var htmlElement = target.getPrivate(\"htmlElement\");\n\n      if (htmlElement) {\n        // Translate settings\n        var visualSettings = [\"paddingTop\", \"paddingRight\", \"paddingBottom\", \"paddingLeft\", \"minWidth\", \"minHeight\", \"maxWidth\", \"maxHeight\"];\n        $array.each(visualSettings, function (setting) {\n          var value = target.get(setting);\n\n          if (value) {\n            htmlElement.style[setting] = value + \"px\";\n          } else {\n            htmlElement.style[setting] = \"\";\n          }\n        }); // Deal with opacity\n\n        var opacity_1 = target.compositeOpacity();\n        setTimeout(function () {\n          htmlElement.style.opacity = opacity_1 + \"\";\n        }, 10);\n        var visible = target.isVisibleDeep();\n\n        if (visible) {\n          htmlElement.style.display = \"block\";\n        } // Deal with position\n\n\n        var bounds = target.globalBounds();\n        htmlElement.style.top = bounds.top + \"px\";\n        htmlElement.style.left = bounds.left + \"px\"; // Use width/height if those are set\n\n        var width = target.get(\"width\");\n        var height = target.get(\"height\");\n        var w = 0;\n        var h = 0;\n\n        if (width) {\n          w = target.width();\n        }\n\n        if (height) {\n          h = target.height();\n        }\n\n        if (!width || !height) {\n          htmlElement.style.width = \"\";\n          htmlElement.style.height = \"\";\n          var bbox = htmlElement.getBoundingClientRect();\n          w = bbox.width;\n          h = bbox.height;\n          target._adjustedLocalBounds = {\n            left: 0,\n            right: 0,\n            top: 0,\n            bottom: 0\n          };\n          target.setPrivate(\"minWidth\", w);\n          target.setPrivate(\"minHeight\", h);\n        } else {\n          target.removePrivate(\"minWidth\");\n          target.removePrivate(\"minHeight\");\n        }\n\n        if (w > 0) {\n          htmlElement.style.minWidth = w + \"px\";\n        }\n\n        if (h > 0) {\n          htmlElement.style.minHeight = h + \"px\";\n        } // Hide or show\n\n\n        if (!visible || opacity_1 == 0) {\n          htmlElement.style.display = \"none\";\n        }\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_setHTMLContent\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target, html) {\n      var htmlElement = target.getPrivate(\"htmlElement\");\n\n      if (!htmlElement) {\n        htmlElement = this._makeHTMLElement(target);\n      }\n\n      if (htmlElement.innerHTML != html) {\n        htmlElement.innerHTML = html;\n      }\n    }\n  });\n  Object.defineProperty(Root.prototype, \"_removeHTMLContent\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (target) {\n      var htmlElement = target.getPrivate(\"htmlElement\");\n\n      if (htmlElement) {\n        this._htmlElementContainer.removeChild(htmlElement);\n      }\n\n      $array.remove(this._htmlEnabledContainers, target);\n    }\n  });\n  return Root;\n}();\n\nexport { Root };","map":{"version":3,"mappings":"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","names":["Container","Text","HorizontalLayout","VerticalLayout","GridLayout","Disposer","ResizeSensor","InterfaceColors","Graphics","Rectangle","Tooltip","NumberFormatter","DateFormatter","DurationFormatter","Language","EventDispatcher","DefaultTheme","CanvasRenderer","p100","percent","color","populateString","registry","$order","$array","$object","$utils","$type","en","rAF","fps","callback","requestAnimationFrame","setTimeout","id","settings","isReal","Object","new","Error","useSafeResolution","resolution","getSafeResolution","_renderer","dom","HTMLElement","document","getElementById","each","rootElements","root","interfaceColors","inner","createElement","style","position","height","appendChild","tooltipContainerBounds","tooltipDiv","setInteractive","tooltipDivStyle","top","left","width","right","bottom","zIndex","tooltipRoot","Root","_init","tooltipContainer","setAll","x","y","_inner","_updateComputedStyles","push","childNodes","length","_initResizeSensor","resize","_logo","w","offsetWidth","h","offsetHeight","hide","show","logo","children","interactive","interactiveChildren","setStateOnChildren","paddingTop","paddingRight","paddingBottom","paddingLeft","scale","centerY","tooltipText","tooltipX","cursorOverStyle","background","fill","fillOpacity","tooltipY","tooltip","pointerOrientation","label","fontSize","get","stroke","strokeOpacity","set","events","on","window","open","states","create","m","strokeWidth","svgPath","a","_handleLogo","renderer","rect","getBoundingClientRect","Math","floor","rootContainer","visible","_rootContainer","_defaultThemes","container","view","_htmlElementContainer","pointerEvents","overflow","readerAlertElement","setAttribute","opacity","_readerAlertElement","focusElementContainer","_focusElementContainer","_tooltipElementContainer","supports","_disposers","addEventListener","ev","keyCode","_this","_isShift","focusedSprite","_focusedSprite","blur","undefined","dragOffsetX","dragOffsetY","preventDefault","downEvent","getEvent","MouseEvent","dispatch","type","originalEvent","event","point","simulated","target","isDragging","_keyboardDragPoint","clientX","clientY","isEnabled","dragPoint","moveEvent","upEvent","group_1","items","_tabindexes","filter","index","indexOf","lastIndex","focus","getPrivate","_startTicker","setThemes","_addTooltip","_hasLicense","_showBranding","_resizeSensorDisposer","dispose","autoResize","htmlElementContainer","setPrivate","_render","render","_display","_focusElementDirty","_updateCurrentFocus","currentTime","_tickers","f","keepIf","_animations","animation","_runAnimation","allParents","_isDirtyParents","keys","_dirtyParents","forEach","key","parent","isDisposed","uid","_prepareChildren","_updateChildren","objects","_dirty","entity","_beforeChanged","_changed","_clearDirty","_isDirty","depths","bounds","_dirtyBounds","depth","sort","compare","_updateBounds","dirtyPositions","_dirtyPositions","sprite","_updatePosition","_afterChanged","timestamp","_checkComputedStyles","_runTickers","_runAnimations","_runDirties","_positionHTMLElements","animationTime","done","_renderFrame","_ticker","performance","now","_runTicker","once","removeFirst","console","log","walkChildren","child","markDirtyGlobal","markDirty","markDirtyBounds","_isDisposed","horizontalLayout","verticalLayout","removeElement","remove","text","innerHTML","stripTags","themes","_applyThemes","isMeasured","layer","_tooltip","pushOne","_invalidateTabindexes","b","aindex","bindex","groups","item","_makeFocusElement","_moveFocusElement","group","_decorateFocusElement","_positionFocusElement","focusElement","isHidden","getAttribute","tabindex","removeAttribute","role","ariaLabel","ariaLive","ariaChecked","ariaOrientation","ariaValueNow","ariaValueMin","ariaValueMax","ariaValueText","ariaControls","tabIndex","disposers","_handleFocus","_handleBlur","removeChild","display","next","insertBefore","append","globalBounds","focused","isVisibleDeep","_focusNext","el","direction","focusableElements","Array","from","querySelectorAll","join","_index","_getText","tooltipElement","_makeTooltipElement","removePrivate","_removeFocusElement","bbox","disposer","styles","getComputedStyle","fontHash","val","isString","match","changed","_fontHash","_invalidateLabelBounds","i","licenses","debugGhostView","value","tapToActivate","tapToActivateTimeout","htmlElement","boxSizing","_positionHTMLElement","_htmlEnabledContainers","visualSettings","setting","opacity_1","compositeOpacity","_adjustedLocalBounds","minWidth","minHeight","html","_makeHTMLElement"],"sourceRoot":"","sources":["../../../../src/.internal/core/Root.ts"],"sourcesContent":["import type { IAnimation } from \"./util/Animation\";\nimport type { Entity } from \"./util/Entity\";\nimport type { Sprite } from \"./render/Sprite\";\nimport type { Theme } from \"./Theme\";\nimport type { IPoint } from \"./util/IPoint\";\nimport type { IRenderer, IPointerEvent } from \"./render/backend/Renderer\";\nimport type { Timezone } from \"./util/Timezone\";\n\nimport { Container } from \"./render/Container\";\nimport { Text } from \"./render/Text\";\nimport { HorizontalLayout } from \"./render/HorizontalLayout\";\nimport { VerticalLayout } from \"./render/VerticalLayout\";\nimport { GridLayout } from \"./render/GridLayout\";\nimport { IDisposer, Disposer } from \"./util/Disposer\";\nimport { ResizeSensor } from \"./util/ResizeSensor\";\nimport { InterfaceColors } from \"./util/InterfaceColors\";\nimport { Graphics } from \"./render/Graphics\";\nimport { Rectangle } from \"./render/Rectangle\";\nimport { Tooltip } from \"./render/Tooltip\";\nimport { NumberFormatter } from \"./util/NumberFormatter\";\nimport { DateFormatter } from \"./util/DateFormatter\";\nimport { DurationFormatter } from \"./util/DurationFormatter\";\nimport { ILocale, Language } from \"./util/Language\";\nimport { Events, EventDispatcher } from \"./util/EventDispatcher\";\nimport { DefaultTheme } from \"../themes/DefaultTheme\";\nimport { CanvasRenderer } from \"./render/backend/CanvasRenderer\";\nimport { p100, percent } from \"./util/Percent\";\nimport { color } from \"./util/Color\";\nimport { populateString } from \"./util/PopulateString\";\nimport { registry } from \"./Registry\";\n\nimport * as $order from \"./util/Order\";\nimport * as $array from \"./util/Array\";\nimport * as $object from \"./util/Object\";\nimport * as $utils from \"./util/Utils\";\nimport * as $type from \"./util/Type\";\n\n\nimport en from \"../../locales/en\";\n\n\nfunction rAF(fps: number | undefined, callback: (currentTime: number) => void): void {\n\tif (fps == null) {\n\t\trequestAnimationFrame(callback);\n\n\t} else {\n\t\tsetTimeout(() => {\n\t\t\trequestAnimationFrame(callback);\n\t\t}, 1000 / fps);\n\t}\n}\n\n\n/**\n * @ignore\n */\ninterface IParent extends Entity {\n\t_prepareChildren(): void;\n\t_updateChildren(): void;\n}\n\ninterface IBounds extends Entity {\n\tdepth(): number;\n\t_updateBounds(): void;\n}\n\n\nexport interface IRootEvents {\n\tframestarted: {\n\t\ttimestamp: number;\n\t};\n\tframeended: {\n\t\ttimestamp: number;\n\t};\n}\n\n\nexport interface IRootSettings {\n\n\t/**\n\t * Indicates whether chart should use \"safe\" resolution on some memory-limiting\n\t * platforms such as Safari.\n\t *\n\t * @default true\n\t */\n\tuseSafeResolution?: boolean;\n\n\t/**\n\t * Allows defining margins around chart area for tooltips to go outside the\n\t * chart itself.\n\t *\n\t * @since 5.2.24\n\t */\n\ttooltipContainerBounds?: { top: number, left: number, right: number, bottom: number };\n}\n\n\n// TODO implement Disposer\n/**\n * Root element of the chart.\n *\n * @see {@link https://www.amcharts.com/docs/v5/getting-started/#Root_element} for more info\n */\nexport class Root implements IDisposer {\n\n\t/**\n\t * A reference to original chart container (div element).\n\t */\n\tpublic dom: HTMLElement;\n\tpublic _inner: HTMLElement;\n\n\tprotected _isDirty: boolean = false;\n\tprotected _isDirtyParents: boolean = false;\n\tprotected _dirty: { [id: number]: Entity } = {};\n\tprotected _dirtyParents: { [id: number]: IParent } = {};\n\tprotected _dirtyBounds: { [id: number]: IBounds } = {};\n\tprotected _dirtyPositions: { [id: number]: Sprite } = {};\n\n\tprotected _ticker: ((currentTime: number) => void) | null = null;\n\tprotected _tickers: Array<(currentTime: number) => void> = [];\n\n\t/**\n\t * Root's event dispatcher.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\n\t */\n\tpublic events: EventDispatcher<Events<this, IRootEvents>> = new EventDispatcher();\n\n\t/**\n\t * @ignore\n\t * @todo needs description\n\t */\n\tpublic animationTime: number | null = null;\n\n\tprivate _animations: Array<IAnimation> = [];\n\n\tpublic _renderer: IRenderer;\n\n\tpublic _rootContainer!: Container;\n\n\t/**\n\t * Main content container.\n\t */\n\tpublic container!: Container;\n\n\t/**\n\t * A [[Container]] used to display tooltips in.\n\t */\n\tpublic tooltipContainer!: Container\n\n\tpublic _tooltip!: Tooltip;\n\n\t// Locale-related\n\n\t/**\n\t * @ignore\n\t */\n\tpublic language: Language = Language.new(this, {});\n\n\t/**\n\t * Locale used by the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/}\n\t */\n\tpublic locale: ILocale = en;\n\n\t// Date-time related\n\n\t/**\n\t * Use UTC when formatting date/time.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#UTC_and_time_zones} for more info\n\t */\n\tpublic utc: boolean = false;\n\n\t/**\n\t * If set, will format date/time in specific time zone.\n\t *\n\t * The value should be named time zone, e.g.:\n\t * `\"America/Vancouver\"`, `\"Australia/Sydney\"`, `\"UTC\"`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Time_zone} for more info\n\t * @since 5.1.0\n\t */\n\tpublic timezone?: Timezone;\n\n\t/**\n\t * The maximum FPS that the Root will run at.\n\t *\n\t * If `undefined` it will run at the highest FPS.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Performance} for more info\n\t */\n\tpublic fps: number | undefined;\n\n\t/**\n\t * Number formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\n\t */\n\tpublic numberFormatter: NumberFormatter = NumberFormatter.new(this, {});\n\n\t/**\n\t * Date/time formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic dateFormatter: DateFormatter = DateFormatter.new(this, {});\n\n\t/**\n\t * Duration formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic durationFormatter: DurationFormatter = DurationFormatter.new(this, {});\n\n\n\t// Accessibility\n\n\t/**\n\t * Global tab index for using for the whole chart\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t */\n\tpublic tabindex: number = 0;\n\n\t//@todo maybe make this better\n\tprotected _tabindexes: Sprite[] = [];\n\n\tprotected _focusElementDirty: boolean = false;\n\tprotected _focusElementContainer: HTMLDivElement | undefined;\n\tprotected _focusedSprite: Sprite | undefined;\n\tprotected _isShift: boolean | undefined;\n\tprotected _keyboardDragPoint: IPoint | undefined;\n\tprotected _tooltipElementContainer: HTMLDivElement | undefined;\n\tprotected _readerAlertElement: HTMLDivElement | undefined;\n\n\tpublic _logo?: Container;\n\n\tpublic _tooltipDiv: HTMLDivElement | undefined;\n\n\t/**\n\t * Used for dynamically-created CSS and JavaScript with strict source policies.\n\t */\n\tpublic nonce?: string;\n\n\t/**\n\t * Special color set to be used for various controls.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/#Interface_colors} for more info\n\t */\n\tpublic interfaceColors: InterfaceColors;\n\n\t/**\n\t * An instance of vertical layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic verticalLayout: VerticalLayout = VerticalLayout.new(this, {});\n\n\t/**\n\t * An instance of horizontal layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default HorizontalLayout.new()\n\t */\n\tpublic horizontalLayout: VerticalLayout = HorizontalLayout.new(this, {});\n\n\t/**\n\t * An instance of grid layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic gridLayout: VerticalLayout = GridLayout.new(this, {});\n\n\t/**\n\t * Indicates whether chart should resized automatically when parent container\n\t * width and/or height changes.\n\t *\n\t * If disabled (`autoResize = false`) you can make the chart resize manually\n\t * by calling root element's `resize()` method.\n\t */\n\tpublic autoResize: boolean = true;\n\n\tprotected _fontHash: string = \"\";\n\n\tprotected _isDisposed: boolean = false;\n\tprotected _disposers: Array<IDisposer> = [];\n\n\tprotected _resizeSensorDisposer?: IDisposer;\n\n\tpublic _tooltips: Array<Tooltip> = [];\n\n\tprotected _htmlElementContainer: HTMLDivElement | undefined;\n\tprotected _htmlEnabledContainers: Container[] = [];\n\n\tpublic tooltipRoot?: Root;\n\n\tprotected constructor(id: string | HTMLElement, settings: IRootSettings = {}, isReal: boolean) {\n\n\t\tif (!isReal) {\n\t\t\tthrow new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n\t\t}\n\n\t\tif (settings.useSafeResolution == null) {\n\t\t\tsettings.useSafeResolution = true;\n\t\t}\n\n\t\tlet resolution;\n\n\t\tif (settings.useSafeResolution) {\n\t\t\tresolution = $utils.getSafeResolution();\n\t\t}\n\n\t\tthis._renderer = new CanvasRenderer(resolution);\n\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\t$array.each(registry.rootElements, (root) => {\n\t\t\tif (root.dom === dom) {\n\t\t\t\tthrow new Error(\"You cannot have multiple Roots on the same DOM node\");\n\t\t\t}\n\t\t});\n\n\t\tthis.interfaceColors = InterfaceColors.new(this, {});\n\n\t\tif (dom === null) {\n\t\t\tthrow new Error(\"Could not find HTML element with id `\" + id + \"`\");\n\t\t}\n\n\t\tthis.dom = dom;\n\n\t\tlet inner: HTMLDivElement = document.createElement(\"div\");\n\t\tinner.style.position = \"relative\";\n\t\tinner.style.height = \"100%\";\n\t\tdom.appendChild(inner);\n\n\t\tconst tooltipContainerBounds = settings.tooltipContainerBounds;\n\t\tif (tooltipContainerBounds) {\n\t\t\tlet tooltipDiv: HTMLDivElement = document.createElement(\"div\");\n\t\t\t$utils.setInteractive(tooltipDiv, false);\n\n\t\t\tlet tooltipDivStyle = tooltipDiv.style;\n\t\t\ttooltipDivStyle.position = \"absolute\";\n\t\t\ttooltipDivStyle.top = -tooltipContainerBounds.top + \"px\";\n\t\t\ttooltipDivStyle.left = -tooltipContainerBounds.left + \"px\";\n\t\t\ttooltipDivStyle.width = \"calc(100% + \" + (tooltipContainerBounds.left + tooltipContainerBounds.right) + \"px)\";\n\t\t\ttooltipDivStyle.height = \"calc(100% + \" + (tooltipContainerBounds.top + tooltipContainerBounds.bottom) + \"px)\";\n\t\t\ttooltipDivStyle.zIndex = \"1\";\n\t\t\tinner.appendChild(tooltipDiv);\n\n\t\t\tthis.tooltipRoot = new Root(tooltipDiv, {}, true);\n\t\t\tthis.tooltipRoot._init();\n\t\t\tthis.tooltipRoot.tooltipContainer.setAll({ x: tooltipContainerBounds.left, y: tooltipContainerBounds.top });\n\t\t}\n\n\t\tthis._inner = inner;\n\n\t\tthis._updateComputedStyles();\n\n\t\tregistry.rootElements.push(this);\n\t}\n\n\n\n\n\tpublic static new(id: string | HTMLElement, settings?: IRootSettings): Root {\n\t\tconst root = new Root(id, settings, true);\n\t\troot._init();\n\t\treturn root;\n\t}\n\n\tpublic moveDOM(id: string | HTMLElement): void {\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\tif (dom) {\n\t\t\twhile (this.dom.childNodes.length > 0) {\n\t\t\t\tdom.appendChild(this.dom.childNodes[0]);\n\t\t\t}\n\t\t\tthis.dom = dom;\n\t\t\tthis._initResizeSensor();\n\t\t\tthis.resize();\n\t\t}\n\n\t}\n\n\n\tprotected _handleLogo(): void {\n\t\tif (this._logo) {\n\t\t\tconst w = this.dom.offsetWidth;\n\t\t\tconst h = this.dom.offsetHeight;\n\t\t\tif ((w <= 150) || (h <= 60)) {\n\t\t\t\tthis._logo.hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._logo.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _showBranding(): void {\n\t\tif (!this._logo) {\n\t\t\tconst logo = this.tooltipContainer.children.push(Container.new(this, {\n\t\t\t\tinteractive: true,\n\t\t\t\tinteractiveChildren: false,\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tsetStateOnChildren: true,\n\t\t\t\tpaddingTop: 9,\n\t\t\t\tpaddingRight: 9,\n\t\t\t\tpaddingBottom: 9,\n\t\t\t\tpaddingLeft: 9,\n\t\t\t\tscale: .6,\n\t\t\t\ty: percent(100),\n\t\t\t\tcenterY: p100,\n\t\t\t\ttooltipText: \"Created using amCharts 5\",\n\t\t\t\ttooltipX: p100,\n\t\t\t\tcursorOverStyle: \"pointer\",\n\t\t\t\tbackground: Rectangle.new(this, {\n\t\t\t\t\tfill: color(0x474758),\n\t\t\t\t\tfillOpacity: 0,\n\t\t\t\t\ttooltipY: 5\n\t\t\t\t})\n\t\t\t}));\n\n\t\t\tlet tooltipRoot = this.tooltipRoot;\n\t\t\tif (!tooltipRoot) {\n\t\t\t\ttooltipRoot = this;\n\t\t\t}\n\n\t\t\tconst tooltip = Tooltip.new(tooltipRoot, {\n\t\t\t\tpointerOrientation: \"horizontal\",\n\t\t\t\tpaddingTop: 4,\n\t\t\t\tpaddingRight: 7,\n\t\t\t\tpaddingBottom: 4,\n\t\t\t\tpaddingLeft: 7\n\t\t\t});\n\t\t\ttooltip.label.setAll({\n\t\t\t\tfontSize: 12\n\t\t\t});\n\t\t\ttooltip.get(\"background\")!.setAll({\n\t\t\t\tfill: this.interfaceColors.get(\"background\"),\n\t\t\t\tstroke: this.interfaceColors.get(\"grid\"),\n\t\t\t\tstrokeOpacity: 0.3\n\t\t\t})\n\t\t\tlogo.set(\"tooltip\", tooltip);\n\n\t\t\tlogo.events.on(\"click\", () => {\n\t\t\t\twindow.open(\"https://www.amcharts.com/\", \"_blank\");\n\t\t\t});\n\n\t\t\tlogo.states.create(\"hover\", {});\n\n\t\t\tconst m = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0xcccccc),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6\"\n\t\t\t}));\n\n\t\t\tm.states.create(\"hover\", { stroke: color(0x3CABFF) });\n\n\t\t\tconst a = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0x888888),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0\"\n\t\t\t}));\n\n\t\t\ta.states.create(\"hover\", { stroke: color(0x474758) });\n\n\t\t\t//logo.set(\"tooltip\", this._tooltip);\n\t\t\t//logo.setPrivate(\"tooltipTarget\", logo.get(\"background\"));\n\t\t\tthis._logo = logo;\n\n\t\t\tthis._handleLogo();\n\t\t}\n\t}\n\n\tprotected _init(): void {\n\t\tconst renderer = this._renderer;\n\t\tconst rect = this.dom.getBoundingClientRect();\n\t\tconst width = Math.floor(rect.width);\n\t\tconst height = Math.floor(rect.height);\n\t\tconst rootContainer = Container.new(this, { visible: true, width, height });\n\t\tthis._rootContainer = rootContainer;\n\t\tthis._rootContainer._defaultThemes.push(DefaultTheme.new(this));\n\n\t\tconst container = rootContainer.children.push(Container.new(this, { visible: true, width: p100, height: p100 }));\n\t\tthis.container = container;\n\n\t\trenderer.resize(width, height);\n\n\t\t//@todo: better appendChild - refer\n\t\tthis._inner.appendChild(renderer.view);\n\n\t\t// TODO: TMP TMP TMP for testing only, remove\n\t\t//document.body.appendChild((<any>renderer)._ghostView);\n\n\t\tthis._initResizeSensor();\n\n\t\t// HTML content holder\n\t\tthis._htmlElementContainer = document.createElement(\"div\");\n\t\tthis._htmlElementContainer.style.position = \"absolute\";\n\t\tthis._htmlElementContainer.style.pointerEvents = \"none\";\n\t\tthis._htmlElementContainer.style.overflow = \"hidden\";\n\t\tthis._inner.appendChild(this._htmlElementContainer);\n\n\t\t// Create element which is used to make announcements to screen reader\n\t\tconst readerAlertElement = document.createElement(\"div\");\n\t\treaderAlertElement.setAttribute(\"role\", \"alert\");\n\t\treaderAlertElement.style.zIndex = \"-100000\";\n\t\treaderAlertElement.style.opacity = \"0\";\n\t\treaderAlertElement.style.position = \"absolute\";\n\t\treaderAlertElement.style.top = \"0\";\n\t\tthis._readerAlertElement = readerAlertElement;\n\t\tthis._inner.appendChild(this._readerAlertElement);\n\n\t\tconst focusElementContainer = document.createElement(\"div\");\n\t\tfocusElementContainer.style.position = \"absolute\";\n\t\tfocusElementContainer.style.pointerEvents = \"none\";\n\t\tfocusElementContainer.style.top = \"0px\";\n\t\tfocusElementContainer.style.left = \"0px\";\n\t\tfocusElementContainer.style.overflow = \"hidden\";\n\t\tfocusElementContainer.style.width = width + \"px\";\n\t\tfocusElementContainer.style.height = height + \"px\";\n\n\t\tfocusElementContainer.setAttribute(\"role\", \"application\");\n\n\t\t$utils.setInteractive(focusElementContainer, false);\n\t\tthis._focusElementContainer = focusElementContainer;\n\t\tthis._inner.appendChild(this._focusElementContainer);\n\n\t\tthis._tooltipElementContainer = document.createElement(\"div\");\n\t\tthis._inner.appendChild(this._tooltipElementContainer);\n\n\t\t// Add keyboard events for accessibility, e.g. simulating drag with arrow\n\t\t// keys and click with ENTER\n\t\tif ($utils.supports(\"keyboardevents\")) {\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\tif (ev.keyCode == 16) {\n\t\t\t\t\tthis._isShift = true;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\tif (ev.keyCode == 16) {\n\t\t\t\t\tthis._isShift = false;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\tif (focusedSprite) {\n\t\t\t\t\tif (ev.keyCode == 27) {\n\t\t\t\t\t\t// ESC pressed - lose current focus\n\t\t\t\t\t\t$utils.blur();\n\t\t\t\t\t\tthis._focusedSprite = undefined;\n\t\t\t\t\t}\n\t\t\t\t\tlet dragOffsetX = 0;\n\t\t\t\t\tlet dragOffsetY = 0;\n\t\t\t\t\t// TODO: figure out if using bogus MouseEvent is fine, or it will\n\t\t\t\t\t// fail on some platforms\n\t\t\t\t\tswitch (ev.keyCode) {\n\t\t\t\t\t\tcase 13:\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"click\"));\n\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"click\", {\n\t\t\t\t\t\t\t\ttype: \"click\",\n\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tcase 37:\n\t\t\t\t\t\t\tdragOffsetX = -6;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 39:\n\t\t\t\t\t\t\tdragOffsetX = 6;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 38:\n\t\t\t\t\t\t\tdragOffsetY = -6;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 40:\n\t\t\t\t\t\t\tdragOffsetY = 6;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (dragOffsetX != 0 || dragOffsetY != 0) {\n\t\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\t\tif (!focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t// Start dragging\n\t\t\t\t\t\t\tthis._keyboardDragPoint = {\n\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"mousedown\", {\n\t\t\t\t\t\t\t\tclientX: 0,\n\t\t\t\t\t\t\t\tclientY: 0\n\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"pointerdown\")) {\n\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"pointerdown\", {\n\t\t\t\t\t\t\t\t\ttype: \"pointerdown\",\n\t\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Move focus marker\n\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Move incrementally\n\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\tdragPoint.x += dragOffsetX;\n\t\t\t\t\t\tdragPoint.y += dragOffsetY;\n\t\t\t\t\t\tconst moveEvent = renderer.getEvent(new MouseEvent(\"mousemove\", {\n\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t}), false);\n\n\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointermove\")) {\n\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointermove\", {\n\t\t\t\t\t\t\t\ttype: \"globalpointermove\",\n\t\t\t\t\t\t\t\toriginalEvent: moveEvent.event,\n\t\t\t\t\t\t\t\tpoint: moveEvent.point,\n\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\tif (this._focusedSprite) {\n\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\tconst keyCode = ev.keyCode;\n\t\t\t\t\tswitch (keyCode) {\n\t\t\t\t\t\tcase 37:\n\t\t\t\t\t\tcase 39:\n\t\t\t\t\t\tcase 38:\n\t\t\t\t\t\tcase 40:\n\t\t\t\t\t\t\tif (focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t\t// Simulate drag stop\n\t\t\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\t\t\tconst upEvent = renderer.getEvent(new MouseEvent(\"mouseup\", {\n\t\t\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointerup\")) {\n\t\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointerup\", {\n\t\t\t\t\t\t\t\t\t\ttype: \"globalpointerup\",\n\t\t\t\t\t\t\t\t\t\toriginalEvent: upEvent.event,\n\t\t\t\t\t\t\t\t\t\tpoint: upEvent.point,\n\t\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t\t\tthis._keyboardDragPoint = undefined;\n\t\t\t\t\t\t\t\t// @todo dispatch mouseup event instead of calling dragStop?\n\t\t\t\t\t\t\t\t// this._dispatchEvent(\"globalpointerup\", target, upEvent);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (focusedSprite.get(\"focusableGroup\")) {\n\t\t\t\t\t\t\t\t// Find next item in focusable group\n\t\t\t\t\t\t\t\tconst group = focusedSprite.get(\"focusableGroup\");\n\t\t\t\t\t\t\t\tconst items = this._tabindexes.filter(item => item.get(\"focusableGroup\") == group);\n\t\t\t\t\t\t\t\tlet index = items.indexOf(focusedSprite);\n\t\t\t\t\t\t\t\tconst lastIndex = items.length - 1;\n\t\t\t\t\t\t\t\tindex += (keyCode == 39 || keyCode == 40) ? 1 : -1;\n\t\t\t\t\t\t\t\tif (index < 0) {\n\t\t\t\t\t\t\t\t\tindex = lastIndex;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (index > lastIndex) {\n\t\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t$utils.focus(items[index].getPrivate(\"focusElement\")!.dom);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis._startTicker();\n\t\tthis.setThemes([]);\n\n\t\tthis._addTooltip();\n\n\t\tif (!this._hasLicense()) {\n\t\t\tthis._showBranding();\n\t\t}\n\t}\n\n\tprivate _initResizeSensor(): void {\n\t\tif (this._resizeSensorDisposer) {\n\t\t\tthis._resizeSensorDisposer.dispose();\n\t\t}\n\t\tthis._resizeSensorDisposer = new ResizeSensor(this.dom, () => {\n\t\t\tif (this.autoResize) {\n\t\t\t\tthis.resize();\n\t\t\t}\n\t\t});\n\t\tthis._disposers.push(this._resizeSensorDisposer);\n\t}\n\n\t/**\n\t * If automatic resizing of char is disabled (`root.autoResize = false`), it\n\t * can be resized manually by calling this method.\n\t */\n\tpublic resize(): void {\n\t\tconst dom = this.dom;\n\t\tconst rect = dom.getBoundingClientRect();\n\t\tconst w = Math.floor(rect.width);\n\t\tconst h = Math.floor(rect.height);\n\t\tif (w > 0 && h > 0) {\n\t\t\tconst htmlElementContainer = this._htmlElementContainer!;\n\t\t\thtmlElementContainer.style.width = w + \"px\";\n\t\t\thtmlElementContainer.style.height = h + \"px\";\n\n\t\t\tconst focusElementContainer = this._focusElementContainer!;\n\t\t\tfocusElementContainer.style.width = w + \"px\";\n\t\t\tfocusElementContainer.style.height = h + \"px\";\n\n\t\t\tthis._renderer.resize(w, h);\n\n\t\t\tconst rootContainer = this._rootContainer;\n\n\t\t\trootContainer.setPrivate(\"width\", w);\n\t\t\trootContainer.setPrivate(\"height\", h);\n\t\t\tthis._render();\n\t\t\tthis._handleLogo();\n\t\t}\n\t}\n\n\tprivate _render() {\n\t\tthis._renderer.render(this._rootContainer._display);\n\n\t\tif (this._focusElementDirty) {\n\t\t\tthis._updateCurrentFocus();\n\t\t\tthis._focusElementDirty = false;\n\t\t}\n\t}\n\n\tprivate _runTickers(currentTime: number) {\n\t\t$array.each(this._tickers, (f) => {\n\t\t\tf(currentTime);\n\t\t});\n\t}\n\n\tprivate _runAnimations(currentTime: number) {\n\t\t$array.keepIf(this._animations, (animation) => {\n\t\t\treturn animation._runAnimation(currentTime);\n\t\t});\n\t}\n\n\tprivate _runDirties() {\n\t\t//console.log(\"tick **************************************************************\");\n\t\tlet allParents: { [id: number]: IParent } = {};\n\n\t\twhile (this._isDirtyParents) {\n\t\t\t// This must be before calling _prepareChildren\n\t\t\tthis._isDirtyParents = false;\n\n\t\t\t$object.keys(this._dirtyParents).forEach((key) => {\n\t\t\t\tconst parent = this._dirtyParents[key];\n\n\t\t\t\tdelete this._dirtyParents[key];\n\n\t\t\t\tif (!parent.isDisposed()) {\n\t\t\t\t\tallParents[parent.uid] = parent;\n\t\t\t\t\tparent._prepareChildren();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$object.keys(allParents).forEach((key) => {\n\t\t\tallParents[key]._updateChildren();\n\t\t});\n\n\t\tconst objects: Array<Entity> = [];\n\n\t\t//\t\tconsole.log(\"_beforeChanged\")\n\t\t$object.keys(this._dirty).forEach((key) => {\n\t\t\tconst entity = this._dirty[key];\n\n\t\t\tif (entity.isDisposed()) {\n\t\t\t\tdelete this._dirty[entity.uid];\n\n\t\t\t} else {\n\t\t\t\tobjects.push(entity);\n\t\t\t\tentity._beforeChanged();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_changed\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._changed();\n\t\t\tdelete this._dirty[entity.uid];\n\t\t\tentity._clearDirty();\n\t\t});\n\n\t\tthis._isDirty = false;\n\n\t\tconst depths: { [id: number]: number } = {};\n\t\tconst bounds: Array<IBounds> = [];\n\n\t\t$object.keys(this._dirtyBounds).forEach((key) => {\n\t\t\tconst entity = this._dirtyBounds[key];\n\n\t\t\tdelete this._dirtyBounds[key];\n\n\t\t\tif (!entity.isDisposed()) {\n\t\t\t\tdepths[entity.uid] = entity.depth();\n\t\t\t\tbounds.push(entity);\n\t\t\t}\n\t\t});\n\n\t\t// High depth -> low depth\n\t\tbounds.sort((x, y) => {\n\t\t\treturn $order.compare(depths[y.uid], depths[x.uid]);\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updateBounds\")\n\t\tbounds.forEach((entity) => {\n\t\t\tentity._updateBounds();\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updatePosition\")\n\t\tconst dirtyPositions = this._dirtyPositions;\n\t\t$object.keys(dirtyPositions).forEach((key) => {\n\t\t\tconst sprite = dirtyPositions[key];\n\n\t\t\tdelete dirtyPositions[key];\n\n\t\t\tif (!sprite.isDisposed()) {\n\t\t\t\tsprite._updatePosition();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_afterChanged\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._afterChanged();\n\t\t});\n\n\t}\n\n\tprivate _renderFrame(currentTime: number): boolean {\n\t\tif (this.events.isEnabled(\"framestarted\")) {\n\t\t\tthis.events.dispatch(\"framestarted\", {\n\t\t\t\ttype: \"framestarted\",\n\t\t\t\ttarget: this,\n\t\t\t\ttimestamp: currentTime,\n\t\t\t});\n\t\t}\n\n\t\tthis._checkComputedStyles();\n\t\tthis._runTickers(currentTime);\n\t\tthis._runAnimations(currentTime);\n\t\tthis._runDirties();\n\t\tthis._render();\n\t\tthis._positionHTMLElements();\n\n\t\tif (this.events.isEnabled(\"frameended\")) {\n\t\t\tthis.events.dispatch(\"frameended\", {\n\t\t\t\ttype: \"frameended\",\n\t\t\t\ttarget: this,\n\t\t\t\ttimestamp: currentTime,\n\t\t\t});\n\t\t}\n\n\n\t\treturn this._tickers.length === 0 &&\n\t\t\tthis._animations.length === 0 &&\n\t\t\t!this._isDirty;\n\t}\n\n\tprivate _runTicker(currentTime: number) {\n\t\tif (!this.isDisposed()) {\n\t\t\tthis.animationTime = currentTime;\n\n\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t// No more work to do\n\t\t\tif (done) {\n\t\t\t\tthis._ticker = null;\n\t\t\t\tthis.animationTime = null;\n\n\t\t\t} else {\n\t\t\t\trAF(this.fps, this._ticker!);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _runTickerNow() {\n\t\tif (!this.isDisposed()) {\n\t\t\tfor (; ;) {\n\t\t\t\tconst currentTime = performance.now();\n\n\t\t\t\tthis.animationTime = currentTime;\n\n\t\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t\tif (done) {\n\t\t\t\t\tthis.animationTime = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _startTicker() {\n\t\tif (this._ticker === null) {\n\t\t\tthis.animationTime = null;\n\n\t\t\tthis._ticker = (currentTime) => {\n\t\t\t\tthis._runTicker(currentTime);\n\t\t\t};\n\n\t\t\trAF(this.fps, this._ticker!);\n\t\t}\n\t}\n\n\tpublic _addDirtyEntity(entity: Entity) {\n\t\tif (this._dirty[entity.uid] === undefined) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._dirty[entity.uid] = entity;\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addDirtyParent(parent: IParent) {\n\t\tif (this._dirtyParents[parent.uid] === undefined) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isDirtyParents = true;\n\t\t\tthis._dirtyParents[parent.uid] = parent;\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addDirtyBounds(entity: IBounds) {\n\t\tif (this._dirtyBounds[entity.uid] === undefined) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._dirtyBounds[entity.uid] = entity;\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addDirtyPosition(sprite: Sprite) {\n\t\tif (this._dirtyPositions[sprite.uid] === undefined) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._dirtyPositions[sprite.uid] = sprite;\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addAnimation(animation: IAnimation) {\n\t\t// TODO use numeric id instead\n\t\tif (this._animations.indexOf(animation) === -1) {\n\t\t\tthis._animations.push(animation);\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _markDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tpublic _markDirtyRedraw() {\n\t\tthis.events.once(\"frameended\", () => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._startTicker();\n\t\t})\n\t}\n\n\tpublic eachFrame(f: (currentTime: number) => void): IDisposer {\n\t\tthis._tickers.push(f);\n\t\tthis._startTicker();\n\n\t\treturn new Disposer(() => {\n\t\t\t$array.removeFirst(this._tickers, f);\n\t\t});\n\t}\n\n\tpublic markDirtyGlobal(container?: Container): void {\n\t\tif (!container) {\n\t\t\tcontainer = this.container;\n\t\t}\n\t\tconsole.log(this.width());\n\t\tcontainer.walkChildren((child) => {\n\t\t\tif (child instanceof Container) {\n\t\t\t\tthis.markDirtyGlobal(child);\n\t\t\t}\n\t\t\tchild.markDirty();\n\t\t\tchild.markDirtyBounds();\n\t\t});\n\t}\n\n\t/**\n\t * Returns width of the target container, in pixels.\n\t *\n\t * @return Width\n\t */\n\tpublic width(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's width ?\n\t\treturn Math.floor(this.dom.getBoundingClientRect().width);\n\t}\n\n\t/**\n\t * Returns height of the target container, in pixels.\n\t *\n\t * @return Height\n\t */\n\tpublic height(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's height ?\n\t\treturn Math.floor(this.dom.getBoundingClientRect().height);\n\t}\n\n\t/**\n\t * Disposes root and all the content in it.\n\t */\n\tpublic dispose(): void {\n\t\tif (!this._isDisposed) {\n\t\t\tthis._isDisposed = true;\n\n\t\t\tthis._rootContainer.dispose();\n\t\t\tthis._renderer.dispose();\n\t\t\tthis.horizontalLayout.dispose();\n\t\t\tthis.verticalLayout.dispose();\n\t\t\tthis.interfaceColors.dispose();\n\n\t\t\t$array.each(this._disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\n\t\t\tif (this._inner) {\n\t\t\t\t$utils.removeElement(this._inner);\n\t\t\t}\n\n\t\t\tvar tooltipRoot = this.tooltipRoot;\n\t\t\tif (tooltipRoot) {\n\t\t\t\ttooltipRoot.dispose();\n\t\t\t}\n\n\t\t\t$array.remove(registry.rootElements, this);\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if root element is disposed.\n\t *\n\t * @return Disposed?\n\t */\n\tpublic isDisposed(): boolean {\n\t\treturn this._isDisposed;\n\t}\n\n\t/**\n\t * Triggers screen reader read out a message.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t * @param  text  Alert text\n\t */\n\tpublic readerAlert(text: string): void {\n\t\tthis._readerAlertElement!.innerHTML = $utils.stripTags(text);\n\t}\n\n\t/**\n\t * Sets themes to be used for the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/themes/} for more info\n\t * @param  themes  A list of themes\n\t */\n\tpublic setThemes(themes: Array<Theme>): void {\n\t\tthis._rootContainer.set(\"themes\", themes);\n\n\t\tconst tooltipRoot = this.tooltipRoot;\n\t\tif (tooltipRoot) {\n\t\t\ttooltipRoot._rootContainer.set(\"themes\", themes);\n\t\t\ttooltipRoot.tooltipContainer._applyThemes();\n\t\t}\n\n\t\t// otherwise new themes are not applied\n\t\tconst tooltipContainer = this.tooltipContainer;\n\t\tif (tooltipContainer) {\n\t\t\ttooltipContainer._applyThemes();\n\t\t}\n\n\t\t// @todo review this\n\t\tconst interfaceColors = this.interfaceColors;\n\t\tif (interfaceColors) {\n\t\t\tinterfaceColors._applyThemes();\n\t\t}\n\n\n\t}\n\n\tprotected _addTooltip() {\n\t\tif (!this.tooltipContainer) {\n\t\t\tconst tooltipContainer = this._rootContainer.children.push(Container.new(this, { position: \"absolute\", isMeasured: false, width: p100, height: p100, layer: 30 }));\n\t\t\tthis.tooltipContainer = tooltipContainer;\n\n\t\t\tlet tooltipRoot = this.tooltipRoot;\n\t\t\tif (!tooltipRoot) {\n\t\t\t\ttooltipRoot = this;\n\t\t\t}\n\n\t\t\tconst tooltip = Tooltip.new(tooltipRoot, {});\n\t\t\tthis.container.set(\"tooltip\", tooltip);\n\t\t\ttooltip.hide(0);\n\t\t\tthis._tooltip = tooltip;\n\t\t}\n\t}\n\n\t/**\n\t * Accesibility\n\t */\n\n\tpublic _registerTabindexOrder(target: Sprite): void {\n\t\tif (target.get(\"focusable\")) {\n\t\t\t$array.pushOne(this._tabindexes, target);\n\t\t}\n\t\telse {\n\t\t\t$array.remove(this._tabindexes, target);\n\t\t}\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _unregisterTabindexOrder(target: Sprite): void {\n\t\t$array.remove(this._tabindexes, target);\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _invalidateTabindexes(): void {\n\n\t\tthis._tabindexes.sort((a: Sprite, b: Sprite) => {\n\t\t\tconst aindex = a.get(\"tabindexOrder\", 0);\n\t\t\tconst bindex = b.get(\"tabindexOrder\", 0);\n\t\t\tif (aindex == bindex) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if (aindex > bindex) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\tconst groups: Array<string | number> = [];\n\t\t$array.each(this._tabindexes, (item, index) => {\n\t\t\tif (!item.getPrivate(\"focusElement\")) {\n\t\t\t\tthis._makeFocusElement(index, item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._moveFocusElement(index, item);\n\t\t\t}\n\t\t\tconst group = item.get(\"focusableGroup\");\n\t\t\tif (group) {\n\t\t\t\tif (groups.indexOf(group) !== -1) {\n\t\t\t\t\t// Non-first element in the group, make it not directly focusable\n\t\t\t\t\titem.getPrivate(\"focusElement\")!.dom.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tgroups.push(group);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t}\n\n\tpublic _updateCurrentFocus(): void {\n\t\tif (this._focusedSprite) {\n\t\t\tthis._decorateFocusElement(this._focusedSprite);\n\t\t\tthis._positionFocusElement(this._focusedSprite);\n\t\t}\n\t}\n\n\tpublic _decorateFocusElement(target: Sprite, focusElement?: HTMLDivElement): void {\n\n\t\t// Decorate with proper accessibility attributes\n\t\tif (!focusElement) {\n\t\t\tfocusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\t}\n\n\t\tif (!focusElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (target.get(\"visible\") && target.get(\"role\") != \"tooltip\" && !target.isHidden()) {\n\t\t\tif (focusElement.getAttribute(\"tabindex\") != \"-1\") {\n\t\t\t\tfocusElement.setAttribute(\"tabindex\", \"\" + this.tabindex);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"tabindex\")\n\t\t}\n\n\t\tconst role = target.get(\"role\");\n\t\tif (role) {\n\t\t\tfocusElement.setAttribute(\"role\", role);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"role\");\n\t\t}\n\n\t\tconst ariaLabel = target.get(\"ariaLabel\");\n\t\tif (ariaLabel) {\n\t\t\tconst label = populateString(target, ariaLabel);\n\t\t\tfocusElement.setAttribute(\"aria-label\", label);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-label\");\n\t\t}\n\n\t\tconst ariaLive = target.get(\"ariaLive\");\n\t\tif (ariaLive) {\n\t\t\tfocusElement.setAttribute(\"aria-live\", ariaLive);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-live\");\n\t\t}\n\n\t\tconst ariaChecked = target.get(\"ariaChecked\");\n\t\tif (ariaChecked != null) {\n\t\t\tfocusElement.setAttribute(\"aria-checked\", ariaChecked ? \"true\" : \"false\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-checked\");\n\t\t}\n\n\t\tif (target.get(\"ariaHidden\")) {\n\t\t\tfocusElement.setAttribute(\"aria-hidden\", \"hidden\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-hidden\");\n\t\t}\n\n\t\tconst ariaOrientation = target.get(\"ariaOrientation\");\n\t\tif (ariaOrientation) {\n\t\t\tfocusElement.setAttribute(\"aria-orientation\", ariaOrientation);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-orientation\");\n\t\t}\n\n\t\tconst ariaValueNow = target.get(\"ariaValueNow\");\n\t\tif (ariaValueNow) {\n\t\t\tfocusElement.setAttribute(\"aria-valuenow\", ariaValueNow);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuenow\");\n\t\t}\n\n\t\tconst ariaValueMin = target.get(\"ariaValueMin\");\n\t\tif (ariaValueMin) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemin\", ariaValueMin);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemin\");\n\t\t}\n\n\t\tconst ariaValueMax = target.get(\"ariaValueMax\");\n\t\tif (ariaValueMax) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemax\", ariaValueMax);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemax\");\n\t\t}\n\n\t\tconst ariaValueText = target.get(\"ariaValueText\");\n\t\tif (ariaValueText) {\n\t\t\tfocusElement.setAttribute(\"aria-valuetext\", ariaValueText);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuetext\");\n\t\t}\n\n\t\tconst ariaControls = target.get(\"ariaControls\");\n\t\tif (ariaControls) {\n\t\t\tfocusElement.setAttribute(\"aria-controls\", ariaControls);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-controls\");\n\t\t}\n\t}\n\n\tpublic _makeFocusElement(index: number, target: Sprite): void {\n\n\t\tif (target.getPrivate(\"focusElement\")) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Init\n\t\tconst focusElement = document.createElement(\"div\");\n\t\tif (target.get(\"role\") != \"tooltip\") {\n\t\t\tfocusElement.tabIndex = this.tabindex;\n\t\t}\n\t\tfocusElement.style.position = \"absolute\";\n\t\t$utils.setInteractive(focusElement, false);\n\n\t\tconst disposers: Array<IDisposer> = [];\n\n\t\ttarget.setPrivate(\"focusElement\", {\n\t\t\tdom: focusElement,\n\t\t\tdisposers,\n\t\t});\n\n\t\tthis._decorateFocusElement(target);\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"focus\", (ev: FocusEvent) => {\n\t\t\tthis._handleFocus(ev, index);\n\t\t}));\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"blur\", (ev: FocusEvent) => {\n\t\t\tthis._handleBlur(ev, index);\n\t\t}));\n\n\t\tthis._moveFocusElement(index, target);\n\n\t}\n\n\tpublic _removeFocusElement(target: Sprite): void {\n\t\t$array.remove(this._tabindexes, target);\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (focusElement) {\n\t\t\tconst container = this._focusElementContainer!;\n\t\t\tcontainer.removeChild(focusElement.dom);\n\t\t\t$array.each(focusElement.disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic _hideFocusElement(target: Sprite): void {\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!;\n\t\tfocusElement.dom.style.display = \"none\";\n\t}\n\n\tprotected _moveFocusElement(index: number, target: Sprite): void {\n\n\t\t// Get container\n\t\tconst container = this._focusElementContainer!;\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\n\t\tif (focusElement === this._focusElementContainer!.children[index]) {\n\t\t\t// Nothing to do\n\t\t\treturn;\n\t\t}\n\n\t\tconst next = this._focusElementContainer!.children[index + 1];\n\t\tif (next) {\n\t\t\tcontainer.insertBefore(focusElement, next);\n\t\t}\n\t\telse {\n\t\t\tcontainer.append(focusElement);\n\t\t}\n\t}\n\n\tprotected _positionFocusElement(target: Sprite): void {\n\t\tconst bounds = target.globalBounds();\n\n\t\tconst width = bounds.right == bounds.left ? target.width() : bounds.right - bounds.left;\n\t\tconst height = bounds.top == bounds.bottom ? target.height() : bounds.bottom - bounds.top;\n\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\tfocusElement.style.top = (bounds.top - 2) + \"px\";\n\t\tfocusElement.style.left = (bounds.left - 2) + \"px\";\n\t\tfocusElement.style.width = (width + 4) + \"px\";\n\t\tfocusElement.style.height = (height + 4) + \"px\";\n\n\t}\n\n\tprotected _handleFocus(ev: FocusEvent, index: number): void {\n\t\t// Get element\n\t\tconst focused = this._tabindexes[index];\n\n\t\t// Jump over hidden elements\n\t\tif (!focused.isVisibleDeep()) {\n\t\t\tthis._focusNext(<HTMLDivElement>ev.target, this._isShift ? -1 : 1);\n\t\t\treturn;\n\t\t}\n\n\t\t// Size and position\n\t\tthis._positionFocusElement(focused);\n\t\t//this._decorateFocusElement(focused);\n\n\t\tthis._focusedSprite = focused;\n\n\t\tif (focused.events.isEnabled(\"focus\")) {\n\t\t\tfocused.events.dispatch(\"focus\", {\n\t\t\t\ttype: \"focus\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected _focusNext(el: HTMLDivElement, direction: 1 | -1): void {\n\t\tvar focusableElements = Array.from(document.querySelectorAll([\n\t\t\t'a[href]',\n\t\t\t'area[href]',\n\t\t\t'button:not([disabled])',\n\t\t\t'details',\n\t\t\t'input:not([disabled])',\n\t\t\t'iframe:not([disabled])',\n\t\t\t'select:not([disabled])',\n\t\t\t'textarea:not([disabled])',\n\t\t\t'[contentEditable=\"\"]',\n\t\t\t'[contentEditable=\"true\"]',\n\t\t\t'[contentEditable=\"TRUE\"]',\n\t\t\t'[tabindex]:not([tabindex^=\"-\"])',\n\t\t\t//':not([disabled])'\n\t\t].join(',')));\n\n\t\tlet index = focusableElements.indexOf(el) + direction;\n\n\t\tif (index < 0) {\n\t\t\tindex = focusableElements.length - 1;\n\t\t}\n\t\telse if (index >= focusableElements.length) {\n\t\t\tindex = 0;\n\t\t}\n\n\t\t(<HTMLElement>focusableElements[index]).focus();\n\t}\n\n\tprotected _handleBlur(ev: FocusEvent, _index: number): void {\n\t\tconst focused = this._focusedSprite;\n\t\tif (focused && focused.events.isEnabled(\"blur\")) {\n\t\t\tfocused.events.dispatch(\"blur\", {\n\t\t\t\ttype: \"blur\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\t\tthis._focusedSprite = undefined;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic updateTooltip(target: Text): void {\n\t\tconst text = $utils.stripTags(target._getText());\n\t\tlet tooltipElement = target.getPrivate(\"tooltipElement\");\n\t\tif (target.get(\"role\") == \"tooltip\" && text != \"\") {\n\t\t\tif (!tooltipElement) {\n\t\t\t\ttooltipElement = this._makeTooltipElement(target);\n\t\t\t}\n\t\t\tif (tooltipElement.innerHTML != text) {\n\t\t\t\ttooltipElement.innerHTML = text!;\n\t\t\t}\n\t\t}\n\t\telse if (tooltipElement) {\n\t\t\ttooltipElement.remove();\n\t\t\ttarget.removePrivate(\"tooltipElement\");\n\t\t}\n\t}\n\n\tpublic _makeTooltipElement(target: Text): HTMLDivElement {\n\t\tconst container = this._tooltipElementContainer!;\n\t\tconst tooltipElement = document.createElement(\"div\");\n\t\ttooltipElement.style.position = \"absolute\";\n\t\ttooltipElement.style.top = \"-1000000px\";\n\t\ttooltipElement.style.opacity = \"0.0000001\";\n\n\t\t$utils.setInteractive(tooltipElement, false);\n\n\t\tthis._decorateFocusElement(target, tooltipElement);\n\t\tcontainer.append(tooltipElement);\n\t\ttarget.setPrivate(\"tooltipElement\", tooltipElement);\n\t\treturn tooltipElement;\n\t}\n\n\tpublic _invalidateAccessibility(target: Sprite): void {\n\t\tthis._focusElementDirty = true;\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (target.get(\"focusable\")) {\n\t\t\tif (focusElement) {\n\t\t\t\tthis._decorateFocusElement(target);\n\t\t\t\tthis._positionFocusElement(target);\n\t\t\t}\n\t\t\t// else {\n\t\t\t// \tthis._renderer._makeFocusElement(0, this);\n\t\t\t// }\n\t\t}\n\t\telse if (focusElement) {\n\t\t\tthis._removeFocusElement(target);\n\t\t}\n\t\t//this.updateCurrentFocus();\n\t}\n\n\t/**\n\t * Returns `true` if `target` is currently focused.\n\t *\n\t * @param   target  Target\n\t * @return          Focused?\n\t */\n\tpublic focused(target: Sprite): boolean {\n\t\treturn this._focusedSprite === target;\n\t}\n\n\t/**\n\t * Converts document coordinates to coordinates withing root element.\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic documentPointToRoot(point: IPoint): IPoint {\n\t\tconst bbox = this.dom.getBoundingClientRect();\n\t\treturn {\n\t\t\tx: point.x - bbox.left,\n\t\t\ty: point.y - bbox.top\n\t\t};\n\t}\n\n\t/**\n\t * Converts root coordinates to document\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic rootPointToDocument(point: IPoint): IPoint {\n\t\tconst bbox = this.dom.getBoundingClientRect();\n\t\treturn {\n\t\t\tx: point.x + bbox.left,\n\t\t\ty: point.y + bbox.top\n\t\t};\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic addDisposer<T extends IDisposer>(disposer: T): T {\n\t\tthis._disposers.push(disposer);\n\t\treturn disposer;\n\t}\n\n\tprotected _updateComputedStyles(): boolean {\n\t\tconst styles = window.getComputedStyle(this.dom);\n\t\tlet fontHash = \"\";\n\t\t$object.each(styles, (key, val) => {\n\t\t\tif ($type.isString(key) && key.match(/^font/)) {\n\t\t\t\tfontHash += val;\n\t\t\t}\n\t\t})\n\t\tconst changed = fontHash != this._fontHash;\n\t\tif (changed) {\n\t\t\tthis._fontHash = fontHash;\n\t\t}\n\t\treturn changed;\n\t}\n\n\tprotected _checkComputedStyles(): void {\n\t\tif (this._updateComputedStyles()) {\n\t\t\tthis._invalidateLabelBounds(this.container);\n\t\t}\n\t}\n\n\tprotected _invalidateLabelBounds(target: Sprite): void {\n\t\tif (target instanceof Container) {\n\t\t\ttarget.children.each((child) => {\n\t\t\t\tthis._invalidateLabelBounds(child);\n\t\t\t});\n\t\t}\n\t\telse if (target instanceof Text) {\n\t\t\ttarget.markDirtyBounds();\n\t\t}\n\t}\n\n\t/**\n\t * To all the clever heads out there. Yes, we did not make any attempts to\n\t * scramble this.\n\t *\n\t * This is a part of a tool meant for our users to manage their commercial\n\t * licenses for removal of amCharts branding from charts.\n\t *\n\t * The only legit way to do so is to purchase a commercial license for amCharts:\n\t * https://www.amcharts.com/online-store/\n\t *\n\t * Removing or altering this code, or disabling amCharts branding in any other\n\t * way is against the license and thus illegal.\n\t */\n\tprotected _hasLicense(): boolean {\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\n\t\t\tif (registry.licenses[i].match(/^AM5C.{5,}/i)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic _licenseApplied(): void {\n\t\tif (this._logo) {\n\t\t\tthis._logo.set(\"forceHidden\", true);\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic get debugGhostView(): boolean {\n\t\treturn this._renderer.debugGhostView;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic set debugGhostView(value: boolean) {\n\t\tthis._renderer.debugGhostView = value;\n\t}\n\n\t/**\n\t * Set this to `true` if you need chart to require first a tap onto it before\n\t * touch gesture related functionality like zoom/pan is turned on.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default false\n\t * @since 5.2.9\n\t * @param  value  Needs a tap to activate touch functions\n\t */\n\tpublic set tapToActivate(value: boolean) {\n\t\tthis._renderer.tapToActivate = value;\n\t}\n\n\t/**\n\t * @return Needs a tap to activate touch functions\n\t */\n\tpublic get tapToActivate(): boolean {\n\t\treturn this._renderer.tapToActivate;\n\t}\n\n\t/**\n\t * If `tapToActivate` is set to `true`, this setting will determine number\n\t * of milliseconds the chart will stay \"active\", before releasing the\n\t * controls back to the page.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default 3000\n\t * @since 5.2.9\n\t * @param  value  Timeout\n\t */\n\tpublic set tapToActivateTimeout(value: number) {\n\t\tthis._renderer.tapToActivateTimeout = value;\n\t}\n\n\t/**\n\t * @return Timeout\n\t */\n\tpublic get tapToActivateTimeout(): number {\n\t\treturn this._renderer.tapToActivateTimeout;\n\t}\n\n\tpublic _makeHTMLElement(target: Container): HTMLDivElement {\n\n\t\t// Get container\n\t\tconst container = this._htmlElementContainer!;\n\n\t\t// Init\n\t\tconst htmlElement = document.createElement(\"div\");\n\t\ttarget.setPrivate(\"htmlElement\", htmlElement);\n\n\t\t//htmlElement.tabIndex = this.tabindex;\n\t\thtmlElement.style.position = \"absolute\";\n\t\thtmlElement.style.overflow = \"auto\";\n\t\thtmlElement.style.boxSizing = \"border-box\";\n\t\t$utils.setInteractive(htmlElement, true);\n\n\t\t// Translate events\n\t\tif (target.events.isEnabled(\"click\")) {\n\t\t\tthis._disposers.push($utils.addEventListener<PointerEvent | MouseEvent>(htmlElement, \"click\", (ev: IPointerEvent) => {\n\t\t\t\tconst downEvent = this._renderer.getEvent(ev);\n\t\t\t\ttarget.events.dispatch(\"click\", {\n\t\t\t\t\ttype: \"click\",\n\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\tsimulated: false,\n\t\t\t\t\ttarget: target\n\t\t\t\t});\n\t\t\t}));\n\t\t}\n\n\t\tthis._positionHTMLElement(target);\n\n\t\tcontainer.append(htmlElement);\n\n\t\t$array.pushOne(this._htmlEnabledContainers, target);\n\n\t\treturn htmlElement;\n\t}\n\n\tpublic _positionHTMLElements(): void {\n\t\t$array.each(this._htmlEnabledContainers, (target) => {\n\t\t\tthis._positionHTMLElement(target);\n\t\t});\n\t}\n\n\tpublic _positionHTMLElement(target: Container): void {\n\t\tconst htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElement) {\n\n\t\t\t// Translate settings\n\t\t\tconst visualSettings = [\"paddingTop\", \"paddingRight\", \"paddingBottom\", \"paddingLeft\", \"minWidth\", \"minHeight\", \"maxWidth\", \"maxHeight\"];\n\t\t\t$array.each(visualSettings, (setting: any) => {\n\t\t\t\tconst value = target.get(setting);\n\t\t\t\tif (value) {\n\t\t\t\t\thtmlElement.style[setting] = value + \"px\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thtmlElement.style[setting] = \"\";\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Deal with opacity\n\t\t\tconst opacity = target.compositeOpacity();\n\t\t\tsetTimeout(() => {\n\t\t\t\thtmlElement.style.opacity = opacity + \"\";\n\t\t\t}, 10);\n\n\t\t\tconst visible = target.isVisibleDeep();\n\t\t\tif (visible) {\n\t\t\t\thtmlElement.style.display = \"block\";\n\t\t\t}\n\n\t\t\t// Deal with position\n\t\t\tconst bounds = target.globalBounds();\n\t\t\thtmlElement.style.top = (bounds.top) + \"px\";\n\t\t\thtmlElement.style.left = (bounds.left) + \"px\";\n\n\t\t\t// Use width/height if those are set\n\t\t\tconst width = target.get(\"width\");\n\t\t\tconst height = target.get(\"height\");\n\n\t\t\tlet w: number = 0;\n\t\t\tlet h: number = 0;\n\n\t\t\tif (width) {\n\t\t\t\tw = target.width();\n\t\t\t}\n\n\t\t\tif (height) {\n\t\t\t\th = target.height();\n\t\t\t}\n\n\t\t\tif (!width || !height) {\n\t\t\t\thtmlElement.style.width = \"\";\n\t\t\t\thtmlElement.style.height = \"\";\n\t\t\t\tconst bbox = htmlElement.getBoundingClientRect();\n\t\t\t\tw = bbox.width;\n\t\t\t\th = bbox.height;\n\n\t\t\t\ttarget._adjustedLocalBounds = { left: 0, right: 0, top: 0, bottom: 0 };\n\t\t\t\ttarget.setPrivate(\"minWidth\", w);\n\t\t\t\ttarget.setPrivate(\"minHeight\", h);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget.removePrivate(\"minWidth\");\n\t\t\t\ttarget.removePrivate(\"minHeight\");\n\t\t\t}\n\n\t\t\tif (w > 0) {\n\t\t\t\thtmlElement.style.minWidth = (w) + \"px\";\n\t\t\t}\n\t\t\tif (h > 0) {\n\t\t\t\thtmlElement.style.minHeight = (h) + \"px\";\n\t\t\t}\n\n\t\t\t// Hide or show\n\t\t\tif (!visible || opacity == 0) {\n\t\t\t\thtmlElement.style.display = \"none\";\n\t\t\t}\n\n\t\t}\n\t}\n\n\tpublic _setHTMLContent(target: Container, html: string): void {\n\t\tlet htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (!htmlElement) {\n\t\t\thtmlElement = this._makeHTMLElement(target);\n\t\t}\n\t\tif (htmlElement.innerHTML != html) {\n\t\t\thtmlElement.innerHTML = html;\n\t\t}\n\t}\n\n\tpublic _removeHTMLContent(target: Container): void {\n\t\tlet htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElement) {\n\t\t\tthis._htmlElementContainer!.removeChild(htmlElement);\n\t\t}\n\t\t$array.remove(this._htmlEnabledContainers, target);\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}